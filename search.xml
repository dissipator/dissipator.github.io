<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[linuxä¸‹å®‰è£…virtualboxè™šæ‹Ÿæœºå‘½ä»¤æ“ä½œ]]></title>
    <url>%2F2018%2F05%2F23%2Flinux%E4%B8%8B%E5%AE%89%E8%A3%85virtualbox%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%91%BD%E4%BB%A4%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[linuxä¸‹å®‰è£…virtualboxè™šæ‹Ÿæœºå‘½ä»¤æ“ä½œinuxä¸‹å®‰è£…virtualboxè™šæ‹Ÿæœºå‘½ä»¤æ“ä½œ æ— æ„é—´çœ‹åˆ°ä¸€ç¯‡è™šæ‹Ÿæœºæ€§èƒ½ä»‹ç»çš„æ–‡ç« ï¼Œè¯´åˆ°å¼€æºçš„virtualboxæ€§å¾ˆä¸é”™ï¼ŒäºŽæ˜¯æœ€è¿‘åˆ°å®˜æ–¹ç½‘ç«™www.virtualbox.orgä¸‹äº†å½“å‰æœ€æ–°ç‰ˆæœ¬VirtualBox-3.1-3.1.2_56127å­¦ä¹ ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå¼€å§‹åœ¨windows 7ä¸‹è™šæ‹Ÿå®‰è£…xpåŠcenteros5ç³»ç»Ÿæ“ä½œäº†ä¸€ä¸‹ï¼Œå¯åŠ¨é€Ÿåº¦æ¯”vmwareè¦å¿«å¾—å¤šï¼Œæ“ä½œä¹ æƒ¯ä¸Šä¹Ÿå¾ˆç›¸ä¼¼ï¼Œåˆåœ¨linuxä¸‹æ“ä½œäº†ä¸€ç•ªï¼Œç•Œé¢æ“ä½œå¯åŠ¨å’Œåœ¨windowsä¸Šå·®ä¸å¤šï¼Œè™šæ‹Ÿæœºä¸Šxpå¯åŠ¨çš„é€Ÿåº¦ä¸€èˆ¬åœ¨16-17ç§’å·¦å³ï¼Œåœ¨ä¸€å° Intel(R) Xeon(R) CPU 1.86GHz ï¼ˆåŒCPU,4æ ¸æ¯CPUï¼‰ï¼Œ8Gå†…å­˜ï¼ŒRed Hat 3.4.6-8 linuxæ“ä½œç³»ç»Ÿä¸‹ï¼ˆç³»ç»Ÿè‡ªèº«æ¯”è¾ƒå¹²å‡€ï¼Œè¿˜æ²¡å®‰è£…è¿‡å…¶ä»–åº”ç”¨ï¼‰ï¼ŒåŒæ—¶åˆ›å»ºäº†3å°è™šæ‹Ÿ1CPU,1Gå†…å­˜ï¼Œxpï¼ŒXç•Œé¢ä¸‹æ“ä½œå‡ ä¹ŽåŒæ—¶å¯åŠ¨ï¼Œå®žä½“æœºçž¬é—´å½“å‰LOADé«˜è¾¾14ï¼Œæ„Ÿè§‰å¾ˆå¡ï¼ŒåŒæ—¶ä¸çŸ¥é“ä½•æ•…ï¼Œ3å°XPå®Œå…¨å¯åŠ¨åŽå…¶ä¸­æ€»ä¸€å°5åˆ†é’Ÿå†…ä¼šæŒ‚æŽ‰ã€‚åŽæ¥æ”¹ç”¨å‘½ä»¤æ¨¡å¼æ“ä½œï¼Œ3å°èµ·æ¥ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ï¼Œxpä¸Šè·‘ä¸€äº›è‡ªåŠ¨æµ‹è¯•è„šæœ¬ï¼Œè§‚å¯Ÿäº†ä¸€å¤©ï¼Œè¿˜ç®—ç¨³å®šï¼Œæœ‰ç©ºè®¡åˆ’ç»§ç»­å¾€ä¸ŠåŠ ä¸Šå‡ å°çœ‹çœ‹ã€‚ æ¡Œé¢ç•Œé¢ä¸Šæ“ä½œç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå‘½ä»¤æ“ä½œæœ‰ç‚¹å¤æ‚ï¼Œä½†æ˜¯æ€§èƒ½æ¯”è¾ƒé«˜ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹å‘½ä»¤æ¨¡å¼ä¸‹å®‰è£…æ“ä½œè¿‡ç¨‹ã€‚ 1.rpmåŒ…å®‰è£…â€‹ rpm -ivh VirtualBox-3.1-3.1.2_56127_rhel4-1.i386.rpm å› ä¸ºæˆ‘çš„ç³»ç»Ÿç‰ˆæœ¬æ¯”è¾ƒè€æ˜¯RHEL3,ä¸è¿‡å†…æ ¸å‡çº§åˆ°äº†2.6.9ï¼Œæœ¬æƒ³æ‰¾æºç åŒ…ç¼–è¯‘å®‰è£…ï¼Œç›´æŽ¥æ‹¿è¿™ä¸ªåœ¨ä¸Šé¢rpmåŒ…å®‰è£…è¯•äº†å¥½åƒä¹Ÿæ²¡æŠ¥é”™ã€‚ 2.æ·»åŠ vboxusers ç”¨æˆ·ç»„â€‹ usermod -a -G vboxusers root ä¸Šé¢virtualbox rpmåŒ…å®‰è£…å¥½åŽä¼šè‡ªåŠ¨ç”Ÿæˆvboxusersç»„ï¼Œç³»ç»Ÿä¸Šè¦ç”¨è™šæ‹Ÿæœºçš„ç”¨æˆ·éƒ½å¯ä»¥æŠŠè¿™ä¸ªç»„æ·»åŠ è¿›åŽ»ã€‚ 3.åˆ›å»ºè™šæ‹Ÿæœºâ€‹ VBoxManage createvm â€“name â€œwinxpâ€ â€“register VBoxManage æ˜¯virtualboxçš„è™šæ‹Ÿæœºç®¡ç†å‘½ä»¤ï¼Œå‘½ä»¤æ¨¡å¼ä¸‹æ“ä½œå‡ ä¹Žéƒ½è·Ÿä»–æœ‰å…³ã€‚è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªwinxpçš„è™šæ‹Ÿæœºã€‚ åˆ›å»ºå®ŒåŽå¯ä»¥ç”¨ VBoxManage list vms å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹å½“å‰å¯ç”¨çš„è™šæ‹Ÿæœºï¼Œä¹Ÿå¯ä»¥ç”¨VBoxManage showvminfo winxp å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹å½“å‰è™šæ‹Ÿæœºwinxpçš„çŠ¶æ€åŠä¸€äº›é»˜è®¤é…ç½®ã€‚ #4.ä¿®æ”¹è™šæ‹Ÿæœºè®¾ç½® 4.ä¿®æ”¹è™šæ‹Ÿæœºè®¾ç½®â€‹ é¦–å…ˆå…ˆåˆ›å»ºä¸€ä¸ªç£ç›˜ï¼š VBoxManage createmedium [disk|dvd|floppy] â€“filename [â€“size |â€“sizebyte ] [â€“diffparent | [â€“format VDI|VMDK|VHD] (default: VDI) [â€“variant Standard,Fixed,Split2G,Stream,ESX] â€‹ VBoxManage createvdi â€“filename /home/virtualbox/winxp.vdi â€“size 5000 â€“remember ä¿®æ”¹è™šæ‹Ÿæœºwinxpè®¾ç½®ï¼Œæ“ä½œç³»ç»Ÿï¼Œå†…å­˜ï¼Œæ˜¾å­˜ï¼Œå¯åŠ¨é¡ºåºï¼Œç£ç›˜ä½ç½®ï¼Œsataç£ç›˜æŽ§åˆ¶å™¨ï¼Œç”µæºç®¡ç†æŽ¥å£ï¼ŒCPUè®¾ç½®ï¼Œç½‘å¡æŽ¥å£ï¼Œè¿œç¨‹ç®¡ç†ç­‰ Warning: â€˜â€“vrdpâ€™ is deprecated. Use â€˜â€“vrdeâ€™.Warning: â€˜â€“vrdpportâ€™ is deprecated. Use â€˜â€“vrdeportâ€™.Warning: â€˜â€“vrdpmulticonâ€™ is deprecated. Use â€˜â€“vrdemulticonâ€™. VBoxManage modifyvm â€œwinxpâ€ â€“ostype â€œWindowsXPâ€ â€“memory â€œ512â€ â€“vram â€œ16â€ â€“boot2 disk â€“boot1 dvd â€“hda â€œ/home/virtualbox/winxp.vdiâ€ â€“sata on â€“acpi on â€“pae on â€“hwvirtex on â€“nic1 hostif â€“cableconnected1 on â€“nictype1 â€œAm79C973â€ â€“bridgeadapter1 eth0 â€“intnet1 brigh1 â€“macaddress1 auto â€“vrdp on â€“vrdpport 4000 â€“vrdpmulticon on ä¸Šé¢å‚æ•°å…·ä½“è¯´æ˜Žå¯ä»¥ç”¨ VBoxManage modifyvm â€“help æŸ¥çœ‹äº†è§£æ‰§è¡Œä¸Šé¢å‘½ä»¤ï¼Œå¯èƒ½ä¼šç¢°åˆ°å¦‚ä¸‹é”™è¯¯ï¼šERROR: Could not find a storage controller named â€˜IDE Controllerâ€™ åœ¨å›½å¤–ç½‘ç«™ä¸ŠæŸ¥åˆ°éœ€è¦æ·»åŠ ä¸€ä¸‹IDEæŽ¥å£å°±å¯ä»¥äº†ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šVBoxManage storagectl winxp â€“name â€œIDE Controllerâ€ â€“add ideå†æ‰§è¡Œä¸Šé¢å‘½ä»¤å³å¯ã€‚ 5.æŒ‚è½½ISOå®‰è£…ç›˜â€‹ VBoxManage openmedium dvd /home/virtualbox/winxpsp3.iso 6.ç³»ç»Ÿå®‰è£…â€‹ å…ˆå°†æŒ‚è½½çš„ISOæ–‡ä»¶ï¼ŒåŠ åˆ°è™šæ‹Ÿæœºçš„DVDå…‰é©±é‡ŒVBoxManage modifyvm â€œwinxpâ€ â€“dvd /home/virtualbox/winxpsp3.isoå¯èƒ½ä¼šæŠ¥é”™ï¼š ERROR: No storage device attached to device slot 0 on port 1 of controller â€˜IDE Controllerâ€™ æ˜¯IDE ç«¯å£æ²¡è®¾ç½®å¥½æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š å°†winxp.vdi ç£ç›˜æ”¾åœ¨è®¾å¤‡0çš„ç¬¬0ä¸ªç«¯å£ VBoxManage storageattach winxp â€“storagectl â€œIDE Controllerâ€ â€“port 0 â€“device 0 â€“type hdd â€“medium /home/virtualbox/winxp.vdiå°†ISOæŒ‚è½½åœ¨è®¾å¤‡0çš„ç¬¬1ä¸ªç«¯å£ VBoxManage storageattach winxp â€“storagectl â€œIDE Controllerâ€ â€“port 1 â€“device 0 â€“type dvddrive â€“medium /home/virtualbox/winxpsp3.iso 7.å¼€å§‹å¯åŠ¨â€‹ VBoxManage startvm â€œwinxpâ€ -type vrdp æˆ–è€… VBoxHeadless -startvm â€œwinxpâ€ &amp;ã€ ç¬¬ä¸€ç§ï¼šä½¿ç”¨ VRDP æ–¹å¼é€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨è™šæ‹Ÿæœºï¼š (è™šæ‹Ÿæœºåä¸ºï¼šdcsvr08)QHo@qhoferrari1k:~$ VBoxManage startvm dcsvr08 -type vrdp ç¬¬äºŒç§ ï¼šä½¿ç”¨ Headless å¯åŠ¨æ— å‰ç«¯å›¾å½¢ç•Œé¢æ–¹å¼ï¼š QHo@qhoferrari1k:~$ VBoxHeadless -startvm â€œdcsvr08â€ å†é€šwindowsè¿œç¨‹æ¡Œé¢è¿œç¨‹è¿žæŽ¥è¿‡åŽ»ï¼ŒIP:4000 ï¼Œè¿™ä¸ªç«¯å£æ˜¯ä¹‹å‰è®¾ç½®å¥½çš„ï¼Œä¹Ÿå¯ä»¥å¯åŠ¨çš„æ—¶å€™åŠ å‚æ•°ï¼Œæ²¡æœ‰åŠ å¯†ï¼Œç›´æŽ¥è¿žè¿œç¨‹è¿žæŽ¥æ“ä½œã€‚ 8.å®‰è£…å®¢æˆ·ç«¯å¢žå¼ºæ’ä»¶ mkdir /mnt/iso mount -o loop /usr/share/virtualbox/VBoxGuestAdditions.iso /mnt/iso è¿›å…¥ç³»ç»Ÿï¼Œæ‰“å¼€å…‰é©±å®‰è£…å³å¯ 9.ç³»ç»Ÿå¤åˆ¶å…‹éš† virtualbox ä¸åƒvmwareçš„ç£ç›˜æ–‡ä»¶ï¼Œæ‹·è´è¿‡æ¥æ˜¯ä¸èƒ½ç›´æŽ¥ä½¿ç”¨ï¼Œå› ä¸ºvirtualboxçš„ç£ç›˜æ–‡ä»¶é‡Œéƒ½è¢«è®°å½•äº†ç‹¬ç«‹çš„uuidï¼Œæ‰€ä»¥å¤åˆ¶åªèƒ½ç”¨è‡ªå¸¦çš„å‘½ä»¤å…‹éš†ç£ç›˜ã€‚ vboxmanager clonevdi $(pwd)/winxp.vdi $ï¼ˆpwdï¼‰/winxp2.vdi æ³¨æ„ï¼Œè·¯å¾„è¦å†™å…¨ï¼Œå› ä¸ºé»˜è®¤è·¯å¾„ä¼šæŒ‡å‘/root/.virtualbox/ ç„¶åŽå†æ·»åŠ æ³¨å†Œä¸ªè™šæ‹Ÿæœºï¼š VBoxManage createvm â€“name â€œwinxp1â€ â€“register æŸ¥çœ‹ä¸€ä¸‹é»˜è®¤è®¾ç½®ï¼š VBoxManage showvminfo winxp2 ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®ï¼š VBoxManage modifyvm â€œwinxp2â€ â€“ostype â€œWindowsXPâ€ â€“memory â€œ512â€ â€“vram â€œ16â€ â€“boot1 disk â€“boot2 dvd â€“hda â€œ/home/virtualbox/winxp2.vdiâ€ â€“sata on â€“acpi on â€“pae on â€“hwvirtex on â€“nic1 hostif â€“cableconnected1 on â€“nictype1 â€œAm79C973â€ â€“bridgeadapter1 eth0 â€“intnet1 brigh2 â€“macaddress1 auto â€“vrdp on â€“vrdpport 5000 â€“vrdpmulticon on å¯åŠ¨ç³»ç»Ÿï¼šVBoxManage startvm â€œwinxpâ€ -type vrdp 10.æ–‡ä»¶å…±äº«ï¼ˆæ•°æ®ç©ºé—´ï¼‰ virtulbaox å¯ä»¥é€šè¿‡æ˜ å°„ï¼Œç›´æŽ¥å°†å®žä½“æœºæ–‡ä»¶å…±äº«åˆ°è™šæ‹Ÿæœºä¸­ã€‚VBoxManage sharedfolder add winxp â€“name share â€“hostpath /home/virtualbox/share â€“transientç•Œé¢ä¸‹æ“ä½œå¾ˆç®€å•ï¼Œæ•°æ®ç©ºé—´æ‰“å¼€å®žä½“æœºæ–‡ä»¶ï¼Œè™šæ‹Ÿæœºæ‰“å¼€ç½‘ç»œæ˜ å°„æŒ‚è½½ä¸Šæ¥å°±å¯ä»¥ã€‚å¦‚æžœè™šæ‹Ÿæœºæ˜¯linuxï¼Œéœ€è¦åŠ è½½ç£ç›˜æ ¼å¼æ¨¡å—ï¼š modprobe vboxvfs mount -t vboxsf share_net_filenameï¼ˆå®žä½“æœºå…±äº«åï¼‰ /home/virtualbox/shareï¼ˆè™šæ‹Ÿæœºä¸­æ–‡ä»¶è·¯å¾„ï¼‰è¿™æ ·åŸºæœ¬å®žçŽ°äº†virtualboxåœ¨linuxå‘½ä»¤ä¸‹å®‰è£…ï¼Œvirtualboxå‘½ä»¤å¾ˆå¤šï¼Œè¿˜åœ¨ç»§ç»­ç ”ç©¶å­¦ä¹ ä¸­ã€‚ 3389æ˜¯VRDPï¼ˆè¿œç¨‹æ¡Œé¢ï¼‰ç›‘å¬ç«¯å£ ã€‚ å¯ç”¨VRDPåŽï¼Œä¸€æ—¦è™šæ‹Ÿæœºå¯åŠ¨å®Œæ¯•ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿œç¨‹æ¡Œé¢/XManageç­‰GUIè¿œç¨‹ç®¡ç†å·¥å…·æ¥ç™»å½•å®¢æˆ·æ“ä½œç³»ç»Ÿ ã€‚ è¦ç¡®è®¤è™šæ‹Ÿæœºæ˜¯å¦åœ¨è¿è¡Œ ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤VBoxManage list runningvm æ¥æŸ¥çœ‹ã€‚QHo@qhoferrari1k:~$ VBoxManage list runningvms ä»Žå‘½ä»¤è¡Œå…³é—­è™šæ‹Ÿæœºé€šè¿‡VBoxManage å‘½ä»¤è¡Œå·¥å…·çš„VBoxManage controlvm | å­å‘½ä»¤å¯ä»¥æ”¹å˜è™šæ‹Ÿæœºçš„è¿è¡ŒçŠ¶æ€ï¼Œå…¶ä¸­å¸¸ç”¨çš„å‡ ä¸ªé€‰é¡¹æ˜¯ï¼š pause resume reset poweroff savestate acpipowerbutton acpisleepbuttonä¸‹é¢ç¤ºä¾‹ä½¿ç”¨ poweroff é€‰é¡¹å…³é—­è™šæ‹Ÿæœº dcsvr08 QHo@qhoferrari1k:~$ VBoxManage controlvm dcsvr08 poweroffVirtualBox Command Line Management Interface Version 2.1.4(C) 2005-2009 Sun Microsystems, Inc.All rights reserved. QHo@qhoferrari1k:~$ VBoxManage list runningvmsVirtualBox Command Line Management Interface Version 2.1.4(C) 2005-2009 Sun Microsystems, Inc.All rights reserved. 3ce3fd01-7e17-46b3-8394-be9c1b17ee66QHo@qhoferrari1k:~$åœ¨poweroff åŽé©¬ä¸Šlist runningvms ï¼Œå¯ä»¥çœ‹åˆ°dscvr08å·²ç»è¢«å…³é—­ï¼ŒçŽ°åœ¨åªæœ‰ä¸€å°è™šæœºå¤„äºŽè¿è¡ŒçŠ¶æ€ã€‚ http://fengshihua.cublog.cn æ®æœ‰èµ„æ–™è¯´ï¼šè™šæ‹Ÿæœºä¸Šå®‰è£…çš„è™šæ‹Ÿç³»ç»Ÿçš„å†…å­˜ä½¿ç”¨é‡å¿…é¡»è¦ç¬¦åˆVBOXçš„è¦æ±‚ï¼Œå³ä¸èƒ½è¶…è¿‡æœºå™¨ç‰©ç†å†…å­˜çš„40ï¼…ï¼Œæ¢è¨€ä¹‹ï¼Œè¦é¢„ç•™è¶³å¤Ÿçš„å†…å­˜ä¾›çœŸå®žç³»ç»Ÿä½¿ç”¨ï¼Œå¦åˆ™ä¼šç»å¸¸å¼‚å¸¸æ­»æœºï¼Œæˆ–æ— æ³•è¿è¡Œè™šæ‹Ÿç³»ç»Ÿã€‚ä¸¾ä¾‹ï¼šæˆ‘æœºå™¨å†…å­˜ä¸º512Mï¼Œè™šæ‹ŸXPåˆ†é…128Må†…å­˜ï¼Œæ˜¾å­˜åˆ†é…32Må³å¯ã€‚å¦‚æžœè™šæ‹ŸXPåˆ†é…256Må†…å­˜ï¼Œåˆ™æ— æ³•æ­£å¸¸è¿è¡Œè™šæ‹Ÿï¼Œæ€»æ˜¯å¼‚å¸¸é€€å‡ºã€‚ çŽ¯å¢ƒï¼šUbuntu 15.04 64bitï¼Œvirtualbox 5.0.16 å‡†å¤‡ï¼šä¸‹è½½å®‰è£…å¥½virtualbox,virtualbox-extensionsï¼Œå‡†å¤‡å¥½isoç³»ç»Ÿæ–‡ä»¶ï¼Œå¦‚archlinux.isoã€‚ 1.å»ºç«‹å¥½vboxçš„ç›®å½•ã€‚ $ cd$ cd VirtualBox\ VMs/$ mkdir arch$ cd arch 2.æ–°å»ºä¸€ä¸ªvboxç£ç›˜ï¼Œâ€“sizeå‚æ•°è®¾ç½®å¤§å°ï¼Œå•ä½ï¼šMã€‚ $ vboxmanage createmedium disk â€“filename arch.vdi â€“size 10000 3.æ–°å»ºvboxè™šæ‹Ÿæœºæ–‡ä»¶ï¼Œâ€“ostypeè®¾ç½®è™šæ‹Ÿæœºå®‰è£…çš„ç³»ç»Ÿæ ¼å¼ï¼ˆwindows/ubuntuç­‰ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨vboxmanage list ostypesæŸ¥çœ‹vboxæ”¯æŒçš„ç³»ç»Ÿæ ¼å¼ã€‚ $ vboxmanage createvm â€“name arch â€“ostype â€œlinux_64â€ â€“register 4.æ–°å»ºSATAç£ç›˜æŽ§åˆ¶å™¨å¹¶å°†æ­¥éª¤ä¸­æ–°å»ºçš„ç£ç›˜ç»‘å®šåˆ°è™šæ‹Ÿæœºæ–‡ä»¶ã€‚ $ vboxmanage storagectl arch â€“name â€œSATA Controllerâ€ â€“add sata â€“controller IntelAHCI$ vboxmanage storageattach arch â€“storagectl â€œSATA Controllerâ€ â€“port 0 â€“device 0 â€“type hdd â€“medium arch.vdi 5.æ–°å»ºIDEæŽ§åˆ¶å™¨ï¼Œè®¾ç½®å®ƒä¸ºdvdï¼Œå¹¶ç»‘å®šiosæ–‡ä»¶åˆ°è¯¥dvdï¼Œæ³¨æ„â€“mediumä¸ºä½ çš„isoè·¯å¾„ã€‚ $ vboxmanage storagectl arch â€“name â€œIDE Controllerâ€ â€“add ide$ vboxmanage storageattach arch â€“storagectl â€œIDE Controllerâ€ â€“port 0 â€“device 0 â€“type dvddrive â€“medium /path/to/arch.iso 5.æŸ¥çœ‹è‡ªå·±çš„ç½‘å¡ï¼Œå¹¶è®¾ç½®vboxç½‘å¡ä¸ºæ¡¥æŽ¥ã€‚ $ ifconfig è¾“å‡ºï¼š wlp18s0 Link encap:Ethernet HWaddr xx:xx:xx:xx:xx:xxinet addr:192.168.0.101 Bcast:192.168.0.255 Mask:255.255.255.0 æˆ‘çš„ç½‘å¡æ˜¯wlp18s0ï¼Œæ‰€ä»¥å°†vbox nic1ç½‘å¡ç»‘å®šåˆ°å®ƒã€‚ $ vboxmanage modifyvm arch â€“nic1 bridged â€“bridgeadapter1 wlp18s0 6.è®¾ç½®ioæŽ§åˆ¶ï¼Œå¯åŠ¨é¡¹ï¼Œå†…å­˜ç­‰ã€‚ $ vboxmanage modifyvm arch â€“ioapic on$ vboxmanage modifyvm arch â€“boot1 dvd â€“boot2 disk â€“boot3 none â€“boot4 none$ vboxmanage modifyvm arch â€“memory 1024 â€“vram 128 7.è®¾ç½®rdpeè¿œç¨‹æ¡Œé¢ã€‚ $ vboxmanage modifyvm arch â€“vrdeport 3389 â€“vrdeaddress 0.0.0.0 8.åŽå°å¼€å¯vboxã€‚ $ vboxmanage startvm arch â€“type=headless 9.çŽ°åœ¨å°±å¯ä»¥ç”¨rdesktopè”æŽ¥åŽå°äº† $ rdesktop localhost:3389 rdesktop xxx.xxx.xx.xx:3389 10.å®‰è£…å®ŒæˆåŽé€€å‡ºdvdä¸Šçš„isoã€‚ $ vboxmanage storageattach arch â€“storagectl â€œIDE Controllerâ€ â€“port 0 â€“device 0 â€“type dvddrive â€“medium none 11.æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„vboxç³»ç»Ÿï¼Œå…³æœºã€‚ $ vboxmanage list runningvms$ vboxmanage controlvm arch poweroff æœ€åŽï¼Œå…¶ä½™åŠŸèƒ½å¯ä»¥æŸ¥çœ‹å¸®åŠ©ã€‚ $ vboxmanage â€“help webvbox wget â€˜http://sourceforge.net/projects/phpvirtualbox/files/latest/download&#39;]]></content>
  </entry>
  <entry>
    <title><![CDATA[ipcalc]]></title>
    <url>%2F2018%2F05%2F20%2Fipcalc%2F</url>
    <content type="text"><![CDATA[ipåœ°å€è®¡ç®—å™¨ipcalc 192.168.3.1/22Address: 192.168.3.1 11000000.10101000.000000 11.00000001Netmask: 255.255.252.0 = 22 11111111.11111111.111111 00.00000000Wildcard: 0.0.3.255 00000000.00000000.000000 11.11111111=&gt;Network: 192.168.0.0/22 11000000.10101000.000000 00.00000000HostMin: 192.168.0.1 11000000.10101000.000000 00.00000001HostMax: 192.168.3.254 11000000.10101000.000000 11.11111110Broadcast: 192.168.3.255 11000000.10101000.000000 11.11111111Hosts/Net: 1022 Class C, Private Internet]]></content>
      <tags>
        <tag>networkï¼Œlinux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨IRCé‡Œä½¿ç”¨weixinå’Œqq]]></title>
    <url>%2F2018%2F05%2F16%2F%E5%9C%A8IRC%E9%87%8C%E4%BD%BF%E7%94%A8weixin%E5%92%8Cqq%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç« æ˜¯ä»‹ç»æ€Žä¹ˆåœ¨linuxçš„IRCå®¢æˆ·ç«¯weechaté‡Œï¼Œè¿›è¡Œqqå’Œå¾®ä¿¡èŠå¤©å®‰è£…perlçš„Mojo-ActivePerl ä¸‹è½½ZIPåŽ‹ç¼©åŒ…(çº¦43M) 12345$ wget https://github.com/sjdy521/Mojo-ActivePerl/archive/master.zip -O Mojo-ActivePerl.zip#å¦‚æžœä¸‹è½½é€Ÿåº¦è¾ƒæ…¢å¯ä»¥ä½¿ç”¨å›½å†…çš„è…¾è®¯äº‘å­˜å‚¨åœ°å€ï¼ˆæ–‡ä»¶å¯èƒ½ä¼šè¾ƒæ—§ï¼‰$ wget http://share-10066126.cos.myqcloud.com/Mojo-ActivePerl-20170214.zip -O Mojo-ActivePerl.zip è§£åŽ‹åˆ°å½“å‰ç›®å½•å¹¶è¿›å…¥ç›®å½• 12$ unzip Mojo-ActivePerl.zip$ cd Mojo-ActivePerl-master è¿è¡Œå®‰è£…è„šæœ¬ï¼ŒæŒ‡å®šå®‰è£…ç›®å½•(éœ€è¦æœ‰æƒé™åˆ›å»ºå’Œå†™å…¥) 1$ sh install.sh --prefix /usr/local/Mojo-ActivePerl #è¿™é‡Œä»¥/usr/local/Mojo-ActivePerlç›®å½•ä¸ºä¾‹ æŠŠå¦‚ä¸‹perlå’Œcpanmæ‰€åœ¨ç›®å½•(/usr/local/Mojo-ActivePerl/bin/)æ·»åŠ åˆ°PATHçŽ¯å¢ƒå˜é‡ï¼ˆæˆ–ä¸è®¾ç½®çŽ¯å¢ƒå˜é‡ï¼Œç›´æŽ¥ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼‰ 12$ /usr/local/Mojo-ActivePerl/bin/perl$ /usr/local/Mojo-ActivePerl/bin/cpanm å®‰è£…weechat1sudo apt install weechat ç¼–å†™è„šæœ¬Mojo::Weixin;12345#!/usr/bin/env perlmy $client = Mojo::Weixin-&gt;new();$client-&gt;load(&quot;ShowMsg&quot;);$client-&gt;load(&quot;IRCShell&quot;); #åŠ è½½IRCShellæ’ä»¶$client-&gt;run(); å¯åŠ¨æœåŠ¡perl è„šæœ¬ ç”¨weecgatï¼Œé“¾æŽ¥åˆ°æœåŠ¡12weechat/server add webqq xxxxxxx å¼€å§‹èŠå¤©/join /query /nick]]></content>
  </entry>
  <entry>
    <title><![CDATA[OpsManager]]></title>
    <url>%2F2018%2F05%2F10%2FOpsManager%2F</url>
    <content type="text"><![CDATA[Dockeræž„å»ºOpsManageè¦æ±‚å…·å¤‡ä¸€å®šdockeråŸºç¡€ï¼š æž„å»ºæ­¥éª¤ï¼š 1234$ mkdir -p /data/opsmanage$ cd /data/opsmanage$ git clone https://github.com/welliamcao/OpsManage.git$ cd OpsManage 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061$ vim start.sh#!/bin/bashecho_supervisord_conf &gt; /etc/supervisord.confexport PYTHONOPTIMIZE=1cat &gt; /etc/supervisord.conf &lt;&lt; EOF[unix_http_server]file=/tmp/supervisor.sock [supervisord]logfile=/tmp/supervisord.log logfile_maxbytes=50MB logfile_backups=10 loglevel=info pidfile=/tmp/supervisord.pid nodaemon=false minfds=1024 minprocs=200 [rpcinterface:supervisor]supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface[supervisorctl]serverurl=unix:///tmp/supervisor.sock ; use a unix:// URL for a unix socket[program:celery-worker-default]command=/usr/bin/python manage.py celery worker --loglevel=info -E -Q defaultdirectory=/mnt/OpsManagestdout_logfile=/var/log/celery-worker-default.logautostart=trueautorestart=trueredirect_stderr=truestopsignal=QUITnumprocs=1[program:celery-worker-ansible]command=/usr/bin/python manage.py celery worker --loglevel=info -E -Q ansible directory=/mnt/OpsManagestdout_logfile=/var/log/celery-worker-ansible.logautostart=trueautorestart=trueredirect_stderr=truestopsignal=QUITnumprocs=1[program:celery-beat]command=/usr/bin/python manage.py celery beatdirectory=/mnt/OpsManagestdout_logfile=/var/log/celery-beat.logautostart=trueautorestart=trueredirect_stderr=truestopsignal=QUITnumprocs=1[program:celery-cam]command=/usr/bin/python manage.py celerycamdirectory=/mnt/OpsManagestdout_logfile=/var/log/celery-celerycam.logautostart=trueautorestart=trueredirect_stderr=truestopsignal=QUITnumprocs=1EOF/usr/bin/supervisord -c /etc/supervisord.confsleep 3cd /mnt/OpsManage/python /mnt/OpsManage/manage.py runserver 0.0.0.0:8000 12345678910111213$ vim superuser.json[ &#123; &quot;model&quot;: &quot;auth.user&quot;, &quot;pk&quot;: 1, &quot;fields&quot;: &#123; &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;pbkdf2_sha256$36000$eijqZp5ctxnE$xxCcAo/Rsuc+HddjGLQ6dUo/kDnuvayazUZ4V3xz52w=&quot;, &quot;is_superuser&quot;: true, &quot;is_staff&quot;: true, &quot;is_active&quot;: true &#125; &#125;] 1234567891011$ cd ../$ vim DockerfileFROM centos:latestRUN yum install -y wget git zlib zlib-devel readline-devel sqlite-devel bzip2-devel openssl-devel gdbm-devel libdbi-devel ncurses-libs kernel-devel libxslt-devel libffi-devel python-devel mysql-devel zlib-devel sshpass libtool makeRUN cd /usr/local/src &amp;&amp; wget --no-check-certificate https://github.com/pypa/pip/archive/1.5.5.tar.gz -O pip-1.5.5.tar.gz &amp;&amp; wget --no-check-certificate https://pypi.python.org/packages/f7/94/eee867605a99ac113c4108534ad7c292ed48bf1d06dfe7b63daa51e49987/setuptools-28.0.0.tar.gz#md5=9b23df90e1510c7353a5cf07873dcd22RUN cd /usr/local/src &amp;&amp; tar -xzvf setuptools-28.0.0.tar.gz &amp;&amp; tar -xzvf pip-1.5.5.tar.gz &amp;&amp; cd setuptools-28.0.0 &amp;&amp; python setup.py install &amp;&amp; cd ../pip-1.5.5 &amp;&amp; python setup.py install &amp;&amp; pip install -U pip &amp;&amp; easy_install paramiko==2.4.1RUN mkdir -p /etc/ansible/ &amp;&amp; echo -ne &quot;[defaults]\nlibrary = /usr/share/ansible/my_modules/\nhost_key_checking = False\n&quot; &gt; /etc/ansible/ansible.cfg &amp;&amp; echo &quot;welliam&quot; | passwd --stdin rootADD OpsManage /mnt/OpsManage/RUN pip install -r /mnt/OpsManage/requirements.txt &amp;&amp; cd /mnt/OpsManage/ &amp;&amp; python manage.py makemigrations OpsManage &amp;&amp; python manage.py makemigrations wiki &amp;&amp; python manage.py migrate &amp;&amp; python manage.py loaddata superuser.jsonCMD bash /mnt/OpsManage/start.shEXPOSE 8000 :wq ä¿å­˜é€€å‡º 2ã€ä¿®æ”¹OpsManage setting.pyé…ç½®æ–‡ä»¶é‡Œé¢çš„MySQLä¸ŽRedisè®¾ç½® 1$ vim /data/opsmanage/OpsManage/OpsManage/settings.py 3ã€Docker buildæž„å»ºåŸºç¡€é•œåƒï¼š 1$ docker build -t opsmanage:base . æ³¨ï¼šç¬¬ä¸€æ¬¡æž„å»ºæ—¶é—´ä¼šå¾ˆé•¿ï¼Œè¦æ³¨æ„ç­‰å¾…æˆ–è€…æ˜¯å¦å‡ºé”™ 4ã€Docker runè¿è¡Œåˆšåˆšæž„å»ºçš„é•œåƒ 1$ docker run -d --name=opsmanage -v /data/opsmanage/OpsManage:/mnt/OpsManage -p 8000:8000 -p 2222:22 opsmanage:base 5ã€æµè§ˆå™¨è®¿é—®http://ip:8000 é»˜è®¤è´¦æˆ·å¯†ç æ˜¯admin/admin]]></content>
  </entry>
  <entry>
    <title><![CDATA[chromedriverä¸Žchromeç‰ˆæœ¬æ˜ å°„è¡¨]]></title>
    <url>%2F2018%2F05%2F01%2Fchromedriver%E4%B8%8Echrome%E7%89%88%E6%9C%AC%E6%98%A0%E5%B0%84%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[çœ‹åˆ°ç½‘ä¸ŠåŸºæœ¬æ²¡æœ‰æœ€æ–°çš„chromedriverä¸Žchromeçš„å¯¹åº”å…³ç³»è¡¨ï¼Œä¾¿å…´èµ·æ•´ç†äº†ä¸€ä»½å¦‚ä¸‹ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ç”¨ï¼š http://chromedriver.storage.googleapis.com/2.9/notes.txt 123456echo "" &gt;ch.list for i in `curl -s http://npm.taobao.org/mirrors/chromedriver| grep -e "chromedriver/[0-9].[0-9]*"| awk -F'/' '&#123;print $4&#125;'`do curl -s http://npm.taobao.org/mirrors/chromedriver/$i/notes.txt|grep -v "fails" |grep -e"v[0-9]*[.\-][0-9]*"&gt;&gt;ch.list done ç»“æžœå¦‚ä¸‹ï¼š 12cat ch.list| awk -F'V| ' '&#123;if($1=="Supports")&#123;print "Supports Chrome " $3$4&#125;else&#123;print $2$3&#125;&#125;'#ç”¨ï½ï½’ï½‰ï½Žï½”ï½†ä¼šæ··ä¹± ChromeDriver v2.9(2014-01-31)----------&gt;Chrome:v31-34 ChromeDriver v2.8(2013-12-16)----------&gt;Chrome:v30-33 ChromeDriver v2.7(2013-11-22)----------&gt;Chrome:v30-33 ChromeDriver v2.6(2013-11-04)----------&gt;Chrome:v29-32 ChromeDriver v2.5(2013-11-01)----------&gt;Chrome:v29-32 ChromeDriver v2.4(2013-09-30)----------&gt;Chrome:v29-32 ChromeDriver v2.37(2018-03-16)----------&gt;Chrome:v64-66 ChromeDriver v2.36(2018-03-02)----------&gt;Chrome:v63-65 ChromeDriver v2.35(2018-01-10)----------&gt;Chrome:v62-64 ChromeDriver v2.34(2017-12-10)----------&gt;Chrome:v61-63 ChromeDriver v2.33(2017-10-03)----------&gt;Chrome:v60-62 ChromeDriver v2.32(2017-08-30)----------&gt;Chrome:v59-61 ChromeDriver v2.3(2013-09-02)---------- ChromeDriver v2.31(2017-07-21)----------&gt;Chrome:v58-60 ChromeDriver v2.30(2017-06-07)----------&gt;Chrome:v58-60 ChromeDriver v2.29(2017-04-04)----------&gt;Chrome:v56-58 ChromeDriver v2.28(2017-03-09)----------&gt;Chrome:v55-57 ChromeDriver v2.27(2016-12-23)----------&gt;Chrome:v54-56 ChromeDriver v2.26(2016-12-09)----------&gt;Chrome:v53-55 ChromeDriver v2.25(2016-10-25)----------&gt;Chrome:v53-55 ChromeDriver v2.24(2016-09-09)----------&gt;Chrome:v52-54 ChromeDriver v2.23(2016-08-04)----------&gt;Chrome:v51-53 ChromeDriver v2.22(2016-06-06)----------&gt;Chrome:v49-52 ChromeDriver v2.2(2013-08-06)---------- ChromeDriver v2.21(2016-01-28)----------&gt;Chrome:v46-50 ChromeDriver v2.20(2015-10-08)----------&gt;Chrome:v43-48 ChromeDriver v2.19(2015-08-28)----------&gt;Chrome:v43-47 ChromeDriver v2.18(2015-08-19)----------&gt;Chrome:v43-46 ChromeDriver v2.15(2015-03-26)----------&gt;Chrome:v40-43 ChromeDriver v2.14(2015-01-28)----------&gt;Chrome:v39-42 ChromeDriver v2.13(2014-12-10)----------&gt;Chrome:v38-41 ChromeDriver v2.12(2014-10-27)----------&gt;Chrome:v36-40 ChromeDriver v2.11(2014-10-07)----------&gt;Chrome:v36-40 ChromeDriver v2.10(2014-05-01)----------&gt;Chrome:v33-36 http://chromedriver.storage.googleapis.com/index.html]]></content>
  </entry>
  <entry>
    <title><![CDATA[å®žçŽ°Zabbixé€šè¿‡é‚®ä»¶å‘é€å›¾å½¢æŠ¥è¡¨]]></title>
    <url>%2F2018%2F04%2F26%2F%E5%AE%9E%E7%8E%B0Zabbix%E9%80%9A%E8%BF%87%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[å®žçŽ°Zabbixé€šè¿‡é‚®ä»¶å‘é€å›¾å½¢æŠ¥è¡¨åœ¨ä½¿ç”¨Zabbixçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå»ºç«‹ä¸€äº›éœ€è¦å›¾å½¢æŠ¥è¡¨æ¥æ±‡æ€»éœ€è¦ç›‘æŽ§çš„Graphã€‚è€Œä¸‹é¢çš„ä¸¤ä¸ªè„šæœ¬ï¼Œåˆ™æ˜¯é€šè¿‡ä»ŽZabbixæ•°æ®åº“ä¸­èŽ·å–æ‰€æœ‰çš„å›¾å½¢æ•°æ®ï¼Œæä¾›Zabbixçš„WEBæŽ¥å£å°†æ‰€æœ‰å›¾å½¢ä¿å­˜åˆ°æœ¬åœ°ï¼Œç„¶åŽé€šè¿‡è„šæœ¬ä»¥Emailå½¢å¼å‘é€è¿‡æ¥ï¼Œä½œä¸ºæ¯å¤©çš„è‡ªåŠ¨æŠ¥è¡¨ã€‚ åœ¨æœ¬åœ°åˆ›å»º/data/cscript å’Œ /data/graph ç›®å½• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#!/usr/bin/perluse File::Path;use DBI;use Net::FTP;##å®šä¹‰graphè·¯å¾„ï¼Œåˆ¤æ–­graphç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨æ–°å»ºmy $path = &apos;/data/graph&apos;;if(-e $path) &#123; rmtree($path); &#125;mkdir($path);#my $stime = `date +%Y%m%d`; chop($stime); $stime .= &apos;1000&apos;;if( length($stime) != 12 ) &#123; print &quot;Error get date&quot;; exit; &#125;##æŒ‡å®šæˆªå›¾å›¾å½¢çš„æ—¶é—´è½´å‘¨æœŸmy $period = 21600; # 6 hours##å®šä¹‰Webçš„ç™»é™†ååŠå¯†ç my $login = &apos;admin&apos;; # Zabbix Web Usermy $pass = &apos;password&apos;; # Zabbix Web User Password, must be URL Encoded##å®šä¹‰FTPè´¦å·å¯†ç my $ftp_site = &apos;ftp.corp.intra&apos;;my $ftp_user_name = &apos;zabbix&apos;;my $ftp_password = &apos;zabbix&apos;;##å®šä¹‰cookieçš„è·¯å¾„my $cook = &quot;/tmp/cookie&quot;;##æŒ‡å®šé“¾æŽ¥æ•°æ®åº“my $dsn = &apos;DBI:mysql:zabbix:localhost&apos;; # Connect MySQL DB &quot;zabbix&quot; on localhostmy $db_user_name = &apos;zabbix&apos;; # MySQL DB usermy $db_password = &apos;dbpassword&apos;; # MySQL DB user passwordmy $dbh = DBI-&gt;connect($dsn, $db_user_name, $db_password);##æŸ¥è¯¢å­˜åœ¨å“ªäº›screenmy $sth = $dbh-&gt;prepare(qq&#123;select a.name,a.hsize,a.vsize, b.resourceid, b.width, b.height,b.x,b.y from screens a,screens_items as b where a.screenid=b.screenid and a.templateid&lt;=&gt;NULL order by a.name&#125;);$sth-&gt;execute();my %screens;## Get all graphs by using curlwhile (my ($name,$hsize,$vsize, $id,$width,$height,$x,$y) = $sth-&gt;fetchrow_array())&#123;##é•¿åº¦å¤§äºŽ2ä½çš„æ˜¯graphï¼Œå°äºŽ2ä½çš„è¡¨ç¤ºæ˜¯MAPif(length($id) &gt; 2)&#123;#print &quot;$id =&gt; $ids\n&quot;;##å®šä¹‰å¯¼å‡ºçš„æ–‡ä»¶è·¯å¾„åŠæ–‡ä»¶åmy $p = &quot;$path/$name.$hsize.$vsize.$y.$x.$id.png&quot;;##èŽ·å–cookieï¼Œå…é™¤è®¿é—®å®žé™…æ•°æ®æ—¶éœ€è¦è®¤è¯my $strcomm = `curl -D $cook -b $cook -d &quot;request=&amp;name=$login&amp;password=$pass&amp;autologin=1&amp;enter=Sign+in&quot; localhost/zabbix/index.php`;##èŽ·å–å›¾å½¢æ–‡ä»¶$strcomm = `curl -b $cook -F &quot;graphid=$id&quot; -F &quot;period=$period&quot; -F &quot;stime=$stime&quot; -F &quot;width=$width&quot; -F &quot;height=$height&quot; localhost/zabbix/chart2.php &gt; $p`;&#125;##å¦åˆ™ï¼Œå°äºŽ2ä½çš„è¡¨ç¤ºæ˜¯MAPelse &#123;my $p = &quot;$path/map.$name.$id.png&quot;;my $strcomm = `curl -b $cook -F &quot;sysmapid=$id&quot; localhost/zabbix/map.php &gt; $p`; ##ftpåˆ°æœåŠ¡å™¨ä¸Šmy $ftp = Net::FTP-&gt;new($FTP_Site,Timeout =&gt; 30) or die &quot;could not connect.\n&quot;;$ftp-&gt;login($ftp_user_name,$ftp_password) or die &quot;Could not login.\n&quot;;$ftp-&gt;binary,$ftp-&gt;message;#$remotefile = &quot;Lync.png&quot;;#$localfile = &quot;$path/$p&quot;;$ftp-&gt;put($p) or die &quot;put $remotefile fail.\n&quot;,$ftp-&gt;message;$ftp-&gt;quit;&#125;&#125;exit ; email-pic.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128#! /usr/bin/env pythonimport osimport smtplibfrom email.MIMEMultipart import MIMEMultipartfrom email.MIMEText import MIMETextfrom email.MIMEImage import MIMEImage# å®šä¹‰å‡½æ•° _sendmaildef _sendmail(smtp_server,port,account,password,str_from,list_to,msg): smtp = smtplib.SMTP(smtp_server,port) smtp.ehlo() smtp.starttls() smtp.ehlo()# smtp.login(account, password) smtp.sendmail(str_from, list_to,msg) smtp.close() # å®šä¹‰å‡½æ•° _get_picturesdef _get_pictures(image_dir):#å»ºç«‹ç©ºåˆ—è¡¨Pictures pictures = []#os.listdir è¿”å›žæŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•å for f in os.listdir(image_dir):# append æ˜¯åœ¨åˆ—è¡¨æœ€åŽå¢žåŠ å†…å®¹ï¼Œè¿™é‡Œæ˜¯å°†listå‡ºæ¥çš„ä¿¡æ¯få¢žåŠ åˆ°Pictureåˆ—è¡¨ä¸­ pictures.append(f) return pictures# å®šä¹‰å‡½æ•° _create_msgdef _create_msg(screen_name,screens,image_dir,str_from,list_to): msgRoot = MIMEMultipart('related') # å®šä¹‰é‚®ä»¶ä¸»é¢˜ msgRoot['Subject'] = 'Zabbix Screen Report: %s' % screen_name #å®šä¹‰å‘ä»¶äººã€æ”¶ä»¶äºº msgRoot['From'] = str_from msgRoot['To'] = ",".join(list_to) msgRoot.preamble = 'This is a multi-part message in MIME format.' # Encapsulate the plain and HTML versions of the message body in an # 'alternative' part, so message agents can decide which they want to display. msgAlternative = MIMEMultipart('alternative') msgRoot.attach(msgAlternative)# å®šä¹‰é‚®ä»¶æ­£æ–‡å†…å®¹ msgText = MIMEText('This is the alternative plain text message.') msgAlternative.attach(msgText) contents = ""# tuple å…ƒç»„ å®šä¹‰hsize,vsizeå˜é‡ contents += "&lt;h1&gt;Screen %s&lt;/h1&gt;&lt;br&gt;" % screen_name _,hsize,vsize,_,_,_,_,= tuple(screens[0].split('.')) contents +="&lt;table&gt;" # sorted()æ˜¯äº§ç”Ÿä¸€ä¸ªæ–°çš„åˆ—è¡¨å¹¶æŽ’åº screens = sorted(screens) y= -1 for f in screens:# å°†æ–‡ä»¶åä»¥ä¸º.åˆ†å‰²ç‚¹ items = f.split('.') # åŽŸæ–‡ä»¶åæ ¼å¼:$path/$name.$hsize.$vsize.$y.$x.$id.png# ç»è¿‡åˆ‡ç‰‡åŽå– image_Y,Image_x,image_ID # tuple å…ƒç»„ _,_,_,image_y,image_x,image_id,_ = tuple(items) #å®šä¹‰é‚®ä»¶ä¸­çš„å›¾ç‰‡æ–‡ä»¶åï¼šimage-screen_name-image_id image_name = "image-%s-%s" % (screen_name, image_id) #fp = open("test.txt",w) ç›´æŽ¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶ #å…³äºŽopen æ¨¡å¼ï¼š #w ä»¥å†™æ–¹å¼æ‰“å¼€ï¼Œ #a ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€ (ä»Ž EOF å¼€å§‹, å¿…è¦æ—¶åˆ›å»ºæ–°æ–‡ä»¶) #r+ ä»¥è¯»å†™æ¨¡å¼æ‰“å¼€ #w+ ä»¥è¯»å†™æ¨¡å¼æ‰“å¼€ (å‚è§ w ) #a+ ä»¥è¯»å†™æ¨¡å¼æ‰“å¼€ (å‚è§ a ) #rb ä»¥äºŒè¿›åˆ¶è¯»æ¨¡å¼æ‰“å¼€ #wb ä»¥äºŒè¿›åˆ¶å†™æ¨¡å¼æ‰“å¼€ (å‚è§ w ) #ab ä»¥äºŒè¿›åˆ¶è¿½åŠ æ¨¡å¼æ‰“å¼€ (å‚è§ a ) #rb+ ä»¥äºŒè¿›åˆ¶è¯»å†™æ¨¡å¼æ‰“å¼€ (å‚è§ r+ ) #wb+ ä»¥äºŒè¿›åˆ¶è¯»å†™æ¨¡å¼æ‰“å¼€ (å‚è§ w+ ) #ab+ ä»¥äºŒè¿›åˆ¶è¯»å†™æ¨¡å¼æ‰“å¼€ (å‚è§ a+ ) fp = open('%s/%s' % (image_dir,f), 'rb') #fp.read([size]) #sizeä¸ºè¯»å–çš„é•¿åº¦ï¼Œä»¥byteä¸ºå•ä½ msgImage = MIMEImage(fp.read()) #fp.close() #å…³é—­æ–‡ä»¶ã€‚pythonä¼šåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸ç”¨åŽè‡ªåŠ¨å…³é—­æ–‡ä»¶ï¼Œä¸è¿‡è¿™ä¸€åŠŸèƒ½æ²¡æœ‰ä¿è¯ï¼Œæœ€å¥½è¿˜æ˜¯å…»æˆè‡ªå·±å…³é—­çš„ä¹ æƒ¯ã€‚ #å¦‚æžœä¸€ä¸ªæ–‡ä»¶åœ¨å…³é—­åŽè¿˜å¯¹å…¶è¿›è¡Œæ“ä½œä¼šäº§ç”ŸValueError fp.close() msgImage.add_header('Content-ID', "&lt;%s&gt;" % image_name) msgRoot.attach(msgImage)#å®šä¹‰å¾ªçŽ¯ if y != image_y: if y!= -1: contents +="&lt;/tr&gt;" y = image_y contents +="&lt;tr&gt;" # å®šä¹‰tdä¸­åµŒå¥—å›¾ç‰‡æ–‡ä»¶ contents +="&lt;td&gt;&lt;img src='cid:%s'&gt;&lt;/td&gt;" % image_name # tableç»“æŸ contents += "&lt;/table&gt;"# å®šä¹‰é‚®ä»¶æ ¼å¼ä¸ºHTML msgText = MIMEText(contents, 'html') msgAlternative.attach(msgText)# msgRoot.attach(msgAlternative) return msgRoot# Create the root message and fill in the from, to, and subject headersdef main(str_from,list_to,image_dir): pictures = _get_pictures(image_dir)# å®šä¹‰screen name,å¦‚: Citrix_APP_Server_Loading for screen_name in list(set([x.split('.')[0] for x in pictures ])):# startswith åˆ¤æ–­å­—ä¸²å¼€å§‹# screens æ˜¯ä¸€ç»„ ç›¸åŒå‰ç¼€çš„æ–‡ä»¶,å¦‚: screens ['Zabbix_server.2.2.1.1.525.png', 'Zabbix_server.2.2.1.0.524.png'] screens = [x for x in pictures if x.startswith(str(screen_name) + '.') ] msgRoot = _create_msg(screen_name,screens,image_dir,str_from,list_to) #å®šä¹‰é‚®ä»¶æœåŠ¡å™¨åœ°å€ã€ç«¯å£ _sendmail(smtp_server,port,'','',str_from,list_to,msgRoot.as_string())# å®šä¹‰å‘é€é‚®ä»¶ä¿¡æ¯ï¼Œå‘ä»¶äººï¼Œæ”¶ä»¶äººï¼Œå›¾ç‰‡ç›®å½•if __name__ == '__main__': smtp_server = '10.210.1.16' port = 25 str_from = 'adm_zbx@corp.com.cn' list_to = [ "roger.ling@corp.com.cn" ] image_dir = '/data/graph/maps' main(str_from,list_to,image_dir)]]></content>
      <tags>
        <tag>zabbix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AWS]]></title>
    <url>%2F2018%2F04%2F25%2FAWS%2F</url>
    <content type="text"><![CDATA[å¼€å§‹ä½¿ç”¨ Elastic Container Registryæž„å»ºã€æ ‡è®°å’ŒæŽ¨é€ Docker æ˜ åƒçŽ°åœ¨æ‚¨çš„å­˜å‚¨åº“å·²å­˜åœ¨ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ­¥éª¤æŽ¨é€ Docker æ˜ åƒ: å·²æˆåŠŸåˆ›å»ºå­˜å‚¨åº“123123123.dkr.ecr.us-east-2.amazonaws.com/asdasd-api å®‰è£… AWS CLI å’Œ Docker ä»¥åŠæœ‰å…³ä»¥ä¸‹æ­¥éª¤çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—® ECR æ–‡æ¡£é¡µé¢1) . æ£€ç´¢æ‚¨å¯ç”¨æ¥å¯¹ Docker å®¢æˆ·ç«¯è¿›è¡Œèº«ä»½éªŒè¯ä»¥å…è®¸å…¶è®¿é—®æ³¨å†Œè¡¨çš„ docker login å‘½ä»¤: aws ecr get-login â€“no-include-email â€“region us-east-2 2) è¿è¡Œä¸Šä¸€æ­¥ä¸­è¿”å›žçš„ docker login å‘½ä»¤ã€‚ æ³¨æ„ï¼šå¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯ Windows PowerShellï¼Œè¯·æ”¹ä¸ºè¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚ Invoke-Expression -Command (aws ecr get-login â€“no-include-email â€“region us-east-2) 3) ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ Docker æ˜ åƒã€‚æœ‰å…³ä»Žå¤´å¼€å§‹ç”Ÿæˆ Docker æ–‡ä»¶çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…æ­¤å¤„çš„è¯´æ˜Žã€‚å¦‚æžœæ‚¨å·²ç”Ÿæˆæ˜ åƒï¼Œåˆ™å¯è·³è¿‡æ­¤æ­¥éª¤: docker build -t 123123-api . 4) ç”Ÿæˆå®ŒæˆåŽï¼Œæ ‡è®°æ‚¨çš„æ˜ åƒï¼Œä»¥ä¾¿å°†æ˜ åƒæŽ¨é€åˆ°æ­¤å­˜å‚¨åº“: docker tag lucas-api:latest 123123123.dkr.ecr.us-east-2.amazonaws.com/123123-api:latest 5) è¿è¡Œä»¥ä¸‹å‘½ä»¤å°†æ­¤æ˜ åƒæŽ¨é€åˆ°æ‚¨æ–°åˆ›å»ºçš„ AWS å­˜å‚¨åº“: docker push 213123123123123.dkr.ecr.us-east-2.amazonaws.com/123123-api:latest]]></content>
  </entry>
  <entry>
    <title><![CDATA[MySQLè‡ªå¸¦çš„æ€§èƒ½åŽ‹åŠ›æµ‹è¯•å·¥å…·mysqlslapè¯¦è§£]]></title>
    <url>%2F2018%2F04%2F24%2FMySQL%E8%87%AA%E5%B8%A6%E7%9A%84%E6%80%A7%E8%83%BD%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7mysqlslap%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[æŸ¥çœ‹é“¾æŽ¥ï¼š12345678910mysqladmin -uroot -p1234.com statusUptime: 1370150 Threads: 1 ï¼ˆå½“å‰è¿žæŽ¥æ•°ï¼‰ Questions: 79 Slow queries: 0 Opens: 33 Flush tables: 1 Open tables: 26 Queries per second avg: 0.000mysql -uroot -p1234.com -e &apos;show status&apos; | grep -i Threads Delayed_insert_threads 0Slow_launch_threads 0Threads_cached 1Threads_connected 1Threads_created 2Threads_running 1 ##ï¼ˆå½“å‰è¿žæŽ¥æ•°ï¼‰ æŸ¥çœ‹æœ€å¤§è¿žæŽ¥æ•°12mysql -uroot -p1234.com -e &apos;show variables&apos; | grep max_connectionsmax_connections 500 è§£å†³æ–¹æ³•ï¼šæƒ³å°½ä¸€åˆ‡åŠžæ³•ä¸é‡å¯ è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯è¿›ä¸åŽ»æ•°æ®åº“äº†ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶å¾—é‡å¯ï¼Œå¯¹äºŽçº¿ä¸Šçš„æ•°æ®åº“é£Žé™©å¤ªå¤§äº†ï¼Œè¿›å…¥æ•°æ®åº“ç”¨sqlä¿®æ”¹ï¼ŒçŽ°åœ¨æ˜¯è¿›ä¸åŽ»äº† æ–¹æ³•1ï¼š ä½¿ç”¨gdbå·¥å…· ä¸ç”¨è¿›å…¥æ•°æ®åº“ï¼Œä¸ç”¨é‡å¯æ•°æ®åº“ æ–¹æ³•å¦‚ä¸‹ï¼š 1gdb -p $(cat /data/mydata/xxx.pid) -ex &quot;set max_connections=500&quot; -batch æŸ¥çœ‹mysql pidä½ç½®çš„æ–¹æ³• åœ¨é…ç½®æ–‡ä»¶ my.cnfé‡ŒæŸ¥æ‰¾ ç”¨ ps -ef | grep mysql æŸ¥æ‰¾ 1234567mysql&gt; show variables like &apos;%pid%&apos;;+---------------+----------------------+| Variable_name | Value |+---------------+----------------------+| pid_file | /data/mydata/xxx.pid |+---------------+----------------------+1 row in set (0.00 sec) 1ä¿®æ”¹å®Œæ¯•åŽ ï¼Œå°è¯•é‡æ–°è¿›å…¥æ•°æ®åº“ï¼Œå¹¶æŸ¥çœ‹é“¾æŽ¥æ•° è¿™ç§æ–¹æ³•è®¾ç½®åŽï¼Œåªæ˜¯æš‚æ—¶çš„ï¼Œæ•°æ®åº“é‡å¯åŽï¼Œä¼šå˜ä¸ºåŽŸæ¥çš„æ•°å€¼ï¼Œè¦æƒ³æ°¸ä¹…ï¼Œè®¾ç½®å®ŒåŽä¿®æ”¹é…ç½®æ–‡ä»¶my.cnf 12 æ–¹æ³•2 å‰ææ˜¯è¿˜å¯ä»¥è¿›å…¥æ•°æ®åº“ è¿›å…¥æ•°æ®åº“ è®¾ç½®æ–°çš„æœ€å¤§è¿žæŽ¥æ•°ä¸º200ï¼šmysql&gt; set GLOBAL max_connections=200 æ˜¾ç¤ºå½“å‰è¿è¡Œçš„Queryï¼šmysql&gt; show processlist æ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼šmysql&gt; show status é€€å‡ºå®¢æˆ·ç«¯ï¼šmysql&gt; exit è¿™ç§æ–¹æ³•è®¾ç½®åŽï¼Œåªæ˜¯æš‚æ—¶çš„ï¼Œæ•°æ®åº“é‡å¯åŽï¼Œä¼šå˜ä¸ºåŽŸæ¥çš„æ•°å€¼ï¼Œè¦æƒ³æ°¸ä¹…ï¼Œè®¾ç½®å®ŒåŽä¿®æ”¹é…ç½®æ–‡ä»¶my.cnf æ–¹æ³•3ï¼š éœ€è¦é‡å¯æ•°æ®åº“ ä¿®æ”¹ my.conf max_connection = 1000; æ¨¡æ‹Ÿmysqlè¿žæŽ¥æ•°è¿‡å¤š1234567#!/bin/bashset j=2while true do let &quot;j=j+1&quot;/usr/local/mysql/bin/mysqlslap -a -c 500 -i 10 -uroot -p1234.comdone MySQLè‡ªå¸¦çš„æ€§èƒ½åŽ‹åŠ›æµ‹è¯•å·¥å…·mysqlslapè¯¦è§£ä¸‹å›¾æ˜¯è¿è¡Œmysqlslap -a -c 500 -i 10 -uroot -p123456æµ‹è¯•æ—¶mysqlçš„è¿žæŽ¥è¿›ç¨‹æ•°ï¼š ä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š# mysqlslap [options] å¸¸ç”¨å‚æ•° [options] è¯¦ç»†è¯´æ˜Žï¼šâ€“auto-generate-sql, -a è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•è¡¨å’Œæ•°æ®ï¼Œè¡¨ç¤ºç”¨mysqlslapå·¥å…·è‡ªå·±ç”Ÿæˆçš„SQLè„šæœ¬æ¥æµ‹è¯•å¹¶å‘åŽ‹åŠ›ã€‚ â€“auto-generate-sql-load-type=type æµ‹è¯•è¯­å¥çš„ç±»åž‹ã€‚ä»£è¡¨è¦æµ‹è¯•çš„çŽ¯å¢ƒæ˜¯è¯»æ“ä½œè¿˜æ˜¯å†™æ“ä½œè¿˜æ˜¯ä¸¤è€…æ··åˆçš„ã€‚å–å€¼åŒ…æ‹¬ï¼šreadï¼Œkeyï¼Œwriteï¼Œupdateå’Œmixed(é»˜è®¤)ã€‚ â€“auto-generate-sql-add-auto-increment ä»£è¡¨å¯¹ç”Ÿæˆçš„è¡¨è‡ªåŠ¨æ·»åŠ auto_incrementåˆ—ï¼Œä»Ž5.1.18ç‰ˆæœ¬å¼€å§‹æ”¯æŒã€‚ â€“number-char-cols=N, -x N è‡ªåŠ¨ç”Ÿæˆçš„æµ‹è¯•è¡¨ä¸­åŒ…å«å¤šå°‘ä¸ªå­—ç¬¦ç±»åž‹çš„åˆ—ï¼Œé»˜è®¤1â€“number-int-cols=N, -y N è‡ªåŠ¨ç”Ÿæˆçš„æµ‹è¯•è¡¨ä¸­åŒ…å«å¤šå°‘ä¸ªæ•°å­—ç±»åž‹çš„åˆ—ï¼Œé»˜è®¤1â€“number-of-queries=N æ€»çš„æµ‹è¯•æŸ¥è¯¢æ¬¡æ•°(å¹¶å‘å®¢æˆ·æ•°Ã—æ¯å®¢æˆ·æŸ¥è¯¢æ¬¡æ•°) â€“query=name,-q ä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬æ‰§è¡Œæµ‹è¯•ï¼Œä¾‹å¦‚å¯ä»¥è°ƒç”¨è‡ªå®šä¹‰çš„ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹æˆ–è€…sqlè¯­å¥æ¥æ‰§è¡Œæµ‹è¯•ã€‚ â€“create-schema ä»£è¡¨è‡ªå®šä¹‰çš„æµ‹è¯•åº“åç§°ï¼Œæµ‹è¯•çš„schemaï¼ŒMySQLä¸­schemaä¹Ÿå°±æ˜¯databaseã€‚ â€“commint=N å¤šå°‘æ¡DMLåŽæäº¤ä¸€æ¬¡ã€‚ â€“compress, -C å¦‚æžœæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ”¯æŒéƒ½åŽ‹ç¼©ï¼Œåˆ™åŽ‹ç¼©ä¿¡æ¯ä¼ é€’ã€‚ â€“concurrency=N, -c N è¡¨ç¤ºå¹¶å‘é‡ï¼Œä¹Ÿå°±æ˜¯æ¨¡æ‹Ÿå¤šå°‘ä¸ªå®¢æˆ·ç«¯åŒæ—¶æ‰§è¡Œselectã€‚å¯æŒ‡å®šå¤šä¸ªå€¼ï¼Œä»¥é€—å·æˆ–è€…â€“delimiterå‚æ•°æŒ‡å®šçš„å€¼åšä¸ºåˆ†éš”ç¬¦ã€‚ä¾‹å¦‚ï¼šâ€“concurrency=100,200,500ã€‚ â€“engine=engine_name, -e engine_name ä»£è¡¨è¦æµ‹è¯•çš„å¼•æ“Žï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨åˆ†éš”ç¬¦éš”å¼€ã€‚ä¾‹å¦‚ï¼šâ€“engines=myisam,innodbã€‚ â€“iterations=N, -i N æµ‹è¯•æ‰§è¡Œçš„è¿­ä»£æ¬¡æ•°ï¼Œä»£è¡¨è¦åœ¨ä¸åŒå¹¶å‘çŽ¯å¢ƒä¸‹ï¼Œå„è‡ªè¿è¡Œæµ‹è¯•å¤šå°‘æ¬¡ã€‚ â€“only-print åªæ‰“å°æµ‹è¯•è¯­å¥è€Œä¸å®žé™…æ‰§è¡Œã€‚ â€“detach=N æ‰§è¡ŒNæ¡è¯­å¥åŽæ–­å¼€é‡è¿žã€‚ â€“debug-info, -T æ‰“å°å†…å­˜å’ŒCPUçš„ç›¸å…³ä¿¡æ¯ã€‚` è¯´æ˜Žï¼šæµ‹è¯•çš„è¿‡ç¨‹éœ€è¦ç”Ÿæˆæµ‹è¯•è¡¨ï¼Œæ’å…¥æµ‹è¯•æ•°æ®ï¼Œè¿™ä¸ªmysqlslapå¯ä»¥è‡ªåŠ¨ç”Ÿæˆï¼Œé»˜è®¤ç”Ÿæˆä¸€ä¸ªmysqlslapçš„schemaï¼Œå¦‚æžœå·²ç»å­˜åœ¨åˆ™å…ˆåˆ é™¤ã€‚å¯ä»¥ç”¨--only-printæ¥æ‰“å°å®žé™…çš„æµ‹è¯•è¿‡ç¨‹ï¼Œæ•´ä¸ªæµ‹è¯•å®ŒæˆåŽä¸ä¼šåœ¨æ•°æ®åº“ä¸­ç•™ä¸‹ç—•è¿¹ã€‚ å„ç§æµ‹è¯•å‚æ•°å®žä¾‹ï¼ˆ-påŽé¢è·Ÿçš„æ˜¯mysqlçš„rootå¯†ç ï¼‰ï¼š æµ‹è¯•åŒæ—¶ä¸åŒçš„å­˜å‚¨å¼•æ“Žçš„æ€§èƒ½è¿›è¡Œå¯¹æ¯”ï¼š# mysqlslap -a --concurrency=50,100 --number-of-queries 1000 --iterations=5 --engine=myisam,innodb --debug-info -uroot -p123456 æ‰§è¡Œä¸€æ¬¡æµ‹è¯•ï¼Œåˆ†åˆ«50å’Œ100ä¸ªå¹¶å‘ï¼Œæ‰§è¡Œ1000æ¬¡æ€»æŸ¥è¯¢ï¼š# mysqlslap -a --concurrency=50,100 --number-of-queries 1000 --debug-info -uroot -p123456 50å’Œ100ä¸ªå¹¶å‘åˆ†åˆ«å¾—åˆ°ä¸€æ¬¡æµ‹è¯•ç»“æžœ(Benchmark)ï¼Œå¹¶å‘æ•°è¶Šå¤šï¼Œæ‰§è¡Œå®Œæ‰€æœ‰æŸ¥è¯¢çš„æ—¶é—´è¶Šé•¿ã€‚ä¸ºäº†å‡†ç¡®èµ·è§ï¼Œå¯ä»¥å¤šè¿­ä»£æµ‹è¯•å‡ æ¬¡:# mysqlslap -a --concurrency=50,100 --number-of-queries 1000 --iterations=5 --debug-info -uroot -p123456 å®žä¾‹1è¯´æ˜Ž:æµ‹è¯•100ä¸ªå¹¶å‘çº¿ç¨‹ï¼Œæµ‹è¯•æ¬¡æ•°1æ¬¡ï¼Œè‡ªåŠ¨ç”ŸæˆSQLæµ‹è¯•è„šæœ¬ï¼Œè¯»ã€å†™ã€æ›´æ–°æ··åˆæµ‹è¯•ï¼Œè‡ªå¢žé•¿å­—æ®µï¼Œæµ‹è¯•å¼•æ“Žä¸ºinnodbï¼Œå…±è¿è¡Œ5000æ¬¡æŸ¥è¯¢#mysqlslap -h127.0.0.1 -uroot -p123456789 â€“concurrency=100 â€“iterations=1 â€“auto-generate-sql â€“auto-generate-sql-load-type=mixed â€“auto-generate-sql-add-autoincrement â€“engine=innodb â€“number-of-queries=5000BenchmarkRunning for engine innodbAverage number of seconds to run all queries: 0.351 seconds 100ä¸ªå®¢æˆ·ç«¯ï¼ˆå¹¶å‘ï¼‰åŒæ—¶è¿è¡Œè¿™äº›SQLè¯­å¥å¹³å‡è¦èŠ±0.351ç§’Minimum number of seconds to run all queries: 0.351 secondsMaximum number of seconds to run all queries: 0.351 secondsNumber of clients running queries: 100 æ€»å…±100ä¸ªå®¢æˆ·ç«¯ï¼ˆå¹¶å‘ï¼‰è¿è¡Œè¿™äº›sqlæŸ¥è¯¢Average number of queries per client:50 æ¯ä¸ªå®¢æˆ·ç«¯ï¼ˆå¹¶å‘ï¼‰å¹³å‡è¿è¡Œ50æ¬¡æŸ¥è¯¢ï¼ˆå¯¹åº”â€“concurrency=100ï¼Œâ€“number-of-queries=5000ï¼›5000/100=50ï¼‰ å®žä¾‹2#mysqlslap -h127.0.0.1 -uroot -p123456789 â€“concurrency=100,500,1000 â€“iterations=1 â€“auto-generate-sql â€“auto-generate-sql-load-type=mixed â€“auto-generate-sql-add-autoincrement â€“engine=innodb â€“number-of-queries=5000 â€“debug-infoBenchmarkRunning for engine innodbAverage number of seconds to run all queries: 0.328 secondsMinimum number of seconds to run all queries: 0.328 secondsMaximum number of seconds to run all queries: 0.328 secondsNumber of clients running queries: 100Average number of queries per client: 50 BenchmarkRunning for engine innodbAverage number of seconds to run all queries: 0.358 secondsMinimum number of seconds to run all queries: 0.358 secondsMaximum number of seconds to run all queries: 0.358 secondsNumber of clients running queries: 500Average number of queries per client: 10 BenchmarkRunning for engine innodbAverage number of seconds to run all queries: 0.482 secondsMinimum number of seconds to run all queries: 0.482 secondsMaximum number of seconds to run all queries: 0.482 secondsNumber of clients running queries: 1000Average number of queries per client: 5 User time 0.21, System time 0.78Maximum resident set size 21520, Integral resident set size 0Non-physical pagefaults 12332, Physical pagefaults 0, Swaps 0Blocks in 0 out 0, Messages in 0 out 0, Signals 0Voluntary context switches 36771, Involuntary context switches 1396 å®žä¾‹3(è‡ªå®šä¹‰sqlè¯­å¥)#mysqlslap -h127.0.0.1 -uroot -p123456789 â€“concurrency=100 â€“iterations=1 â€“create-schema=rudao â€“query=â€™select * from serverlist;â€™ â€“engine=innodb â€“number-of-queries=5000 â€“debug-infoBenchmarkRunning for engine innodbAverage number of seconds to run all queries: 0.144 secondsMinimum number of seconds to run all queries: 0.144 secondsMaximum number of seconds to run all queries: 0.144 secondsNumber of clients running queries: 100Average number of queries per client: 50 User time 0.05, System time 0.09Maximum resident set size 6132, Integral resident set size 0Non-physical pagefaults 2078, Physical pagefaults 0, Swaps 0Blocks in 0 out 0, Messages in 0 out 0, Signals 0Voluntary context switches 6051, Involuntary context switches 90 å®žä¾‹4(æŒ‡å®šsqlè„šæœ¬)#mysqlslap -h127.0.0.1 -uroot -p123456789 â€“concurrency=100 â€“iterations=1 â€“create-schema=rudao â€“query=/tmp/query.sql â€“engine=innodb â€“number-of-queries=5000 â€“debug-infoWarning: Using a password on the command line interface can be insecure.BenchmarkRunning for engine innodbAverage number of seconds to run all queries: 0.157 secondsMinimum number of seconds to run all queries: 0.157 secondsMaximum number of seconds to run all queries: 0.157 secondsNumber of clients running queries: 100Average number of queries per client: 50 User time 0.07, System time 0.08Maximum resident set size 6152, Integral resident set size 0Non-physical pagefaults 2107, Physical pagefaults 0, Swaps 0Blocks in 0 out 0, Messages in 0 out 0, Signals 0Voluntary context switches 6076, Involuntary context switches 89]]></content>
  </entry>
  <entry>
    <title><![CDATA[awk sort..]]></title>
    <url>%2F2018%2F04%2F24%2Fawk-sort%2F</url>
    <content type="text"><![CDATA[sortã€uniqã€awk123456789101112131415161718192021#!/bin/bashSECURE_FILE=/var/log/secureIPS=`tail -n 1000 $SECURE_FILE| grep "Failed password "| egrep -o "([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;"| sort -nr|uniq -c| awk '$1&gt;10&#123;print $2&#125;'`IPTABLE_CONF=/etc/sysconfig/iptablescat &lt;&lt;EOFEOFfor ip in echo $IPSdo cat $IPTABLE_CONF | grep $ip&gt;/dev/nulldoneif [ $? -ne 0 ]; then sed -e "/lo/a -A INPUT -s $ip -m state --state NEW -m tcp -p tcp --dport 22 -j DROP" $IPTABLE_CONFelse echo "$ip is in iptables-------do nothing"fiservice iptables restart shellåœ¨æ‰‹åˆ†æžæœåŠ¡å™¨æ—¥å¿—ä¸æ„ðŸ˜1ã€æŸ¥çœ‹æœ‰å¤šå°‘ä¸ªIPè®¿é—®ï¼š awk â€˜{print $1}â€™ log_file|sort|uniq|wc -l 2ã€æŸ¥çœ‹æŸä¸€ä¸ªé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼š grep â€œ/index.phpâ€ log_file | wc -l 3ã€æŸ¥çœ‹æ¯ä¸€ä¸ªIPè®¿é—®äº†å¤šå°‘ä¸ªé¡µé¢ï¼š awk â€˜{++S[$1]} END {for (a in S) print a,S[a]}â€™ log_file &gt; log.txt sort -n -t â€˜ â€˜ -k 2 log.txt é…åˆsortè¿›ä¸€æ­¥æŽ’åº 4ã€å°†æ¯ä¸ªIPè®¿é—®çš„é¡µé¢æ•°è¿›è¡Œä»Žå°åˆ°å¤§æŽ’åºï¼š awk â€˜{++S[$1]} END {for (a in S) print S[a],a}â€™ log_file | sort -n 5ã€æŸ¥çœ‹æŸä¸€ä¸ªIPè®¿é—®äº†å“ªäº›é¡µé¢ï¼š grep ^111.111.111.111 log_file| awk â€˜{print $1,$7}â€™ 6ã€åŽ»æŽ‰æœç´¢å¼•æ“Žç»Ÿè®¡çš„é¡µé¢ï¼š awk â€˜{print $12,$1}â€™ log_file | grep ^\â€Mozilla | awk â€˜{print $2}â€™ |sort | uniq | wc -l 7ã€æŸ¥çœ‹2015å¹´8æœˆ16æ—¥14æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®: awk â€˜{print $4,$1}â€™ log_file | grep 16/Aug/2015:14 | awk â€˜{print $2}â€™| sort | uniq | wc -l 8ã€æŸ¥çœ‹è®¿é—®å‰åä¸ªipåœ°å€ awk â€˜{print $1}â€™ |sort|uniq -c|sort -nr |head -10 access_log uniq -c ç›¸å½“äºŽåˆ†ç»„ç»Ÿè®¡å¹¶æŠŠç»Ÿè®¡æ•°æ”¾åœ¨æœ€å‰é¢cat access.log|awk â€˜{print $1}â€™|sort|uniq -c|sort -nr|head -10 cat access.log|awk â€˜{counts[$(11)]+=1}; END {for(url in counts) print counts[url], url} 9ã€è®¿é—®æ¬¡æ•°æœ€å¤šçš„10ä¸ªæ–‡ä»¶æˆ–é¡µé¢ 12cat log_file|awk &apos;&#123;print 11&#125;&apos;|sort|uniq -c|sort -nr | head -10cat log_file|awk &apos;&#123;print 11&#125;&apos;|sort|uniq -c|sort -nr|head -20awk &apos;&#123;print $1&#125;&apos; log_file |sort -n -r |uniq -c | sort -n -r | head -20 è®¿é—®é‡æœ€å¤§çš„å‰20ä¸ªip 10ã€é€šè¿‡å­åŸŸåè®¿é—®æ¬¡æ•°ï¼Œä¾æ®refereræ¥è®¡ç®—ï¼Œç¨æœ‰ä¸å‡† cat access.log | awk â€˜{print $11}â€™ | sed -e â€˜ s/http:\/\///â€˜ -e â€˜ s/\/.*//â€˜ | sort | uniq -c | sort -rn | head -20 11ã€åˆ—å‡ºä¼ è¾“å¤§å°æœ€å¤§çš„å‡ ä¸ªæ–‡ä»¶ cat www.access.log |awk â€˜($7~/.php/){print $10 â€œ â€œ $1 â€œ â€œ $4 â€œ â€œ $7}â€™|sort -nr|head -100 12ã€åˆ—å‡ºè¾“å‡ºå¤§äºŽ200000byte(çº¦200kb)çš„é¡µé¢ä»¥åŠå¯¹åº”é¡µé¢å‘ç”Ÿæ¬¡æ•° cat www.access.log |awk â€˜($10 &gt; 200000 &amp;&amp; $7~/.php/){print $7}â€™|sort -n|uniq -c|sort -nr|head -100 13ã€å¦‚æžœæ—¥å¿—æœ€åŽä¸€åˆ—è®°å½•çš„æ˜¯é¡µé¢æ–‡ä»¶ä¼ è¾“æ—¶é—´ï¼Œåˆ™æœ‰åˆ—å‡ºåˆ°å®¢æˆ·ç«¯æœ€è€—æ—¶çš„é¡µé¢ cat www.access.log |awk â€˜($7~/.php/){print $NF â€œ â€œ $1 â€œ â€œ $4 â€œ â€œ $7}â€™|sort -nr|head -100 14ã€åˆ—å‡ºæœ€æœ€è€—æ—¶çš„é¡µé¢(è¶…è¿‡60ç§’çš„)çš„ä»¥åŠå¯¹åº”é¡µé¢å‘ç”Ÿæ¬¡æ•° cat www.access.log |awk â€˜($NF &gt; 60 &amp;&amp; $7~/.php/){print $7}â€™|sort -n|uniq -c|sort -nr|head -100 15ã€åˆ—å‡ºä¼ è¾“æ—¶é—´è¶…è¿‡ 30 ç§’çš„æ–‡ä»¶ cat www.access.log |awk â€˜($NF &gt; 30){print $7}â€™|sort -n|uniq -c|sort -nr|head -20 16ã€åˆ—å‡ºå½“å‰æœåŠ¡å™¨æ¯ä¸€è¿›ç¨‹è¿è¡Œçš„æ•°é‡ï¼Œå€’åºæŽ’åˆ— ps -ef | awk -F â€˜ â€˜ â€˜{print $8 â€œ â€œ $9}â€™ |sort | uniq -c |sort -nr |head -20 17ã€æŸ¥çœ‹apacheå½“å‰å¹¶å‘è®¿é—®æ•° å¯¹æ¯”httpd.confä¸­MaxClientsçš„æ•°å­—å·®è·å¤šå°‘netstat -an | grep ESTABLISHED | wc -l 18ã€å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‚æ•°æŸ¥çœ‹æ•°æ® ps -ef|grep httpd|wc -l 1388ç»Ÿè®¡httpdè¿›ç¨‹æ•°ï¼Œè¿žä¸ªè¯·æ±‚ä¼šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œä½¿ç”¨äºŽApacheæœåŠ¡å™¨ã€‚è¡¨ç¤ºApacheèƒ½å¤Ÿå¤„ç†1388ä¸ªå¹¶å‘è¯·æ±‚ï¼Œè¿™ä¸ªå€¼Apacheå¯æ ¹æ®è´Ÿè½½æƒ…å†µè‡ªåŠ¨è°ƒæ•´ netstat -nat|grep -i â€œ80â€|wc -l 4341netstat -anä¼šæ‰“å°ç³»ç»Ÿå½“å‰ç½‘ç»œé“¾æŽ¥çŠ¶æ€ï¼Œè€Œgrep -i â€œ80â€æ˜¯ç”¨æ¥æå–ä¸Ž80ç«¯å£æœ‰å…³çš„è¿žæŽ¥çš„ï¼Œwc -lè¿›è¡Œè¿žæŽ¥æ•°ç»Ÿè®¡ã€‚æœ€ç»ˆè¿”å›žçš„æ•°å­—å°±æ˜¯å½“å‰æ‰€æœ‰80ç«¯å£çš„è¯·æ±‚æ€»æ•° netstat -na|grep ESTABLISHED|wc -l 376netstat -anä¼šæ‰“å°ç³»ç»Ÿå½“å‰ç½‘ç»œé“¾æŽ¥çŠ¶æ€ï¼Œè€Œgrep ESTABLISHED æå–å‡ºå·²å»ºç«‹è¿žæŽ¥çš„ä¿¡æ¯ã€‚ ç„¶åŽwc -lç»Ÿè®¡æœ€ç»ˆè¿”å›žçš„æ•°å­—å°±æ˜¯å½“å‰æ‰€æœ‰80ç«¯å£çš„å·²å»ºç«‹è¿žæŽ¥çš„æ€»æ•°ã€‚ netstat -nat||grep ESTABLISHED|wc å¯æŸ¥çœ‹æ‰€æœ‰å»ºç«‹è¿žæŽ¥çš„è¯¦ç»†è®°å½• 19ã€è¾“å‡ºæ¯ä¸ªipçš„è¿žæŽ¥æ•°ï¼Œä»¥åŠæ€»çš„å„ä¸ªçŠ¶æ€çš„è¿žæŽ¥æ•°netstat -n | awk â€˜/^tcp/ {n=split($(NF-1),array,â€:â€);if(n&lt;=2)++S[array[(1)]];else++S[array[(4)]];++s[$NF];++N} END {for(a in S){printf(â€œ%-20s %s\nâ€, a, S[a]);++I}printf(â€œ%-20s %s\nâ€,â€TOTAL_IPâ€,I);for(a in s) printf(â€œ%-20s %s\nâ€,a, s[a]);printf(â€œ%-20s %s\nâ€,â€TOTAL_LINKâ€,N);}â€™ 20ã€å…¶ä»–çš„æ”¶é›† åˆ†æžæ—¥å¿—æ–‡ä»¶ä¸‹ 2012-05-04 è®¿é—®é¡µé¢æœ€é«˜ çš„å‰20ä¸ª URL å¹¶æŽ’åº cat access.log |grep â€˜04/May/2012â€™| awk â€˜{print $11}â€™|sort|uniq -c|sort -nr|head -20 æŸ¥è¯¢å—è®¿é—®é¡µé¢çš„URLåœ°å€ä¸­ å«æœ‰ www.abc.com ç½‘å€çš„ IP åœ°å€ cat access_log | awk â€˜($11~/\www.abc.com/){print $1}â€™|sort|uniq -c|sort -nr èŽ·å–è®¿é—®æœ€é«˜çš„10ä¸ªIPåœ°å€ åŒæ—¶ä¹Ÿå¯ä»¥æŒ‰æ—¶é—´æ¥æŸ¥è¯¢ cat linewow-access.log|awk â€˜{print $1}â€™|sort|uniq -c|sort -nr|head -10 æ—¶é—´æ®µæŸ¥è¯¢æ—¥å¿—æ—¶é—´æ®µçš„æƒ…å†µ cat log_file | egrep â€˜15/Aug/2015|16/Aug/2015â€™ |awk â€˜{print $1}â€™|sort|uniq -c|sort -nr|head -10 åˆ†æž2015/8/15 åˆ° 2015/8/16 è®¿é—®â€/index.php?g=Member&amp;m=Public&amp;a=sendValidCodeâ€çš„IPå€’åºæŽ’åˆ— cat log_file | egrep â€˜15/Aug/2015|16/Aug/2015â€™ | awk â€˜{if($7 == â€œ/index.php?g=Member&amp;m=Public&amp;a=sendValidCodeâ€) print $1,$7}â€™|sort|uniq -c|sort -nr ($7~/.php/) $7é‡Œé¢åŒ…å«.phpçš„å°±è¾“å‡º,æœ¬å¥çš„æ„æ€æ˜¯æœ€è€—æ—¶çš„ä¸€ç™¾ä¸ªPHPé¡µé¢ cat log_file |awk â€˜($7~/.php/){print $NF â€œ â€œ $1 â€œ â€œ $4 â€œ â€œ $7}â€™|sort -nr|head -100 åˆ—å‡ºæœ€æœ€è€—æ—¶çš„é¡µé¢(è¶…è¿‡60ç§’çš„)çš„ä»¥åŠå¯¹åº”é¡µé¢å‘ç”Ÿæ¬¡æ•° cat access.log |awk â€˜($NF &gt; 60 &amp;&amp; $7~/.php/){print $7}â€™|sort -n|uniq -c|sort -nr|head -100 ç»Ÿè®¡ç½‘ç«™æµé‡ï¼ˆG) cat access.log |awk â€˜{sum+=$10} END {print sum/1024/1024/1024}â€™ ç»Ÿè®¡404çš„è¿žæŽ¥ awk â€˜($9 ~/404/)â€™ access.log | awk â€˜{print $9,$7}â€™ | sort ç»Ÿè®¡http status cat access.log |awk â€˜{counts[$(9)]+=1}; END {for(code in counts) print code, counts[code]}â€™cat access.log |awk â€˜{print $9}â€™|sort|uniq -c|sort -rn æ¯ç§’å¹¶å‘ watch â€œawk â€˜{if($9~/200|30|404/)COUNT[$4]++}END{for( a in COUNT) print a,COUNT[a]}â€™ log_file|sort -k 2 -nr|head -n10â€ å¸¦å®½ç»Ÿè®¡ cat apache.log |awk â€˜{if($7~/GET/) count++}END{print â€œclient_request=â€count}â€™cat apache.log |awk â€˜{BYTE+=$11}END{print â€œclient_kbyte_out=â€BYTE/1024â€KBâ€}â€™ æ‰¾å‡ºæŸå¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„10ä¸ªIP cat /tmp/access.log | grep â€œ20/Mar/2011â€ |awk â€˜{print $3}â€™|sort |uniq -c|sort -nr|head å½“å¤©ipè¿žæŽ¥æ•°æœ€é«˜çš„ipéƒ½åœ¨å¹²äº›ä»€ä¹ˆ cat access.log | grep â€œ10.0.21.17â€ | awk â€˜{print $8}â€™ | sort | uniq -c | sort -nr | head -n 10 å°æ—¶å•ä½é‡Œipè¿žæŽ¥æ•°æœ€å¤šçš„10ä¸ªæ—¶æ®µ awk -vFS=â€[:]â€ â€˜{gsub(â€œ-.*â€,â€â€,$1);num[$2â€ â€œ$1]++}END{for(i in num)print i,num[i]}â€™ log_file | sort -n -k 3 -r | head -10 æ‰¾å‡ºè®¿é—®æ¬¡æ•°æœ€å¤šçš„å‡ ä¸ªåˆ†é’Ÿ awk â€˜{print $1}â€™ access.log | grep â€œ20/Mar/2011â€ |cut -c 14-18|sort|uniq -c|sort -nr|headå–5åˆ†é’Ÿæ—¥å¿—if [ $DATE_MINUTE != $DATE_END_MINUTE ] ;then #åˆ™åˆ¤æ–­å¼€å§‹æ—¶é—´æˆ³ä¸Žç»“æŸæ—¶é—´æˆ³æ˜¯å¦ç›¸ç­‰START_LINE=sed -n â€œ/$DATE_MINUTE/=â€ $APACHE_LOG|head -n1 #å¦‚æžœä¸ç›¸ç­‰ï¼Œåˆ™å–å‡ºå¼€å§‹æ—¶é—´æˆ³çš„è¡Œå·ï¼Œä¸Žç»“æŸæ—¶é—´æˆ³çš„è¡Œå· æŸ¥çœ‹tcpçš„é“¾æŽ¥çŠ¶æ€ netstat -nat |awk â€˜{print $6}â€™|sort|uniq -c|sort -rn netstat -n | awk â€˜/^tcp/ {++S[$NF]};END {for(a in S) print a, S[a]}â€™ netstat -n | awk â€˜/^tcp/ {++state[$NF]}; END {for(key in state) print key,â€\tâ€,state[key]}â€™ netstat -n | awk â€˜/^tcp/ {++arr[$NF]};END {for(k in arr) print k,â€\tâ€,arr[k]}â€™ netstat -n |awk â€˜/^tcp/ {print $NF}â€™|sort|uniq -c|sort -rn netstat -ant | awk â€˜{print $NF}â€™ | grep -v â€˜[a-z]â€™ | sort | uniq -cnetstat -ant|awk â€˜/ip:80/{split($5,ip,â€:â€);++S[ip[1]]}END{for (a in S) print S[a],a}â€™ |sort -n netstat -ant|awk â€˜/:80/{split($5,ip,â€:â€);++S[ip[1]]}END{for (a in S) print S[a],a}â€™ |sort -rn|head -n 10 awk â€˜BEGIN{printf (â€œhttp_code\tcount_num\nâ€)}{COUNT[$10]++}END{for (a in COUNT) printf aâ€\t\tâ€COUNT[a]â€\nâ€}â€™æŸ¥æ‰¾è¯·æ±‚æ•°å‰20ä¸ªIPï¼ˆå¸¸ç”¨äºŽæŸ¥æ‰¾æ”»æ¥æºï¼‰ï¼šnetstat -anlp|grep 80|grep tcp|awk â€˜{print $5}â€™|awk -F: â€˜{print $1}â€™|sort|uniq -c|sort -nr|head -n20netstat -ant |awk â€˜/:80/{split($5,ip,â€:â€);++A[ip[1]]}END{for(i in A) print A[i],i}â€™ |sort -rn|head -n20 ç”¨tcpdumpå—…æŽ¢80ç«¯å£çš„è®¿é—®çœ‹çœ‹è°æœ€é«˜ tcpdump -i eth0 -tnn dst port 80 -c 1000 | awk -Fâ€.â€ â€˜{print $1â€.â€$2â€.â€$3â€.â€$4}â€™ | sort | uniq -c | sort -nr |head -20 æŸ¥æ‰¾è¾ƒå¤štime_waitè¿žæŽ¥ netstat -n|grep TIME_WAIT|awk â€˜{print $5}â€™|sort|uniq -c|sort -rn|head -n20 æ‰¾æŸ¥è¾ƒå¤šçš„SYNè¿žæŽ¥ netstat -an | grep SYN | awk â€˜{print $5}â€™ | awk -F: â€˜{print $1}â€™ | sort | uniq -c | sort -nr | more æ ¹æ®ç«¯å£åˆ—è¿›ç¨‹netstat -ntlp | grep 80 | awk â€˜{print $7}â€™ | cut -d/ -f1 æŸ¥çœ‹äº†è¿žæŽ¥æ•°å’Œå½“å‰çš„è¿žæŽ¥æ•° netstat -ant | grep $ip:80 | wc -lnetstat -ant | grep $ip:80 | grep EST | wc -l æŸ¥çœ‹IPè®¿é—®æ¬¡æ•°netstat -nat|grep â€œ:80â€|awk â€˜{print $5}â€™ |awk -F: â€˜{print $1}â€™ | sort| uniq -c|sort -n Linuxå‘½ä»¤åˆ†æžå½“å‰çš„é“¾æŽ¥çŠ¶å†µnetstat -n | awk â€˜/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}â€™ watch â€œnetstat -n | awk â€˜/^tcp/ {++S[\$NF]} END {for(a in S) print a, S[a]}â€™â€ # é€šè¿‡watchå¯ä»¥ä¸€ç›´ç›‘æŽ§ LAST_ACK 5 #å…³é—­ä¸€ä¸ªTCPè¿žæŽ¥éœ€è¦ä»Žä¸¤ä¸ªæ–¹å‘ä¸Šåˆ†åˆ«è¿›è¡Œå…³é—­ï¼ŒåŒæ–¹éƒ½æ˜¯é€šè¿‡å‘é€FINæ¥è¡¨ç¤ºå•æ–¹å‘æ•°æ®çš„å…³é—­ï¼Œå½“é€šä¿¡åŒæ–¹å‘é€äº†æœ€åŽä¸€ä¸ªFINçš„æ—¶å€™ï¼Œå‘é€æ–¹æ­¤æ—¶å¤„äºŽLAST_ACKçŠ¶æ€ï¼Œå½“å‘é€æ–¹æ”¶åˆ°å¯¹æ–¹çš„ç¡®è®¤ï¼ˆFinçš„Ackç¡®è®¤ï¼‰åŽæ‰çœŸæ­£å…³é—­æ•´ä¸ªTCPè¿žæŽ¥ï¼› SYN_RECV 30 # è¡¨ç¤ºæ­£åœ¨ç­‰å¾…å¤„ç†çš„è¯·æ±‚æ•°ï¼› ESTABLISHED 1597 # è¡¨ç¤ºæ­£å¸¸æ•°æ®ä¼ è¾“çŠ¶æ€ï¼› FIN_WAIT1 51 # è¡¨ç¤ºserverç«¯ä¸»åŠ¨è¦æ±‚å…³é—­tcpè¿žæŽ¥ï¼› FIN_WAIT2 504 # è¡¨ç¤ºå®¢æˆ·ç«¯ä¸­æ–­è¿žæŽ¥ï¼› TIME_WAIT 1057 # è¡¨ç¤ºå¤„ç†å®Œæ¯•ï¼Œç­‰å¾…è¶…æ—¶ç»“æŸçš„è¯·æ±‚æ•°ï¼›]]></content>
  </entry>
  <entry>
    <title><![CDATA[ORACLEé“¾æŽ¥é—®é¢˜]]></title>
    <url>%2F2018%2F04%2F17%2FORACLE%E9%93%BE%E6%8E%A5%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[ORACLEé“¾æŽ¥é—®é¢˜æ‰¾ä¸åˆ°åŠ¨æ€åº“ldd sqlplusecho $LD_LIBRARY_PATHexport $LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib ORA-21561: OID generation failedä¿®æ”¹/etc/hostsæ–‡ä»¶ï¼Œè¿½åŠ æœ¬æœºmapï¼Œå¦åˆ™ä¼šæŠ¥â€â€é”™è¯¯ #vi /etc/hosts è¿½åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š 192.168.1.171 centos62 å…¶ä¸­centos62ä¸ºæœ¬æœºä¸»æœºåï¼Œå¯ä»¥é€šè¿‡hostnameå‘½ä»¤æŸ¥çœ‹]]></content>
  </entry>
  <entry>
    <title><![CDATA[Ansible]]></title>
    <url>%2F2018%2F04%2F17%2FAnsible%2F</url>
    <content type="text"><![CDATA[ansibleä½¿ç”¨è®°å½•Ansible å®‰è£…æ•™ç¨‹ansible çš„å®‰è£…è½»è€Œæ˜“ä¸¾ï¼Œè®¸å¤šå‘è¡Œç‰ˆçš„ç¬¬ä¸‰æ–¹è½¯ä»¶ä»“åº“ä¸­éƒ½æœ‰çŽ°æˆçš„è½¯ä»¶åŒ…ï¼Œå¯ä»¥ç›´æŽ¥å®‰è£…ã€‚å…¶ä»–ç®€å•çš„å®‰è£…æ–¹æ³•åŒ…æ‹¬ä½¿ç”¨ pip å®‰è£…å®ƒï¼Œæˆ–è€…ä»Ž github é‡ŒèŽ·å–æœ€æ–°çš„ç‰ˆæœ¬ã€‚è‹¥æƒ³ä½¿ç”¨ä½ çš„è½¯ä»¶åŒ…ç®¡ç†å™¨å®‰è£…ï¼Œåœ¨åŸºäºŽ RHEL/CentOS Linux çš„ç³»ç»Ÿé‡Œä½ å¾ˆå¯èƒ½éœ€è¦ EPEL ä»“åº“ã€‚ åœ¨åŸºäºŽ RHEL/CentOS Linux çš„ç³»ç»Ÿä¸­å®‰è£… ansibleè¾“å…¥å¦‚ä¸‹ yum å‘½ä»¤: 1$ sudo yum install ansible åœ¨åŸºäºŽ Debian/Ubuntu Linux çš„ç³»ç»Ÿä¸­å®‰è£… ansibleè¾“å…¥å¦‚ä¸‹ apt-get å‘½ä»¤: 1$ sudo apt-get install software-properties-common$ sudo apt-add-repository ppa:ansible/ansible$ sudo apt-get update$ sudo apt-get install ansible ä½¿ç”¨ pip å®‰è£… ansiblepip å‘½ä»¤æ˜¯ä¸€ä¸ªå®‰è£…å’Œç®¡ç† Python è½¯ä»¶åŒ…çš„å·¥å…·ï¼Œæ¯”å¦‚å®ƒèƒ½ç®¡ç† Python Package Index ä¸­çš„é‚£äº›è½¯ä»¶åŒ…ã€‚å¦‚ä¸‹æ–¹å¼åœ¨ Linux å’Œç±» Unix ç³»ç»Ÿä¸­é€šç”¨ï¼š 1$ sudo pip install ansible ä»Žæºä»£ç å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ ansibleä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤ä»Ž github ä¸­å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼š 1$ cd ~$ git clone git://github.com/ansible/ansible.git$ cd ./ansible$ source ./hacking/env-setup å½“ä½ ä»Žä¸€ä¸ª git checkout ä¸­è¿è¡Œ ansible çš„æ—¶å€™ï¼Œè¯·è®°ä½ä½ æ¯æ¬¡ç”¨å®ƒä¹‹å‰éƒ½éœ€è¦è®¾ç½®ä½ çš„çŽ¯å¢ƒï¼Œæˆ–è€…ä½ å¯ä»¥æŠŠè¿™ä¸ªè®¾ç½®è¿‡ç¨‹åŠ å…¥ä½ çš„ bash rc æ–‡ä»¶ä¸­ï¼š 1# åŠ å…¥ BASH RC$ echo &quot;export ANSIBLE_HOSTS=~/ansible_hosts&quot; &gt;&gt; ~/.bashrc$ echo &quot;source ~/ansible/hacking/env-setup&quot; &gt;&gt; ~/.bashrc ansible çš„ hosts æ–‡ä»¶åŒ…æ‹¬äº†ä¸€ç³»åˆ—å®ƒèƒ½æ“ä½œçš„ä¸»æœºã€‚é»˜è®¤æƒ…å†µä¸‹ ansible é€šè¿‡è·¯å¾„ /etc/ansible/hosts æŸ¥æ‰¾ hosts æ–‡ä»¶ï¼Œä¸è¿‡è¿™ä¸ªè¡Œä¸ºä¹Ÿæ˜¯å¯ä»¥æ›´æ”¹çš„ï¼Œè¿™æ ·å½“ä½ æƒ³æ“ä½œä¸æ­¢ä¸€ä¸ª ansible æˆ–è€…é’ˆå¯¹ä¸åŒçš„æ•°æ®ä¸­å¿ƒçš„ä¸åŒå®¢æˆ·æ“ä½œçš„æ—¶å€™ä¹Ÿæ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚ä½ å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•° -i æŒ‡å®š hosts æ–‡ä»¶ï¼š 1$ ansible all -m shell -a &quot;hostname&quot; --ask-pass -i /etc/some/other/dir/ansible_hosts ä¸è¿‡æˆ‘æ›´å€¾å‘äºŽä½¿ç”¨ä¸€ä¸ªçŽ¯å¢ƒå˜é‡ï¼Œè¿™å¯ä»¥åœ¨ä½ æƒ³è¦é€šè¿‡ source ä¸€ä¸ªä¸åŒçš„æ–‡ä»¶æ¥åˆ‡æ¢å·¥ä½œç›®æ ‡çš„æ—¶å€™èµ·åˆ°ä½œç”¨ã€‚è¿™é‡Œçš„çŽ¯å¢ƒå˜é‡æ˜¯ $ANSIBLE_HOSTSï¼Œå¯ä»¥è¿™æ ·è®¾ç½®ï¼š 1$ export ANSIBLE_HOSTS=~/ansible_hosts ä¸€æ—¦æ‰€æœ‰éœ€è¦çš„ç»„ä»¶éƒ½å·²ç»å®‰è£…å®Œæ¯•ï¼Œè€Œä¸”ä½ ä¹Ÿå‡†å¤‡å¥½äº†ä½ çš„ hosts æ–‡ä»¶ï¼Œä½ å°±å¯ä»¥æ¥è¯•ä¸€è¯•å®ƒäº†ã€‚ä¸ºäº†å¿«é€Ÿæµ‹è¯•ï¼Œè¿™é‡Œæˆ‘æŠŠ 127.0.0.1 å†™åˆ°äº† ansible çš„ hosts æ–‡ä»¶é‡Œï¼š 1$ echo &quot;127.0.0.1&quot; &gt; ~/ansible_hosts çŽ°åœ¨æ¥æµ‹è¯•ä¸€ä¸ªç®€å•çš„ pingï¼š 1$ ansible all -m ping æˆ–è€…æç¤º ssh å¯†ç ï¼š 1$ ansible all -m ping --ask-pass æˆ‘åœ¨åˆšå¼€å§‹çš„è®¾ç½®ä¸­é‡åˆ°è¿‡å‡ æ¬¡é—®é¢˜ï¼Œå› æ­¤è¿™é‡Œå¼ºçƒˆæŽ¨èä¸º ansible è®¾ç½® SSH å…¬é’¥è®¤è¯ã€‚ä¸è¿‡åœ¨åˆšåˆšçš„æµ‹è¯•ä¸­æˆ‘ä»¬ä½¿ç”¨äº† â€“ask-passï¼Œåœ¨ä¸€äº›æœºå™¨ä¸Šä½ ä¼šéœ€è¦å®‰è£… sshpass æˆ–è€…åƒè¿™æ ·æŒ‡å®š -c paramikoï¼š 1$ ansible all -m ping --ask-pass -c paramiko å½“ç„¶ä½ ä¹Ÿå¯ä»¥å®‰è£… sshpassï¼Œç„¶è€Œ sshpass å¹¶ä¸æ€»æ˜¯åœ¨æ ‡å‡†çš„ä»“åº“ä¸­æä¾›ï¼Œå› æ­¤ paramiko å¯èƒ½æ›´ä¸ºç®€å•ã€‚ è®¾ç½® SSH å…¬é’¥è®¤è¯äºŽæ˜¯æˆ‘ä»¬æœ‰äº†ä¸€ä»½é…ç½®ï¼Œä»¥åŠä¸€äº›åŸºç¡€çš„å…¶ä»–ä¸œè¥¿ã€‚çŽ°åœ¨è®©æˆ‘ä»¬æ¥åšä¸€äº›å®žç”¨çš„äº‹æƒ…ã€‚ansible çš„å¼ºå¤§å¾ˆå¤§ç¨‹åº¦ä¸Šä½“çŽ°åœ¨ playbooks ä¸Šï¼ŒåŽè€…åŸºæœ¬ä¸Šå°±æ˜¯ä¸€äº›å†™å¥½çš„ ansible è„šæœ¬ï¼ˆå¤§éƒ¨åˆ†æ¥è¯´ï¼‰ï¼Œä¸è¿‡åœ¨åˆ¶ä½œä¸€ä¸ª playbook ä¹‹å‰ï¼Œæˆ‘ä»¬å°†å…ˆä»Žä¸€äº›ä¸€å¥è¯è„šæœ¬å¼€å§‹ã€‚çŽ°åœ¨è®©æˆ‘ä»¬åˆ›å»ºå’Œé…ç½® SSH å…¬é’¥è®¤è¯ï¼Œä»¥ä¾¿çœåŽ» -c å’Œ â€“ask-pass é€‰é¡¹ï¼š 1$ ssh-keygen -t rsa çŽ°åœ¨æ˜¾ç„¶æœ‰å¾ˆå¤šç§æ–¹å¼æ¥æŠŠå®ƒæ”¾åˆ°è¿œç¨‹ä¸»æœºä¸Šåº”è¯¥çš„ä½ç½®ã€‚ä¸è¿‡æ—¢ç„¶æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ ansibleï¼Œå°±ç”¨å®ƒæ¥å®Œæˆè¿™ä¸ªæ“ä½œå§ï¼š 1$ ansible all -m copy -a &quot;src=/home/xxx/.ssh/id_rsa.pub dest=/tmp/id_rsa.pub&quot; --ask-pass -c paramiko ä¸‹ä¸€æ­¥ï¼ŒæŠŠå…¬é’¥æ–‡ä»¶æ·»åŠ åˆ°è¿œç¨‹æœåŠ¡å™¨é‡Œã€‚è¾“å…¥ï¼š 1$ ansible all -m shell -a &quot;cat /tmp/id_rsa.pub &gt;&gt; /root/.ssh/authorized_keys&quot; --ask-pass -c paramiko æ ·ä¾‹è¾“å‡ºï¼š 1SSH password:127.0.0.1 | FAILED | rc=1 &gt;&gt;/bin/sh: /root/.ssh/authorized_keys: Permission denied çŸ®æ²¹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ root æ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œæ‰€ä»¥è¿˜æ˜¯åŠ ä¸Šä¸€ä¸ª -u å‚æ•°å§ï¼š 1$ ansible all -m shell -a &quot;cat /tmp/id_rsa.pub &gt;&gt; /root/.ssh/authorized_keys&quot; --ask-pass -c paramiko -u root æ ·ä¾‹è¾“å‡ºï¼š 1SSH password:127.0.0.1 | success | rc=0 &gt;&gt; è¯·æ³¨æ„ï¼Œæˆ‘åˆšæ‰è¿™æ˜¯æƒ³è¦æ¼”ç¤ºé€šè¿‡ ansible æ¥ä¼ è¾“æ–‡ä»¶çš„æ“ä½œã€‚äº‹å®žä¸Š ansible æœ‰ä¸€ä¸ªæ›´åŠ æ–¹ä¾¿çš„å†…ç½® SSH å¯†é’¥ç®¡ç†æ”¯æŒï¼š 1$ ansible all -m authorized_key -a &quot;user=xxx key=&apos;&#123;&#123; lookup(&apos;file&apos;, &apos;/home/xxx/.ssh/id_rsa.pub&apos;) &#125;&#125;&apos; path=/home/xxx/.ssh/authorized_keys manage_dir=no&quot; --ask-pass -c paramiko çŽ°åœ¨è¿™äº›å¯†é’¥å·²ç»è®¾ç½®å¥½äº†ã€‚æˆ‘ä»¬æ¥è¯•ç€éšä¾¿è·‘ä¸€ä¸ªå‘½ä»¤ï¼Œæ¯”å¦‚ hostnameï¼Œå¸Œæœ›æˆ‘ä»¬ä¸ä¼šè¢«æç¤ºè¦è¾“å…¥å¯†ç  1$ ansible all -m shell -a &quot;hostname&quot; -u root æ ·ä¾‹è¾“å‡ºï¼š 1127.0.0.1 | success | rc=0 &gt;&gt; æˆåŠŸï¼ï¼ï¼çŽ°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨ root æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”ä¸ä¼šè¢«è¾“å…¥å¯†ç çš„æç¤ºå¹²æ‰°äº†ã€‚æˆ‘ä»¬çŽ°åœ¨å¯ä»¥è½»æ˜“åœ°é…ç½®ä»»ä½•åœ¨ ansible hosts æ–‡ä»¶ä¸­çš„ä¸»æœºäº†ã€‚è®©æˆ‘ä»¬æŠŠ /tmp ä¸­çš„å…¬é’¥æ–‡ä»¶åˆ é™¤ï¼š 1$ ansible all -m file -a &quot;dest=/tmp/id_rsa.pub state=absent&quot; -u root æ ·ä¾‹è¾“å‡ºï¼š 1127.0.0.1 | success &gt;&gt; &#123; &quot;changed&quot;: true, &quot;path&quot;: &quot;/tmp/id_rsa.pub&quot;, &quot;state&quot;: &quot;absent&quot;&#125; ä¸‹é¢æˆ‘ä»¬æ¥åšä¸€äº›æ›´å¤æ‚çš„äº‹æƒ…ï¼Œæˆ‘è¦ç¡®å®šä¸€äº›è½¯ä»¶åŒ…å·²ç»å®‰è£…äº†ï¼Œå¹¶ä¸”å·²ç»æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼š 1$ ansible all -m zypper -a &quot;name=apache2 state=latest&quot; -u root æ ·ä¾‹è¾“å‡ºï¼š 1127.0.0.1 | success &gt;&gt; &#123; &quot;changed&quot;: false, &quot;name&quot;: &quot;apache2&quot;, &quot;state&quot;: &quot;latest&quot;&#125; å¾ˆå¥½ï¼Œæˆ‘ä»¬åˆšæ‰æ”¾åœ¨ /tmp ä¸­çš„å…¬é’¥æ–‡ä»¶å·²ç»æ¶ˆå¤±äº†ï¼Œè€Œä¸”æˆ‘ä»¬å·²ç»å®‰è£…å¥½äº†æœ€æ–°ç‰ˆçš„ apacheã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å‰é¢å‘½ä»¤ä¸­çš„ -m zypperï¼Œä¸€ä¸ªè®© ansible éžå¸¸çµæ´»ï¼Œå¹¶ä¸”ç»™äº† playbooks æ›´å¤šèƒ½åŠ›çš„åŠŸèƒ½ã€‚å¦‚æžœä½ ä¸ä½¿ç”¨ openSuse æˆ–è€… Suse enterprise ä½ å¯èƒ½è¿˜ä¸ç†Ÿæ‚‰ zypper, å®ƒåŸºæœ¬ä¸Šå°±æ˜¯ suse ä¸–ç•Œä¸­ç›¸å½“äºŽ yum çš„å­˜åœ¨ã€‚åœ¨ä¸Šé¢æ‰€æœ‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘çš„ hosts æ–‡ä»¶ä¸­éƒ½åªæœ‰ä¸€å°æœºå™¨ã€‚é™¤äº†æœ€åŽä¸€ä¸ªå‘½ä»¤å¤–ï¼Œå…¶ä»–æ‰€æœ‰å‘½ä»¤éƒ½åº”è¯¥åœ¨ä»»ä½•æ ‡å‡†çš„ *nix ç³»ç»Ÿå’Œæ ‡å‡†çš„ ssh é…ç½®ä¸­ä½¿ç”¨ï¼Œè¿™é€ æˆäº†ä¸€ä¸ªé—®é¢˜ã€‚å¦‚æžœæˆ‘ä»¬æƒ³è¦åŒæ—¶ç®¡ç†å¤šç§ä¸åŒçš„æœºå™¨å‘¢ï¼Ÿè¿™ä¾¿æ˜¯ playbooks å’Œ ansible çš„å¯é…ç½®æ€§é—ªé—ªå‘å…‰çš„åœ°æ–¹äº†ã€‚é¦–å…ˆæˆ‘ä»¬æ¥å°‘è®¸ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„ hosts æ–‡ä»¶ï¼š 1$ cat ~/ansible_hosts æ ·ä¾‹è¾“å‡ºï¼š 12[RHELBased]121.12.12.12[SUSEBased]127.0.0.1 é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€äº›åˆ†ç»„çš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”ç»™äº†ä»–ä»¬ä¸€äº›æœ‰æ„ä¹‰çš„æ ‡ç­¾ã€‚ç„¶åŽæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªä¸ºä¸åŒç±»åž‹çš„æœåŠ¡å™¨æ‰§è¡Œä¸åŒæ“ä½œçš„ playbookã€‚ä½ å¯èƒ½å·²ç»å‘çŽ°è¿™ä¸ª yaml çš„æ•°æ®ç»“æž„å’Œæˆ‘ä»¬ä¹‹å‰è¿è¡Œçš„å‘½ä»¤è¡Œè¯­å¥ä¸­çš„ç›¸ä¼¼æ€§äº†ã€‚ç®€å•æ¥è¯´ï¼Œ-m æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œè€Œ -a ç”¨æ¥æä¾›æ¨¡å—å‚æ•°ã€‚åœ¨ YAML è¡¨ç¤ºä¸­ä½ å¯ä»¥å…ˆæŒ‡å®šæ¨¡å—ï¼Œç„¶åŽæ’å…¥ä¸€ä¸ªå†’å· :ï¼Œæœ€åŽæŒ‡å®šå‚æ•°ã€‚ 12345678910111213---- hosts: SUSEBased remote_user: root tasks: - zypper: name=apache2 state=latest- hosts: RHELBased remote_user: root tasks: - yum: name=httpd state=latest çŽ°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ playbook äº†ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è¿è¡Œå®ƒï¼š 1$ ansible-playbook testPlaybook.yaml -f 10 æ³¨æ„ï¼Œä½ ä¼šçœ‹åˆ° ansible è”ç³»åˆ°çš„æ¯ä¸€å°æœºå™¨çš„è¾“å‡ºã€‚-f å‚æ•°è®© ansible åœ¨å¤šå°ä¸»æœºä¸ŠåŒæ—¶è¿è¡ŒæŒ‡ä»¤ã€‚é™¤äº†æŒ‡å®šå…¨éƒ¨ä¸»æœºï¼Œæˆ–è€…ä¸€ä¸ªä¸»æœºåˆ†ç»„çš„åå­—ä»¥å¤–ï¼Œä½ è¿˜å¯ä»¥æŠŠå¯¼å…¥ ssh å…¬é’¥çš„æ“ä½œä»Žå‘½ä»¤è¡Œé‡Œè½¬ç§»åˆ° playbook ä¸­ï¼Œè¿™å°†åœ¨è®¾ç½®æ–°ä¸»æœºçš„æ—¶å€™æä¾›å¾ˆå¤§çš„æ–¹ä¾¿ï¼Œç”šè‡³è®©æ–°ä¸»æœºç›´æŽ¥å¯ä»¥è¿è¡Œä¸€ä¸ª playbookã€‚ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬æŠŠæˆ‘ä»¬ä¹‹å‰çš„å…¬é’¥ä¾‹å­æ”¾è¿›ä¸€ä¸ª playbook é‡Œï¼š 1234567891011121314151617---- hosts: SUSEBased remote_user: xxx sudo: yes tasks: - authorized_key: user=root key=&quot;&#123;&#123; lookup(&apos;file&apos;, &apos;/home/xxx/.ssh/id_rsa.pub&apos;) &#125;&#125;&quot; path=/root/.ssh/authorized_keys manage_dir=no- hosts: RHELBasedremote_user: aaa sudo: yes tasks: - authorized_key: user=root key=&quot;&#123;&#123; lookup(&apos;file&apos;, &apos;/home/xxx/.ssh/id_rsa.pub&apos;) &#125;&#125;&quot; path=/root/.ssh/authorized_keys manage_dir=no é™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šå¯ä»¥åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚åœ¨å¯åŠ¨çš„æ—¶å€™æŠŠå…¬é’¥é…ç½®å¥½ï¼Œæˆ–è€…å¼•å…¥å…¶ä»–çš„æµç¨‹æ¥è®©ä½ æŒ‰éœ€é…ç½®ä¸€äº›æœºå™¨ã€‚ä¸è¿‡åªè¦ SSH è¢«é…ç½®æˆæŽ¥å—å¯†ç ç™»é™†ï¼Œè¿™äº›å‡ ä¹Žå¯ä»¥ç”¨åœ¨æ‰€æœ‰çš„æµç¨‹ä¸­ã€‚åœ¨ä½ å‡†å¤‡å¼€å§‹å†™å¤ªå¤š playbook ä¹‹å‰ï¼Œå¦ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„äº‹æƒ…æ˜¯ï¼Œä»£ç ç®¡ç†å¯ä»¥æœ‰æ•ˆèŠ‚çœä½ çš„æ—¶é—´ã€‚æœºå™¨éœ€è¦ä¸æ–­å˜åŒ–ï¼Œç„¶è€Œä½ å¹¶ä¸éœ€è¦åœ¨æ¯æ¬¡æœºå™¨å‘ç”Ÿå˜åŒ–æ—¶éƒ½é‡æ–°å†™ä¸€ä¸ª playbookï¼Œåªéœ€è¦æ›´æ–°ç›¸å…³çš„éƒ¨åˆ†å¹¶æäº¤è¿™äº›ä¿®æ”¹ã€‚ä¸Žæ­¤ç›¸å…³çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå¦‚åŒæˆ‘ä¹‹å‰æ‰€è¿°ï¼Œä½ å¯ä»¥ä»Žä¸åŒçš„åœ°æ–¹ç®¡ç†ä½ çš„æ•´ä¸ªåŸºç¡€ç»“æž„ã€‚ä½ åªéœ€è¦å°†ä½ çš„ playbook ä»“åº“ git clone åˆ°æ–°çš„æœºå™¨ä¸Šï¼Œå°±å®Œæˆäº†ç®¡ç†æ‰€æœ‰ä¸œè¥¿çš„å…¨éƒ¨è®¾ç½®æµç¨‹ã€‚ çŽ°å®žä¸­çš„ ansible ä¾‹å­æˆ‘çŸ¥é“å¾ˆå¤šç”¨æˆ·ç»å¸¸ä½¿ç”¨ pastebin è¿™æ ·çš„æœåŠ¡ï¼Œä»¥åŠå¾ˆå¤šå…¬å¸åŸºäºŽæ˜¾è€Œæ˜“è§çš„ç†ç”±é…ç½®äº†ä»–ä»¬å†…éƒ¨ä½¿ç”¨çš„ç±»ä¼¼ä¸œè¥¿ã€‚æœ€è¿‘ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªå«åš showterm çš„ç¨‹åºï¼Œå·§åˆä¹‹ä¸‹æˆ‘è¢«ä¸€ä¸ªå®¢æˆ·è¦æ±‚é…ç½®å®ƒç”¨äºŽå†…éƒ¨ä½¿ç”¨ã€‚è¿™é‡Œæˆ‘ä¸æ‰“ç®—èµ˜è¿°è¿™ä¸ªåº”ç”¨ç¨‹åºçš„ç»†èŠ‚ï¼Œä¸è¿‡å¦‚æžœä½ æ„Ÿå…´è¶£çš„è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ Google æœç´¢ showtermã€‚ä½œä¸ºä¸€ä¸ªåˆç†çš„çŽ°å®žä¸­çš„ä¾‹å­ï¼Œæˆ‘å°†ä¼šè¯•å›¾é…ç½®ä¸€ä¸ª showterm æœåŠ¡å™¨ï¼Œå¹¶ä¸”é…ç½®ä½¿ç”¨å®ƒæ‰€éœ€è¦çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªæ•°æ®åº“æœåŠ¡å™¨ã€‚çŽ°åœ¨æˆ‘ä»¬ä»Žé…ç½®å®¢æˆ·ç«¯å¼€å§‹ï¼š 1234567891011121314151617---- hosts: showtermClients remote_user: root tasks: - yum: name=rubygems state=latest - yum: name=ruby-devel state=latest - yum: name=gcc state=latest - gem: name=showterm state=latest user_install=no è¿™éƒ¨åˆ†å¾ˆç®€å•ã€‚ä¸‹é¢æ˜¯ä¸»æœåŠ¡å™¨ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485---- hosts: showtermServers remote_user: root tasks: - name: ensure packages are installed yum: name=&#123;&#123;item&#125;&#125; state=latest with_items: - postgresql - postgresql-server - postgresql-devel - python-psycopg2 - git - ruby21 - ruby21-passenger - name: showterm server from github git: repo=https://github.com/ConradIrwin/showterm.io dest=/root/showterm- name: Initdb command: service postgresql initdb creates=/var/lib/pgsql/data/postgresql.conf - name: Start PostgreSQL and enable at boot service: name=postgresql enabled=yes state=started - gem: name=pg state=latest user_install=no handlers: - name: restart postgresql service: name=postgresql state=restarted - hosts: showtermServers remote_user: root sudo: yes sudo_user: postgres vars: dbname: showterm dbuser: showterm dbpassword: showtermpassword tasks: - name: create db postgresql_db: name=&#123;&#123;dbname&#125;&#125; - name: create user with ALL priv postgresql_user: db=&#123;&#123;dbname&#125;&#125; name=&#123;&#123;dbuser&#125;&#125; password=&#123;&#123;dbpassword&#125;&#125; priv=ALL- hosts: showtermServers remote_user: root tasks: - name: database.yml template: src=database.yml dest=/root/showterm/config/database.yml- hosts: showtermServers remote_user: root tasks: - name: run bundle install shell: bundle install args: chdir: /root/showterm- hosts: showtermServers remote_user: root tasks: - name: run rake db tasks shell: &apos;bundle exec rake db:create db:migrate db:seed&apos; args:chdir: /root/showterm- hosts: showtermServers remote_user: root tasks: - name: apache config template: src=showterm.conf dest=/etc/httpd/conf.d/showterm.conf è¿˜å‡‘åˆã€‚è¯·æ³¨æ„ï¼Œä»ŽæŸç§æ„ä¹‰ä¸Šæ¥è¯´è¿™æ˜¯ä¸€ä¸ªä»»æ„é€‰æ‹©çš„ç¨‹åºï¼Œç„¶è€Œæˆ‘ä»¬çŽ°åœ¨å·²ç»å¯ä»¥æŒç»­åœ°åœ¨ä»»æ„æ•°é‡çš„æœºå™¨ä¸Šéƒ¨ç½²å®ƒäº†ï¼Œè¿™ä¾¿æ˜¯é…ç½®ç®¡ç†çš„å¥½å¤„ã€‚æ­¤å¤–ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¿™é‡Œçš„å®šä¹‰è¯­æ³•å‡ ä¹Žæ˜¯ä¸è¨€è€Œå–»çš„ï¼Œwiki é¡µé¢ä¹Ÿå°±ä¸éœ€è¦åŠ å…¥å¤ªå¤šç»†èŠ‚äº†ã€‚å½“ç„¶åœ¨æˆ‘çš„è§‚ç‚¹é‡Œï¼Œä¸€ä¸ªæœ‰å¤ªå¤šç»†èŠ‚çš„ wiki é¡µé¢ç»ä¸ä¼šæ˜¯ä¸€ä»¶åäº‹ã€‚ æ‰©å±•é…ç½®æˆ‘ä»¬å¹¶æ²¡æœ‰æ¶‰åŠåˆ°è¿™é‡Œæ‰€æœ‰çš„ç»†èŠ‚ã€‚Ansible æœ‰è®¸å¤šé€‰é¡¹å¯ä»¥ç”¨æ¥é…ç½®ä½ çš„ç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨ä½ çš„ hosts æ–‡ä»¶ä¸­å†…åµŒå˜é‡ï¼Œè€Œ ansible å°†ä¼šæŠŠå®ƒä»¬åº”ç”¨åˆ°è¿œç¨‹èŠ‚ç‚¹ã€‚å¦‚ï¼š 12345[RHELBased]9.9.9.9. http_port=443 8.8.8.8 http_port=80 ansible_ssh_user=mdonlon [SUSEBased]127.0.0.1 http_port=443 å°½ç®¡è¿™å¯¹äºŽå¿«é€Ÿé…ç½®æ¥è¯´å·²ç»éžå¸¸æ–¹ä¾¿ï¼Œä½ è¿˜å¯ä»¥å°†å˜é‡åˆ†æˆå­˜æ”¾åœ¨ yaml æ ¼å¼çš„å¤šä¸ªæ–‡ä»¶ä¸­ã€‚åœ¨ä½ çš„ hosts æ–‡ä»¶è·¯å¾„é‡Œï¼Œä½ å¯ä»¥åˆ›å»ºä¸¤ä¸ªå­ç›®å½• groupvars å’Œ hostvarsã€‚åœ¨è¿™äº›è·¯å¾„é‡Œæ”¾ç½®çš„ä»»ä½•æ–‡ä»¶ï¼Œåªè¦èƒ½å¯¹å¾—ä¸Šä¸€ä¸ªä¸»æœºåˆ†ç»„çš„åå­—ï¼Œæˆ–è€…ä½ çš„ hosts æ–‡ä»¶ä¸­çš„ä¸€ä¸ªä¸»æœºåï¼Œå®ƒä»¬éƒ½ä¼šåœ¨è¿è¡Œæ—¶è¢«æ’å…¥è¿›æ¥ã€‚æ‰€ä»¥å‰é¢çš„ä¸€ä¸ªä¾‹å­å°†ä¼šå˜æˆè¿™æ ·ï¼š 12345678910ultrabook:/etc/ansible # pwd/etc/ansibleultrabook:/etc/ansible # tree.â”œâ”€â”€ group_varsâ”‚ â”œâ”€â”€ RHELBasedâ”‚ â””â”€â”€ SUSEBasedâ”œâ”€â”€ hostsâ””â”€â”€ host_vars â”œâ”€â”€ 10.50.1.33 â””â”€â”€ 10.50.1.47 1234567891011121314151617182 directories, 5 filesultrabook:/etc/ansible # cat hosts[RHELBased]10.50.1.3310.50.1.47[SUSEBased]127.0.0.1ultrabook:/etc/ansible # cat group_vars/RHELBasedultrabook:/etc/ansible # cat group_vars/SUSEBased---http_port: 443ultrabook:/etc/ansible # cat host_vars/10.50.1.33---http_port: 443ultrabook:/etc/ansible # cat host_vars/10.50.1.47---http_port:80ansible_ssh_user: mdonlon æ”¹å–„ Playbooksç»„ç»‡ playbooks ä¹Ÿå·²ç»æœ‰å¾ˆå¤šç§çŽ°æˆçš„æ–¹å¼ã€‚åœ¨å‰é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ç”¨äº†ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œå› æ­¤è¿™æ–¹é¢è¢«å¤§å¹…åœ°ç®€åŒ–äº†ã€‚ç»„ç»‡è¿™äº›æ–‡ä»¶çš„ä¸€ä¸ªå¸¸ç”¨æ–¹å¼æ˜¯åˆ›å»ºè§’è‰²ã€‚ç®€å•æ¥è¯´ï¼Œä½ å°†ä¸€ä¸ªä¸»æ–‡ä»¶åŠ è½½ä¸ºä½ çš„ playbookï¼Œè€Œå®ƒå°†ä¼šä»Žå…¶å®ƒæ–‡ä»¶ä¸­å¯¼å…¥æ‰€æœ‰çš„æ•°æ®ï¼Œè¿™äº›å…¶ä»–çš„æ–‡ä»¶ä¾¿æ˜¯è§’è‰²ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æžœä½ æœ‰äº†ä¸€ä¸ª wordpress ç½‘ç«™ï¼Œä½ éœ€è¦ä¸€ä¸ª web å‰ç«¯ï¼Œå’Œä¸€ä¸ªæ•°æ®åº“ã€‚web å‰ç«¯å°†åŒ…æ‹¬ä¸€ä¸ª web æœåŠ¡å™¨ï¼Œåº”ç”¨ç¨‹åºä»£ç ï¼Œä»¥åŠä»»ä½•éœ€è¦çš„æ¨¡å—ã€‚æ•°æ®åº“æœ‰æ—¶å€™è¿è¡Œåœ¨åŒä¸€å°ä¸»æœºä¸Šï¼Œæœ‰æ—¶å€™è¿è¡Œåœ¨è¿œç¨‹çš„ä¸»æœºä¸Šï¼Œè¿™æ—¶å€™è§’è‰²å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ã€‚ä½ åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå¹¶å¯¹æ¯ä¸ªè§’è‰²åˆ›å»ºå¯¹åº”çš„å° playbookã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬éœ€è¦ä¸€ä¸ª apache è§’è‰²ï¼Œmysql è§’è‰²ï¼Œwordpress è§’è‰²ï¼Œmod_phpï¼Œä»¥åŠ php è§’è‰²ã€‚æœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªè§’è‰²éƒ½å¿…é¡»è¢«åº”ç”¨åˆ°åŒä¸€å°æœºå™¨ä¸Šã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œmysql å¯ä»¥è¢«åº”ç”¨åˆ°ä¸€å°å•ç‹¬çš„æœºå™¨ã€‚è¿™åŒæ ·ä¸ºä»£ç é‡ç”¨æä¾›äº†å¯èƒ½ï¼Œæ¯”å¦‚ä½ çš„ apache è§’è‰²è¿˜å¯ä»¥è¢«ç”¨åœ¨ python å’Œå…¶ä»–ç›¸ä¼¼çš„ php åº”ç”¨ç¨‹åºä¸­ã€‚å±•ç¤ºè¿™äº›å·²ç»æœ‰äº›è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒç•´ï¼Œè€Œä¸”åšä¸€ä»¶äº‹æ€»æ˜¯æœ‰å¾ˆå¤šä¸åŒçš„æ–¹å¼ï¼Œæˆ‘å»ºè®®æœç´¢ä¸€äº› ansible çš„ playbook ä¾‹å­ã€‚æœ‰å¾ˆå¤šäººåœ¨ github ä¸Šè´¡çŒ®ä»£ç ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–ä¸€äº›ç½‘ç«™ã€‚ ansibleå‘½ä»¤é›†ï¼š/usr/bin/ansible: # Ansibe AD-Hoc ä¸´æ—¶å‘½ä»¤æ‰§è¡Œå·¥å…·ï¼Œå¸¸ç”¨äºŽä¸´æ—¶å‘½ä»¤çš„æ‰§è¡Œ/usr/bin/ansible-doc: # Ansible æ¨¡å—åŠŸèƒ½æŸ¥çœ‹å·¥å…·/usr/bin/ansible-galaxy: # ä¸‹è½½/ä¸Šä¼ ä¼˜ç§€ä»£ç æˆ–Rolesæ¨¡å—çš„å®˜ç½‘å¹³å°ï¼ŒåŸºäºŽç½‘ç»œçš„/usr/bin/ansible-playbook: # Ansible å®šåˆ¶è‡ªåŠ¨åŒ–çš„ä»»åŠ¡é›†ç¼–æŽ’å·¥å…·/usr/bin/ansible-pull: # Ansibleè¿œç¨‹æ‰§è¡Œå‘½ä»¤çš„å·¥å…·ï¼ˆä½¿ç”¨è¾ƒå°‘ï¼Œæµ·é‡æœºå™¨æ—¶ä½¿ç”¨ï¼Œå¯¹è¿ç»´çš„æž¶æž„èƒ½åŠ›è¦æ±‚è¾ƒé«˜ï¼‰/usr/bin/ansible-vault: # Ansible æ–‡ä»¶åŠ å¯†å·¥å…·/usr/bin/ansible-console: # AnsibleåŸºäºŽLinux Consobleç•Œé¢å¯ä¸Žç”¨æˆ·äº¤äº’çš„å‘½ä»¤æ‰§è¡Œå·¥å…·/usr/share/ansible_plugins:Ansibleé«˜çº§è‡ªå®šä¹‰æ’ä»¶ç›®å½•ï¼ˆéœ€è¦pythonåŸºç¡€ï¼‰/etc/ansible/ansible.cfg:é…ç½®æ–‡ä»¶/etc/ansible/hosts:ä¸»æœºæ¸…å• Ansible é…ç½®æ–‡ä»¶ ç»å¤§å¤šæ•°é…ç½®ä¿æŒé»˜è®¤å°±å¥½1ï¼‰[defaults] 123456789101112131415#inventory = /etc/ansible/hosts # ä¸»æœºåˆ—è¡¨é…ç½®æ–‡ä»¶#library = /usr/share/my_modules/ # åº“æ–‡ä»¶å­˜æ”¾ç›®å½• #remote_tmp = $HOME/.ansible/tmp # ç”Ÿæˆçš„ä¸´æ—¶pyå‘½ä»¤æ–‡ä»¶å­˜æ”¾åœ¨è¿œç¨‹ä¸»æœºçš„ç›®å½•#local_tmp = $HOME/.ansible/tmp # æœ¬æœºçš„ä¸´æ—¶å‘½ä»¤æ‰§è¡Œç›®å½•#forks = 5 # é»˜è®¤å¹¶å‘æ•°#poll_interval = 15 # é»˜è®¤çš„çº¿ç¨‹æ± #sudo_user = root # é»˜è®¤sudo ç”¨æˆ·#ask_sudo_pass = True#ask_pass = True#transport = smart#remote_port = 22#module_lang = C#module_set_locale = Falsehost_key_checking = False ### æ£€æŸ¥å¯¹åº”æœåŠ¡å™¨çš„host_key ï¼ˆ2ï¼‰[privilege_escalation]ï¼ˆ3ï¼‰[paramiko_connection]ï¼ˆ4ï¼‰[ssh_connection]ï¼ˆ5ï¼‰[accelerate]ï¼ˆ6ï¼‰[selinux]ï¼ˆ7ï¼‰[colors] Ansibleå‘½ä»¤ä½¿ç”¨è¯´æ˜Žansible1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#è°ƒç”¨pingæ¨¡å—æ£€æµ‹node3ä¸»æœºæ˜¯å¦å­˜æ´»ï¼ˆnode2,3,4èƒ½åŸºäºŽä¸»æœºåé€šä¿¡ï¼Œä¸”å·²åšè¿‡å…å¯†é’¥é€šä¿¡ï¼‰ [root@node2 ~/.ssh]# ansible node3 -m ping node3 | success &gt;&gt; &#123; "changed": false, "ping": "pong" &#125;[root@node2 ~/.ssh]# root@node2 ~/.ssh]# ansible -h Usage: ansible &lt;host-pattern&gt; [options]Options: -a MODULE_ARGS, --args=MODULE_ARGS #æ¨¡å—çš„å‚æ•°,å¦‚æžœæ‰§è¡Œé»˜è®¤COMMANDçš„æ¨¡å—ï¼Œå³æ˜¯å‘½ä»¤å‚æ•°,å¦‚ï¼šâ€œdateâ€,"pwd"ç­‰ç­‰ module arguments #æ¨¡å—å‚æ•° --ask-become-pass ask for privilege escalation password # Ansible suåˆ‡æ¢ç”¨æˆ·çš„æ—¶å€™ä½¿ç”¨è¯¥å‚æ•°è¾“å…¥å¯†ç  -k, --ask-pass ask for SSH password #ç™»å½•å¯†ç ï¼Œæç¤ºè¾“å…¥SSHå¯†ç è€Œä¸æ˜¯å‡è®¾åŸºäºŽå¯†é’¥çš„éªŒè¯ --ask-su-pass ask for su password #suåˆ‡æ¢å¯†ç  -K, --ask-sudo-pass ask for sudo password #æç¤ºå¯†ç ä½¿ç”¨sudo,sudoè¡¨ç¤ºææƒæ“ä½œ --ask-vault-pass ask for vault password # ansible-valut åŠ å¯†æ–‡ä»¶ -B SECONDS, --background=SECONDS #åŽå°è¿è¡Œè¶…æ—¶æ—¶é—´ run asynchronously, failing after X seconds (default=N/A) -C, --check don't make any changes; instead, try to predict some #åªæ˜¯æµ‹è¯•ä¸€ä¸‹ä¼šæ”¹å˜ä»€ä¹ˆå†…å®¹ï¼Œä¸ä¼šçœŸæ­£åŽ»æ‰§è¡Œ;ç›¸å,è¯•å›¾é¢„æµ‹ä¸€äº›å¯èƒ½å‘ç”Ÿçš„å˜åŒ– of the changes that may occur -c CONNECTION, --connection=CONNECTION è¿žæŽ¥ç±»åž‹ä½¿ç”¨ã€‚å¯èƒ½çš„é€‰é¡¹æ˜¯paramiko(SSH),SSHå’Œåœ°æ–¹ã€‚å½“åœ°ä¸»è¦æ˜¯ç”¨äºŽcrontabæˆ–å¯åŠ¨ã€‚ connection type to use (default=smart) -e EXTRA_VARS, --extra-vars=EXTRA_VARS # è°ƒç”¨å¤–éƒ¨å˜é‡ -f FORKS, --forks=FORKS # Ansibleä¸€æ¬¡å‘½ä»¤æ‰§è¡Œå¹¶å‘çš„çº¿ç¨‹æ•°,é»˜è®¤æ˜¯5 specify number of parallel processes to use (default=5) -h, --help show this help message and exit #æ‰“å¼€å¸®åŠ©æ–‡æ¡£API -i INVENTORY, --inventory-file=INVENTORY #æŒ‡å®šåº“å­˜ä¸»æœºæ–‡ä»¶çš„è·¯å¾„,é»˜è®¤ä¸º/etc/ansible/hosts specify inventory host file (default=/etc/ansible/hosts) -l SUBSET, --limit=SUBSET #è¿›ä¸€æ­¥é™åˆ¶æ‰€é€‰ä¸»æœº/ç»„æ¨¡å¼ --limit=192.168.91.135 åªå¯¹è¿™ä¸ªipæ‰§è¡Œ further limit selected hosts to an additional pattern --list-hosts outputs a list of matching hosts; does not execute anything else -m MODULE_NAME, --module-name=MODULE_NAME #æ‰§è¡Œæ¨¡å—çš„åå­—ï¼Œé»˜è®¤ä½¿ç”¨ command æ¨¡å—ï¼Œæ‰€ä»¥å¦‚æžœæ˜¯åªæ‰§è¡Œå•ä¸€å‘½ä»¤å¯ä»¥ä¸ç”¨ -må‚æ•° module name to execute (default=command) -M MODULE_PATH, --module-path=MODULE_PATH #è¦æ‰§è¡Œçš„æ¨¡å—çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º/usr/share/ansible/ specify path(s) to module library (default=/usr/share/ansible/) -o, --one-line condense output #åŽ‹ç¼©è¾“å‡ºï¼Œæ‘˜è¦è¾“å‡º.å°è¯•ä¸€åˆ‡éƒ½åœ¨ä¸€è¡Œä¸Šè¾“å‡ºã€‚ -P POLL_INTERVAL, --poll=POLL_INTERVAL #è°ƒæŸ¥èƒŒæ™¯å·¥ä½œæ¯éš”æ•°ç§’ã€‚éœ€è¦- b set the poll interval if using -B (default=15) --private-key=PRIVATE_KEY_FILE #ç§é’¥è·¯å¾„ï¼Œä½¿ç”¨è¿™ä¸ªæ–‡ä»¶æ¥éªŒè¯è¿žæŽ¥ use this file to authenticate the connection -S, --su run operations with su ç”¨ su å‘½ä»¤ -R SU_USER, --su-user=SU_USER #æŒ‡å®šSUçš„ç”¨æˆ·ï¼Œé»˜è®¤æ˜¯rootç”¨æˆ· run operations with su as this user (default=root) -s, --sudo run operations with sudo (nopasswd) -U SUDO_USER, --sudo-user=SUDO_USER #sudoåˆ°å“ªä¸ªç”¨æˆ·ï¼Œé»˜è®¤ä¸º root desired sudo user (default=root) -T TIMEOUT, --timeout=TIMEOUT #æŒ‡å®šSSHé»˜è®¤è¶…æ—¶æ—¶é—´ï¼Œ é»˜è®¤æ˜¯10S override the SSH timeout in seconds (default=10) -t TREE, --tree=TREE log output to this directory #å°†æ—¥å¿—å†…å®¹ä¿å­˜åœ¨è¯¥è¾“å‡ºç›®å½•,ç»“æžœä¿å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­åœ¨æ¯å°ä¸»æœºä¸Šã€‚ -u REMOTE_USER, --user=REMOTE_USER #è¿œç¨‹ç”¨æˆ·ï¼Œ é»˜è®¤æ˜¯rootç”¨æˆ· connect as this user (default=root) --vault-password-file=VAULT_PASSWORD_FILE vault password file -v, --verbose verbose mode (-vvv for more, -vvvv to enable è¯¦ç»†ä¿¡æ¯ connection debugging) --version show program's version number and exit #è¾“å‡ºansibleçš„ç‰ˆæœ¬ Ansiblieå‘½ä»¤æ‰§è¡Œè¿‡ç¨‹ ï¼ˆ-vvvvï¼‰åŠ è½½è‡ªå·±çš„é…ç½®æ–‡ä»¶ é»˜è®¤/etc/ansible/ansible.cfgåŠ è½½è‡ªå·±å¯¹åº”çš„æ¨¡å—æ–‡ä»¶ï¼Œå¦‚commandé€šè¿‡ansibleå°†æ¨¡å—æˆ–å‘½ä»¤ç”Ÿæˆå¯¹åº”çš„ä¸´æ—¶pyæ–‡ä»¶ï¼Œå¹¶å°†è¯¥ æ–‡ä»¶ä¼ è¾“è‡³è¿œç¨‹æœåŠ¡å™¨çš„ å¯¹åº”æ‰§è¡Œç”¨æˆ·çš„å®¶ç›®å½•çš„.ansible/tmp/XXX/XXX.PYæ–‡ä»¶ç»™æ–‡ä»¶+xæ‰§è¡Œæ‰§è¡Œå¹¶è¿”å›žç»“æžœåˆ é™¤ä¸´æ—¶pyæ–‡ä»¶ï¼Œsleep 0é€€å‡º ansibleä¸»æœºæ¸…å•çš„é…ç½® /ect/ansible/hosts,å®šä¹‰æ–¹å¼ï¼š ç›´æŽ¥æŒ‡æ˜Žä¸»æœºåœ°å€æˆ–ä¸»æœºånode3 172.16.47.104å®šä¹‰ä¸€ä¸ªä¸»æœºç»„ï¼ŒæŠŠä¸»æœºåœ°å€æˆ–ä¸»æœºåå†™è¿›åŽ»ï¼Œç„¶åŽé€šè¿‡ç»„åæ¥è°ƒç”¨è¿™ä¸ªç»„[webservers] node3node4å¦‚æžœæ²¡æœ‰ä½¿ç”¨å…¬é’¥ï¼Œæƒ³è¦ä½¿ç”¨å¯†ç ï¼Œä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼ˆé€‚ç”¨äºŽç¬¬ä¸€æ¬¡ç™»é™†æŽ§åˆ¶ï¼‰æ ¼å¼ï¼šã€ä¸»æœºåã€‘ ã€ä¸»æœºåœ°å€ã€‘ ã€ä¸»æœºå¯†ç ã€‘ é»˜è®¤æ˜¯rootç”¨æˆ·æ¥è¿›è¡Œçš„ [keepalived] keepalived1 ansible_ssh_host=192.168.146.136 ansible_ssh_pass=â€testâ€ keepalived2 ansible_ssh_host=192.168.146.137 ansible_ssh_pass=â€testâ€ 10.0.1.5 ansible_ssh_private_key_file=ssh_keys/10.0.1.5.key ansible_ssh_user=rootansible-doc ansible-doc -l :èŽ·å–æ¨¡å—ä¿¡æ¯ ansible-doc -s MOD_NAME: èŽ·å–æŒ‡å®šæ¨¡å—çš„ä½¿ç”¨å¸®åŠ©1234567891011[root@node2 ~]# ansible-doc -h Usage: ansible-doc [options] [module...]Show Ansible module documentation æ˜¾ç¤ºAnsibleæ¨¡å—æ–‡æ¡£Options: --version show program&apos;s version number and exit æ˜¾ç¤ºansible-docçš„ç‰ˆæœ¬å· -h, --help show this help message and exit æ˜¾ç¤ºå‘½ä»¤å‚æ•°APIæ–‡æ¡£ -M MODULE_PATH, --module-path=MODULE_PATH æŸ¥è¯¢æ¨¡å—ï¼Œ--module-path=MODULE_PATH æŒ‡å®šæ¨¡å—çš„è·¯å¾„ Ansible modules/ directory -l, --list List available modules æ˜¾ç¤ºå·²å­˜åœ¨çš„æ‰€æœ‰æ¨¡å—åˆ—è¡¨ -s, --snippet Show playbook snippet for specified module(s) æ˜¾ç¤ºplaybookåˆ¶å®šæ¨¡å—çš„ç”¨æ³• -v Show version number and exit æ˜¾ç¤ºansible-docçš„ç‰ˆæœ¬å· Ansibleæ¨¡å—commandæ¨¡å—:ä½¿ç”¨ansibleè‡ªå¸¦æ¨¡å—æ‰§è¡Œå‘½ä»¤ å¦‚æžœè¦ç”¨ &gt; &lt; | &amp; â€˜ â€˜ ä½¿ç”¨shellæ¨¡å— 12345678[root@node2 ~/.ssh]# ansible all -m command -a &quot;ls /root/.ssh&quot; node4 | success | rc=0 &gt;&gt;authorized_keysknown_hostsnode3 | success | rc=0 &gt;&gt;authorized_keysknown_hosts[root@node2 ~/.ssh]# ç›¸å…³é€‰é¡¹å¦‚ä¸‹ï¼š createsï¼šä¸€ä¸ªæ–‡ä»¶åï¼Œå½“è¯¥æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¯¥å‘½ä»¤ä¸æ‰§è¡Œfree_formï¼šè¦æ‰§è¡Œçš„linuxæŒ‡ä»¤chdirï¼šåœ¨æ‰§è¡ŒæŒ‡ä»¤ä¹‹å‰ï¼Œå…ˆåˆ‡æ¢åˆ°è¯¥ç›®å½•removesï¼šä¸€ä¸ªæ–‡ä»¶åï¼Œå½“è¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è¯¥é€‰é¡¹ä¸æ‰§è¡Œexecutableï¼šåˆ‡æ¢shellæ¥æ‰§è¡ŒæŒ‡ä»¤ï¼Œè¯¥æ‰§è¡Œè·¯å¾„å¿…é¡»æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ shell æ¨¡å—:è°ƒç”¨bashæ‰§è¡Œå‘½ä»¤ ç±»ä¼¼ cat /tmp/stanley.md | awk -Fâ€™|â€™ â€˜{print $1,$2}â€™ &amp;&gt; /tmp/stanley.txt è¿™äº›å¤æ‚å‘½ä»¤ï¼Œå³ä½¿ä½¿ç”¨shellä¹Ÿä¼šå¤±è´¥ï¼Œè§£å†³åŠžæ³•ï¼šå†™åˆ°è„šæœ¬æ—¶ï¼Œcopyåˆ°è¿œç¨‹ï¼Œæ‰§è¡Œï¼Œå†æŠŠéœ€è¦çš„ç»“æžœæ‹‰å›žæ‰§è¡Œå‘½ä»¤çš„æœºå™¨ï¼ˆæ‰§è¡ŒAnsibleå‘½ä»¤çš„æœºå™¨å¾€å¾€ç§°ä¸ºï¼šMasteræœºæˆ–è€…ä¸­æŽ§æœºæˆ–è€…å ¡åž’æœºï¼‰ã€‚ æ³¨æ„ï¼šcommandå’Œshellæ¨¡å—çš„æ ¸å¿ƒå‚æ•°ç›´æŽ¥ä¸ºå‘½ä»¤æœ¬èº«ï¼›è€Œå…¶å®ƒæ¨¡å—çš„å‚æ•°é€šå¸¸ä¸ºâ€œkey=valueâ€æ ¼å¼ï¼›â€™â€™ copyæ¨¡å—ï¼šå¤åˆ¶æœ¬åœ°æ–‡ä»¶è‡³è¿œç¨‹æœåŠ¡å™¨ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ”¹å±žæ€§ç­‰ ç›´æŽ¥å¤åˆ¶ï¼š 1ansible all -m copy -a &quot;src=txt dest=/tmp mode=540&quot; ç”Ÿæˆå†…å®¹çš„å¤åˆ¶ï¼š 12ansible all -m copy -a &quot;content=&apos;hellow&apos; dest=/tmp/test mode=540&quot;ansible all -m shell -a &quot;cat /tmp/test mode=540&quot; æ³¨æ„ï¼šè¿™ä¸¤ç§æ–¹æ³•æ˜¯äº’æ–¥çš„ï¼Œå³srcå’Œcontentä¸èƒ½åŒæ—¶ä½¿ç”¨ç›¸å…³é€‰é¡¹å¦‚ä¸‹ï¼š backupï¼šåœ¨è¦†ç›–ä¹‹å‰ï¼Œå°†æºæ–‡ä»¶å¤‡ä»½ï¼Œå¤‡ä»½æ–‡ä»¶åŒ…å«æ—¶é—´ä¿¡æ¯ã€‚æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼šyes|nocontentï¼šç”¨äºŽæ›¿ä»£â€œsrcâ€ï¼Œå¯ä»¥ç›´æŽ¥è®¾å®šæŒ‡å®šæ–‡ä»¶çš„å€¼destï¼šå¿…é€‰é¡¹ã€‚è¦å°†æºæ–‡ä»¶å¤åˆ¶åˆ°çš„è¿œç¨‹ä¸»æœºçš„ç»å¯¹è·¯å¾„ï¼Œå¦‚æžœæºæ–‡ä»¶æ˜¯ä¸€ä¸ªç›®å½•ï¼Œé‚£ä¹ˆè¯¥è·¯å¾„ä¹Ÿå¿…é¡»æ˜¯ä¸ªç›®å½•directory_modeï¼šé€’å½’è®¾å®šç›®å½•çš„æƒé™ï¼Œé»˜è®¤ä¸ºç³»ç»Ÿé»˜è®¤æƒé™forceï¼šå¦‚æžœç›®æ ‡ä¸»æœºåŒ…å«è¯¥æ–‡ä»¶ï¼Œä½†å†…å®¹ä¸åŒï¼Œå¦‚æžœè®¾ç½®ä¸ºyesï¼Œåˆ™å¼ºåˆ¶è¦†ç›–ï¼Œå¦‚æžœä¸ºnoï¼Œåˆ™åªæœ‰å½“ç›®æ ‡ä¸»æœºçš„ç›®æ ‡ä½ç½®ä¸å­˜åœ¨è¯¥æ–‡ä»¶æ—¶ï¼Œæ‰å¤åˆ¶ã€‚é»˜è®¤ä¸ºyesothersï¼šæ‰€æœ‰çš„fileæ¨¡å—é‡Œçš„é€‰é¡¹éƒ½å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨srcï¼šè¢«å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºçš„æœ¬åœ°æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚å¦‚æžœè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå®ƒå°†é€’å½’å¤åˆ¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æžœè·¯å¾„ä½¿ç”¨â€œ/â€æ¥ç»“å°¾ï¼Œåˆ™åªå¤åˆ¶ç›®å½•é‡Œçš„å†…å®¹ï¼Œå¦‚æžœæ²¡æœ‰ä½¿ç”¨â€œ/â€æ¥ç»“å°¾ï¼Œåˆ™åŒ…å«ç›®å½•åœ¨å†…çš„æ•´ä¸ªå†…å®¹å…¨éƒ¨å¤åˆ¶ï¼Œç±»ä¼¼äºŽrsyncã€‚ fileæ¨¡å—ï¼šè®¾ç½®æ–‡ä»¶å±žæ€§ -a â€œpath=PATH state=directoryâ€ # åˆ›å»ºç›®å½• ~]# ansible all -m file -a "path12 -a â€œpath=PATH src=FILE state=linkâ€ #åˆ›å»ºé“¾æŽ¥æ–‡ä»¶ [root@node2 ~]# ansible all -m file -a â€œpath=/root/haha src=/tmp/hehe state=linkâ€ -a â€œpath=PATH state=absentâ€ #åˆ é™¤æ–‡ä»¶[root@node2 ~]# ansible all -m file -a â€œpath=/root/haha state=absentâ€ ç›¸å…³é€‰é¡¹å¦‚ä¸‹ï¼šforceï¼šéœ€è¦åœ¨ä¸¤ç§æƒ…å†µä¸‹å¼ºåˆ¶åˆ›å»ºè½¯é“¾æŽ¥ï¼Œä¸€ç§æ˜¯æºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½†ä¹‹åŽä¼šå»ºç«‹çš„æƒ…å†µä¸‹ï¼›å¦ä¸€ç§æ˜¯ç›®æ ‡è½¯é“¾æŽ¥å·²å­˜åœ¨ï¼Œéœ€è¦å…ˆå–æ¶ˆä¹‹å‰çš„è½¯é“¾ï¼Œç„¶åŽåˆ›å»ºæ–°çš„è½¯é“¾ï¼Œæœ‰ä¸¤ä¸ªé€‰é¡¹ï¼šyes|no groupï¼šå®šä¹‰æ–‡ä»¶/ç›®å½•çš„å±žç»„modeï¼šå®šä¹‰æ–‡ä»¶/ç›®å½•çš„æƒé™ownerï¼šå®šä¹‰æ–‡ä»¶/ç›®å½•çš„å±žä¸»pathï¼šå¿…é€‰é¡¹ï¼Œå®šä¹‰æ–‡ä»¶/ç›®å½•çš„è·¯å¾„recurseï¼šé€’å½’è®¾ç½®æ–‡ä»¶çš„å±žæ€§ï¼Œåªå¯¹ç›®å½•æœ‰æ•ˆ srcï¼šè¢«é“¾æŽ¥çš„æºæ–‡ä»¶è·¯å¾„ï¼Œåªåº”ç”¨äºŽstate=linkçš„æƒ…å†µ destï¼šè¢«é“¾æŽ¥åˆ°çš„è·¯å¾„ï¼Œåªåº”ç”¨äºŽstate=linkçš„æƒ…å†µ stateï¼š directoryï¼šå¦‚æžœç›®å½•ä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºç›®å½• fileï¼šå³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šè¢«åˆ›å»º linkï¼šåˆ›å»ºè½¯é“¾æŽ¥ hardï¼šåˆ›å»ºç¡¬é“¾æŽ¥ touchï¼šå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶æˆ–ç›®å½•å·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°å…¶æœ€åŽä¿®æ”¹æ—¶é—´ absentï¼šåˆ é™¤ç›®å½•ã€æ–‡ä»¶æˆ–è€…å–æ¶ˆé“¾æŽ¥æ–‡ä»¶ fetchæ¨¡å—ï¼š ä»Žè¿œç¨‹æœåŠ¡å™¨æ‹‰å–æ–‡ä»¶è‡³æœ¬æœºï¼Œåªèƒ½fetchæ–‡ä»¶ï¼Œä¸èƒ½fetchç›®å½•,å¦‚æžœæ‹‰ç›®å½•ï¼Œå…ˆtar/zip å†æ‹‰åˆ°æœ¬æœºå³å¯ [root@node2 ~]# ansible all -m fetch -a â€œsrc=/tmp/txt dest=/root/txt.txtâ€ cronæ¨¡å—: ç®¡ç†cronè®¡åˆ’ä»»åŠ¡ [root@node2 ~]# ansible all -m corn -a â€œminute=â€™*/5â€™ job=â€™/usr/sbin/ntpdate 172.16.0.1 &amp;&gt; /dev/nullâ€™ name=â€™Synctimeâ€™â€ #æ¯5åˆ†é’ŸåŒæ­¥ä¸€ä¸‹æ—¶é—´ [root@node2 ~]# ansible all -m corn -a â€œstate=absent name=â€™Synctimeâ€™â€ #åˆ é™¤ä¸Šé¢çš„å®šæ—¶ä»»åŠ¡ ç›¸å…³é€‰é¡¹å¦‚ä¸‹ï¼š a â€œâ€: è®¾ç½®ç®¡ç†èŠ‚ç‚¹ç”Ÿæˆå®šæ—¶ä»»åŠ¡ action: cron backup= # å¦‚æžœè®¾ç½®ï¼Œåˆ›å»ºä¸€ä¸ªcrontabå¤‡ä»½ cron_file= #å¦‚æžœæŒ‡å®š, ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶cron.dï¼Œè€Œä¸æ˜¯å•ä¸ªç”¨æˆ·crontab day= # æ—¥åº”è¯¥è¿è¡Œçš„å·¥ä½œ( 1-31, , /2, etc ) hour= # å°æ—¶ ( 0-23, , /2, etc ) job= #æŒ‡æ˜Žè¿è¡Œçš„å‘½ä»¤æ˜¯ä»€ä¹ˆ minute= #åˆ†é’Ÿ( 0-59, , /2, etc ) month= # æœˆ( 1-12, , /2, etc ) name= #å®šæ—¶ä»»åŠ¡æè¿° reboot # ä»»åŠ¡åœ¨é‡å¯æ—¶è¿è¡Œï¼Œä¸å»ºè®®ä½¿ç”¨ï¼Œå»ºè®®ä½¿ç”¨special_time special_time # ç‰¹æ®Šçš„æ—¶é—´èŒƒå›´ï¼Œå‚æ•°ï¼šrebootï¼ˆé‡å¯æ—¶ï¼‰,annuallyï¼ˆæ¯å¹´ï¼‰,monthlyï¼ˆæ¯æœˆï¼‰,weeklyï¼ˆæ¯å‘¨ï¼‰,dailyï¼ˆæ¯å¤©ï¼‰,hourlyï¼ˆæ¯å°æ—¶ï¼‰ state #æŒ‡å®šçŠ¶æ€ï¼Œprsentè¡¨ç¤ºæ·»åŠ å®šæ—¶ä»»åŠ¡ï¼Œä¹Ÿæ˜¯é»˜è®¤è®¾ç½®ï¼Œabsentè¡¨ç¤ºåˆ é™¤å®šæ—¶ä»»åŠ¡ user # ä»¥å“ªä¸ªç”¨æˆ·çš„èº«ä»½æ‰§è¡Œ weekday # å‘¨ ( 0-6 for Sunday-Saturday, *, etc ) yumæ¨¡å—ï¼šyumå®‰è£…è½¯ä»¶ï¼Œä¹Ÿæœ‰apt,zypper [root@node2 ~]# ansible all -m yum -a â€œname=httpd state=latestâ€ #å®‰è£…httpdåŒ… ç›¸å…³é€‰é¡¹å¦‚ä¸‹ï¼š conf_file #è®¾å®šè¿œç¨‹yumå®‰è£…æ—¶æ‰€ä¾èµ–çš„é…ç½®æ–‡ä»¶ã€‚å¦‚é…ç½®æ–‡ä»¶æ²¡æœ‰åœ¨é»˜è®¤çš„ä½ç½®ã€‚ disable_gpg_check #æ˜¯å¦ç¦æ­¢GPG checkingï¼Œåªç”¨äºŽpresent&#39; orlatestâ€™ã€‚ disablerepo #ä¸´æ—¶ç¦æ­¢ä½¿ç”¨yumåº“ã€‚ åªç”¨äºŽå®‰è£…æˆ–æ›´æ–°æ—¶ã€‚ enablerepo #ä¸´æ—¶ä½¿ç”¨çš„yumåº“ã€‚åªç”¨äºŽå®‰è£…æˆ–æ›´æ–°æ—¶ã€‚ name= #æ‰€å®‰è£…çš„åŒ…çš„åç§° state #presentå®‰è£…ï¼Œ latestå®‰è£…æœ€æ–°çš„, absent å¸è½½è½¯ä»¶ã€‚ update_cache #å¼ºåˆ¶æ›´æ–°yumçš„ç¼“å­˜ã€‚ serviceæ¨¡å—: æœåŠ¡ç¨‹åºç®¡ç† [root@node2 ~]# ansible all -m service -a â€œname=httpd state=restartedâ€ #é‡å¯httpd [root@node2 ~]# ansible all -m service -a â€œname=httpd enabled=trueâ€ #å¼€æœºå¯åŠ¨ ç›¸å…³é€‰é¡¹å¦‚ä¸‹ï¼š arguments #å‘½ä»¤è¡Œæä¾›é¢å¤–çš„å‚æ•° enabled #è®¾ç½®å¼€æœºå¯åŠ¨ã€‚ name= #æœåŠ¡åç§° runlevel #å¼€æœºå¯åŠ¨çš„çº§åˆ«ï¼Œä¸€èˆ¬ä¸ç”¨æŒ‡å®šã€‚ sleep #åœ¨é‡å¯æœåŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯å¦ç­‰å¾…ã€‚å¦‚åœ¨æœåŠ¡å…³é—­ä»¥åŽç­‰å¾…2ç§’å†å¯åŠ¨ã€‚ state #startedå¯åŠ¨æœåŠ¡ï¼Œ stoppedåœæ­¢æœåŠ¡ï¼Œ restartedé‡å¯æœåŠ¡ï¼Œ&gt; groupæ¨¡å—: ç»„ç®¡ç† [root@node2 ~]# ansible-doc -s group name: æ·»åŠ æˆ–åˆ é™¤ç»„ action: group gid # è®¾ç½®ç»„çš„GIDå· name= # ç®¡ç†ç»„çš„åç§° state # æŒ‡å®šç»„çŠ¶æ€ï¼Œé»˜è®¤ä¸ºåˆ›å»ºï¼Œè®¾ç½®å€¼ä¸ºabsentä¸ºåˆ é™¤ system # è®¾ç½®å€¼ä¸ºyesï¼Œè¡¨ç¤ºä¸ºåˆ›å»ºç³»ç»Ÿç»„ Useræ¨¡å—:ç”¨æˆ·ç®¡ç† -a â€œâ€ action: user comment # ç”¨æˆ·çš„æè¿°ä¿¡æ¯ createhom # æ˜¯å¦åˆ›å»ºå®¶ç›®å½• force # åœ¨ä½¿ç”¨state=absent&#39;æ˜¯, è¡Œä¸ºä¸Žuserdel â€“forceâ€™ä¸€è‡´. group # æŒ‡å®šåŸºæœ¬ç»„ groups # æŒ‡å®šé™„åŠ ç»„ï¼Œå¦‚æžœæŒ‡å®šä¸º(â€˜groups=â€™)è¡¨ç¤ºåˆ é™¤æ‰€æœ‰ç»„ home # æŒ‡å®šç”¨æˆ·å®¶ç›®å½• login_class #å¯ä»¥è®¾ç½®ç”¨æˆ·çš„ç™»å½•ç±» FreeBSD, OpenBSD and NetBSDç³»ç»Ÿ. move_home # å¦‚æžœè®¾ç½®ä¸ºhome=&#39;æ—¶, è¯•å›¾å°†ç”¨æˆ·ä¸»ç›®å½•ç§»åŠ¨åˆ°æŒ‡å®šçš„ç›®å½• name= # æŒ‡å®šç”¨æˆ·å non_unique # è¯¥é€‰é¡¹å…è®¸æ”¹å˜éžå”¯ä¸€çš„ç”¨æˆ·IDå€¼ password # æŒ‡å®šç”¨æˆ·å¯†ç  remove # åœ¨ä½¿ç”¨state=absentâ€™æ—¶, è¡Œä¸ºæ˜¯ä¸Ž `userdel â€“removeâ€™ä¸€è‡´. shell # æŒ‡å®šé»˜è®¤shell state #è®¾ç½®å¸å·çŠ¶æ€ï¼Œä¸æŒ‡å®šä¸ºåˆ›å»ºï¼ŒæŒ‡å®šå€¼ä¸ºabsentè¡¨ç¤ºåˆ é™¤ system # å½“åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œè®¾ç½®è¿™ä¸ªç”¨æˆ·æ˜¯ç³»ç»Ÿç”¨æˆ·ã€‚è¿™ä¸ªè®¾ç½®ä¸èƒ½æ›´æ”¹çŽ°æœ‰ç”¨æˆ·ã€‚ uid #æŒ‡å®šç”¨æˆ·çš„uidupdate_password # æ›´æ–°ç”¨æˆ·å¯†ç expires #æŒ‡æ˜Žå¯†ç çš„è¿‡æœŸæ—¶é—´ansible all -m user -a â€˜name=magedu home=/tmp/magedu/ shell=/bin/bash uid=2000 comment=â€test userâ€ group=rootâ€™ ping æ¨¡å—ï¼š æ£€æµ‹ä¸»æœºå­˜æ´» setupæ¨¡å—ï¼šèŽ·å–æŒ‡å®šä¸»æœºçš„factsã€‚ factså°±æ˜¯å˜é‡ï¼Œå†…å»ºå˜é‡ ã€‚æ¯ä¸ªä¸»æœºçš„å„ç§ä¿¡æ¯ï¼Œcpué¢—æ•°ã€å†…å­˜å¤§å°ç­‰ã€‚ä¼šå­˜åœ¨factsä¸­çš„æŸä¸ªå˜é‡ä¸­ã€‚è°ƒç”¨åŽè¿”å›žå¾ˆå¤šå¯¹åº”ä¸»æœºçš„ä¿¡æ¯ï¼Œåœ¨åŽé¢çš„æ“ä½œä¸­å¯ä»¥æ ¹æ®ä¸åŒçš„ä¿¡æ¯æ¥åšä¸åŒçš„æ“ä½œã€‚å¦‚redhatç³»åˆ—ç”¨yumå®‰è£…ï¼Œè€Œdebianç³»åˆ—ç”¨aptæ¥å®‰è£…è½¯ä»¶ã€‚ ansible node3 -m setup selinuxæ¨¡å—ï¼š ç®¡ç†selinux å…³é—­selinux ansible all -m selinux -a â€˜state=disabledâ€™ conf #æŒ‡å®šåº”ç”¨selinuxçš„é…ç½®æ–‡ä»¶ã€‚ state=enforcing|permissive|disabled #å¯¹åº”äºŽselinuxé…ç½®æ–‡ä»¶çš„SELINUXã€‚ policy=targeted|minimum|mls #å¯¹åº”äºŽselinuxé…ç½®æ–‡ä»¶çš„SELINUXTYPE scriptæ¨¡å—ï¼šå‘é€è„šæœ¬åˆ°å„è¢«ç®¡ç†èŠ‚ç‚¹ï¼Œå¹¶æ‰§è¡Œ;ä¸éœ€è¦å‚æ•° ansible all -m script -a â€˜test.shâ€™ #ç›´æŽ¥åœ¨-a åŽé¢æŒ‡å®šè„šæœ¬å³å¯ æœªå®Œå¾…ç»­â€¦â€¦ æœ€åŽæ‰“ä¸ªå¹¿å‘Šï¼ŒStanleyè€å¸ˆçš„Ansibleæƒå¨æŒ‡å—ï¼Œä½ ï¼Œå€¼å¾—æ‹¥æœ‰ DSC0007.png (64.81 KB, ä¸‹è½½æ¬¡æ•°: 0) ä¸‹è½½é™„ä»¶ ä¿å­˜åˆ°ç›¸å†Œ 2017-6-9 08:59 ä¸Šä¼ ]]></content>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F04%2F16%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment ï¼£ï¼®ï¼¡ï¼­ï¼¥1$ echo "blog.lucas.space"&gt;source/CNAME]]></content>
  </entry>
  <entry>
    <title><![CDATA[OCi8 on php]]></title>
    <url>%2F2018%2F04%2F13%2FOCi8-on-php%2F</url>
    <content type="text"><![CDATA[php with OCI8ä½¿ç”¨phpçš„å¸¸è§é—®é¢˜æ˜¯ï¼šç¼–è¯‘phpæ—¶å¿˜è®°æ·»åŠ æŸæ‰©å±•ï¼ŒåŽæ¥æƒ³æ·»åŠ æ‰©å±•ï¼Œä½†æ˜¯å› ä¸ºå®‰è£…phpåŽåˆè£…äº†ä¸€äº›ä¸œè¥¿å¦‚PEARç­‰ï¼Œä¸æƒ³åˆ é™¤ç›®å½•é‡è£…ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±éœ€è¦è‡ªå·±é‡æ–°å¢žåŠ æŸæ¨¡å—æ”¯æŒäº†,Linuxæ“ä½œç³»ç»Ÿä¸‹å¯ä»¥ç”¨phpizeç»™PHPåŠ¨æ€æ·»åŠ æ‰©å±•.ä¸‹é¢å°±ä»¥æ‰©å±•æ¨¡å— oci8ä¸ºä¾‹(phpè¿žæŽ¥oracleæ•°æ®åº“éœ€è¦æ”¹æ‰©å±•æ”¯æŒ)åšç®€å•çš„è¯´æ˜Ž ä¸‹è½½Oracleå®¢æˆ·ç«¯ç¨‹åºåŒ…ï¼Œå…¶ä¸­åŒ…å«OCIã€OCCIå’ŒJDBC-OCIç­‰ç›¸å…³æ–‡ä»¶ 1.1 æ ¹æ®Linuxç³»ç»Ÿé€‰æ‹©å¯¹åº”çš„è½¯ä»¶,ä»¥32ä½ç³»ç»Ÿä¸ºä¾‹,æ‰€ä»¥ä¸‹è½½å¦‚ä¸‹æ–‡ä»¶: oracle-instantclient11.2-basic-11.2.0.3.0-1.i386.rpm oracle-instantclient11.2-devel-11.2.0.3.0-1.i386.rpm 1.2 ä¸‹è½½åœ°å€: http://www.oracle.com/technetwork/database/features/instant-client/index-097480.html (Oracleå®˜ç½‘ä¸‹è½½éœ€è¦æ³¨å†Œç”¨æˆ·) å®‰è£…oracleå®¢æˆ·ç«¯,è¿è¡Œä»¥ä¸‹å‘½ä»¤å³å¯: rpm -ivh oracle-instantclient11.2-basic-11.2.0.3.0.i386.rpm rpm -ivh oracle-instantclient11.2-devel-11.2.0.3.0.i386.rpm å®‰è£…oci8 phpæ‰©å±• 3.1 ä¸‹è½½oci8-1.4.10.tgz ä¸‹è½½åœ°å€:http://pecl.php.net/get/oci8-1.4.10.tgz 3.2 æŠŠä¸‹è½½æ–‡ä»¶ä¸Šä¼ è‡³linuxæœåŠ¡å™¨,å¹¶è¿›è¡Œè§£åŽ‹ å‘½ä»¤:tar zxvf oci8-1.4.10.tgz#è§£åŽ‹ 3.3 è½¬åˆ°è§£åŽ‹ç›®å½• å‘½ä»¤:cd oci8-1.4.10 3.4 ä½¿ç”¨phpizeå‡†å¤‡ PHP å¤–æŒ‚æ¨¡å—çš„ç¼–è¯‘çŽ¯å¢ƒï¼Œä¼šæ ¹æ®æŒ‡å®šçš„çŽ¯å¢ƒå˜é‡ç”Ÿæˆç¼–è¯‘æ—¶éœ€è¦çš„makefileï¼Œphpizeæ˜¯å±žäºŽphp-develçš„å†…å®¹ï¼Œæ‰€ä»¥centosä¸‹åªè¦è¿è¡Œyum install php-develè¿›è¡Œå®‰è£…å³å¯ (æ³¨æ„:/usr/local/php/bin/phpize ä¸ºæˆ‘çš„phpç›®å½•,ä¸åŒåˆ™éœ€æ”¹ä¹‹;å¦‚æžœæ˜¯64ä½çš„ç³»ç»Ÿï¼Œclientæ”¹æˆclient64) /usr/local/php/bin/phpize CFLAGS=â€-I/usr/lib/oracle/11.1/clientâ€ CXXFLAGS=â€-I/usr/lib/oracle/11.1/clientâ€ 3.5 ç¼–è¯‘ï¼Œå®‰è£… è¦æœ‰ä¸ŽçŽ°æœ‰phpå®Œå…¨ç›¸åŒçš„phpåŽ‹ç¼©åŒ…ã€‚æˆ‘ç”¨çš„æ˜¯php-5.5.3.tar.gzã€‚å±•å¼€åŽè¿›å…¥é‡Œé¢çš„ext/oci8ç›®å½•ä¸‹, ç„¶åŽæ‰§è¡Œå‘½ä»¤: /usr/local/php/bin/phpize #è¿™æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡æœ¬æ–‡ä»¶ï¼Œè¦ç¡®ä¿å®ƒåœ¨ç³»ç»Ÿä¸­ ä¼šå‘çŽ°å½“å‰ç›®å½•ä¸‹å¤šäº†ä¸€äº›configureæ–‡ä»¶ï¼Œ å¦‚æžœæ²¡æŠ¥é”™ï¼Œåˆ™è¿è¡Œå‘½ä»¤; ./configure â€“with-php-config=/usr/local/php/bin/php-config â€“with-oci8=/usr/lib/oracle/11.1/client æ³¨æ„è¦å…ˆç¡®ä¿/usr/local/php/bin/php-configå­˜åœ¨ã€‚å¦‚æžœä½ çš„phpå®‰è£…è·¯å¾„ä¸æ˜¯é»˜è®¤çš„ï¼Œè¦æ”¹ã€‚ å†è¿è¡Œä»¥ä¸‹å‘½ä»¤ ï¼Œç„¶åŽå®ƒå‘Šè¯‰ä½ ä¸€ä¸ªç›®å½•,ä½ æŠŠè¯¥ç›®å½•ä¸‹çš„oci8.soæ‹·è´åˆ°ä½ php.iniä¸­çš„extension_diræŒ‡å‘çš„ç›®å½•ä¸­ make make install 1). éœ€è¦å¼ºè°ƒçš„æ˜¯makeçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œæ˜¾ç¤ºå„ç§æ‰¾ä¸åˆ°åº“æ–‡ä»¶ï¼Œéœ€è¦å¯¹makefileæ–‡ä»¶è¿›è¡Œä¿®æ”¹åŠ å…¥oralceçš„è¿è¡Œåº“åœ°å€ æ‰“å¼€makefileï¼Œå¯»æ‰¾INCLUDEï¼Œå½¢å¼å¦‚ä¸‹ï¼š INCLUDES = -I/usr/local/php/include/php -I/usr/include/oracle/10.2.0.3/client ç„¶åŽåœ¨æœ«å°¾åŠ ä¸Š=â€-I/usr/lib/oracle/11.1/clientï¼Œç„¶åŽé‡æ–°makeå°±ä¼šæˆåŠŸäº†ã€‚ 2) ç¼–è¯‘çš„æ—¶å€™ä¼šå‡ºçŽ°é”™è¯¯ï¼š 1234567891011121314/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:56:17: é”™è¯¯ï¼šoci.hï¼šæ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•In file included from /data/lnmp1.4c/oci8-1.4.10/oci8.c:58:/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:113: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜OCIEnvâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:122: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜OCIEnvâ€™In file included from /data/lnmp1.4c/oci8-1.4.10/oci8.c:58:/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:152: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜dvoidâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:165: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜ub4â€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:172: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜OCITypeâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:182: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜textâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:191: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜swordâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:207: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜OCIBindâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:230: é”™è¯¯ï¼šexpected specifier-qualifier-list before â€˜OCIDefineâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:377: é”™è¯¯ï¼šexpected â€˜=â€™, â€˜,â€™, â€˜;â€™, â€˜asmâ€™ or â€˜__attribute__â€™ before â€˜php_oci_errorâ€™/data/lnmp1.4c/oci8-1.4.10/php_oci8_int.h:378: é”™è¯¯ï¼šexpected â€˜=â€™, â€˜,â€™, â€˜;â€™, â€˜asmâ€™ or â€˜__attribute__â€™ before â€˜php_oci_fetch_errmsgâ€™ â€‹ error: oci8_dtrace_gen.h: No such file or directory å¦‚æžœéœ€è¦ DTRACE: yum install systemtap-sdt-develexport PHP_DTRACE=yeså¦‚æžœä¸éœ€è¦ DTRACE: 123modify the file &apos;php_oci8_int.h&apos;, change the 48th line #include &quot;oci8_dtrace_gen.h&quot; to #undef HAVE_OCI8_DTRACE ä¿®æ”¹PHP.iniï¼ˆ/usr/local/php/etc/php.iniï¼‰ åœ¨extension_dir = &quot;/usr/local/php/lib/php/extensions/no-debug-non-zts-20060613/&quot;åŽå¢žåŠ ä¸€è¡Œï¼š extension = &quot;oci8.so&quot; æ³¨æ„:è¦ç¡®ä¿/usr/local/php/lib/php/extensions/no-debug-non-zts-20060613/ è¯¥ç›®å½•ä¸‹æœ‰oci8.soæ–‡ä»¶ â€‹ é‡å¯apache,è®©ociç”Ÿæ•ˆ åœ¨webç›®å½•ä¸‹åˆ›å»ºphpinfo.phpæ–‡ä»¶åœ¨å…¶ä¸­è¾“å…¥ä¸€ä¸‹å†…å®¹ï¼Œå¹¶é€šè¿‡webè®¿é—®]]></content>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡SSHåè®®é‡‡é›†ç›‘æŽ§æ•°æ®]]></title>
    <url>%2F2018%2F04%2F11%2F%E9%80%9A%E8%BF%87SSH%E5%8D%8F%E8%AE%AE%E9%87%87%E9%9B%86%E7%9B%91%E6%8E%A7%E6%95%B0%E6%8D%AE%2F</url>
    <content type="text"><![CDATA[é€šè¿‡SSHåè®®é‡‡é›†ç›‘æŽ§æ•°æ®Zabbixä¸­é€šè¿‡SSHåè®®ä¹Ÿå¯ä»¥å®žçŽ°ç›‘æŽ§ç›®æ ‡ï¼Œé€šè¿‡SSH agentç›‘æŽ§æ–¹å¼ï¼Œéœ€è¦å¯¹æœåŠ¡å™¨è¿›è¡Œç›‘æŽ§ä½†åˆä¸èƒ½å®‰è£…Zabbix agentçš„çŽ¯å¢ƒä¸­éžå¸¸æœ‰ç”¨ã€‚Zabbixä¸­ä½¿ç”¨SSh agentæ—¶è¦æ±‚libssh2çš„æœ€ä½Žç‰ˆæœ¬æ˜¯ 1.0.0ã€‚ SSH agentæ”¯æŒä¸¤ç§èº«ä»½è®¤è¯çš„æ–¹å¼ï¼šåŸºäºŽç”¨æˆ·åå¯†ç çš„æ–¹å¼å’ŒåŸºäºŽç§˜é’¥çš„æ–¹å¼ï¼Œä½¿ç”¨ç”¨æˆ·åå¯†ç çš„æ–¹å¼ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šçš„é…ç½®ï¼Œæ·»åŠ ç›‘æŽ§é¡¹æ—¶éœ€è¦åœ¨é¡µé¢ä¸­è¾“å…¥æ˜Žæ–‡çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå› æ­¤åœ¨å®žé™…çŽ¯å¢ƒä¸­å»ºè®®ä½¿ç”¨åŸºäºŽç§˜é’¥çš„æ–¹å¼ï¼Œä½†è¿™ä¸ªæ–¹å¼éœ€è¦åšäº›é¢å¤–çš„é…ç½®ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹åŸºäºŽç§˜é’¥çš„æ–¹å¼å¦‚ä½•é…ç½®çš„ã€‚ é¦–å…ˆï¼Œæ£€æŸ¥zabbixç”¨æˆ·çš„è®¾ç½®ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚# grep zabbix /etc/passwd zabbix:x:996:994:Zabbix Monitoring System:/var/lib/zabbix:/sbin/nologin â€‹ å¯ä»¥çœ‹åˆ°ç³»ç»Ÿä¸­zabbixç”¨æˆ·çš„homeç›®å½•æ˜¯/var/lib/zabbixï¼Œç¡®è®¤è¯¥ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æžœä¸å­˜åœ¨ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ›å»ºç›®å½•ã€‚ â€‹ # mkdir â€“p /var/lib/zabbix/.ssh â€‹ # chown â€“R zabbix:zabbix /var/lib/zabbix æŽ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹zabbix-server.confæ–‡ä»¶ï¼Œé…ç½®SSH Keyæ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ã€‚ vi /etc/zabbix/zabbix-server.confSSHKeyLocation=/ var/lib/zabbix/.sshä¿®æ”¹å®Œzabbix-server.confé…ç½®æ–‡ä»¶åŽé‡å¯Zabbixserverã€‚1systemctl restart zabbix-server çŽ°åœ¨ï¼Œæˆ‘ä»¬ç”Ÿæˆzabbixç”¨æˆ·çš„SSH Keyï¼Œè¯¢é—®passphraseæ—¶ç›´æŽ¥å›žè½¦å°±å¯ä»¥ã€‚ sudo -u zabbixssh-keygen -t rsa -b 2048 Generating public/private rsa key pair. Enter file in which to save the key (/var/lib/zabbix/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /var/lib/zabbix/.ssh/id_rsa. Your public key has been saved in /var/lib/zabbix/.ssh/id_rsa.pub. The key fingerprint is: 15:3e:d5:61:ed:16:b3:0a:67:9d:35:f0:35:55:0b:7e zabbix@zbxserver The keyâ€˜s randomart image is: +â€“[ RSA 2048]- â€”â€“+ | . .+++*| | . o..++*| | + ..EB| | . o o.+o| | S + .. | | . | | | | | | | +â€”â€”â€”â€”â€”â€”â€”â€”â€”-+ # ll total 8 -rwâ€”â€”- 1 zabbix zabbix 1675 May 31 13:29 id_rsa -rw-râ€“râ€“ 1 zabbix zabbix 398 May 31 13:29 id_rsa.pub æŽ¥ä¸‹æ¥æ‹·è´ç§˜é’¥æ–‡ä»¶åˆ°è¢«ç›‘æŽ§ä¸»æœºä¸­ï¼Œå‡è®¾è¢«ç›‘æŽ§ä¸»æœºçš„IP åœ°å€æ˜¯192.168.10.112ã€‚ # sudo -u zabbixssh-copy-id root@192.168.10.112 The authenticity of host â€˜192.168.10.112 (192.168.10.112)â€˜ canâ€˜t beestablished. ECDSA key fingerprint is0d:33:e5:5c:43:c3:5b:c4:da:e4:f0:6d:0c:fb:4a:6e. Are you sure you want to continue connecting (yes/no)? yes /bin/ssh-copy-id: INFO: attempting to log in with the new key(s), tofilter out any that are already installed /bin/ssh-copy-id: INFO: 1 key(s) remain to be installed â€“ if youare prompted now it is to install the new keys root@192.168.10.112â€˜s password: Number of key(s) added: 1 Now try logging into the machine, with: â€œssh â€˜root@192.168.10.112â€˜â€œ and check to make sure that only the key(s) you wanted were added. çŽ°åœ¨æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹èƒ½å¦ç™»å½•æˆåŠŸã€‚ # sudo -u zabbix ssh root@192.168.10.112 å½“å®Œæˆä¸Šé¢çš„é…ç½®åŽï¼Œå°±å¯ä»¥åˆ›å»ºSSH agentç›‘æŽ§æ–¹å¼çš„ç›‘æŽ§é¡¹äº†ã€‚ é…ç½®SSH agentç›‘æŽ§é¡¹çš„æ­¥éª¤ï¼š 1ã€ åˆ›å»ºä¸€ä¸ªæ–°ä¸»æœºï¼ˆConfiguration â€“&gt; Host â€“&gt; Create hostï¼‰ã€‚åœ¨ä¸»æœºé…ç½®é¡µé¢çš„Hostæ ‡ç­¾ä¸‹æ·»åŠ AgentinterfacesæŽ¥å£é…ç½®ï¼Œå¦‚ä¸‹å›¾3-14æ‰€ç¤ºã€‚ å›¾ 3-14 2ã€ åœ¨ä¸»æœºä¸­åˆ›å»ºæ–°çš„ç›‘æŽ§é¡¹ã€‚ Nameä¸­è¾“å…¥ç›‘æŽ§é¡¹åç§°ï¼Œä¾‹å¦‚Check unameã€‚ Typeä¸­é€‰æ‹©SSH agentã€‚ Keyä¸­å†…å®¹æ›¿æ¢æˆssh.run[uname]ã€‚ Host interface ä¸­é€‰æ‹©agentæŽ¥å£ã€‚ Authentication methodä¸­é€‰æ‹©Public keyã€‚ User nameä¸­å¡«å†™root ï¼ŒPublic key fileä¸­å¡«å†™id_rsa_pubï¼ŒPrivate keyfileä¸­å¡«å†™ id_rsaã€‚ Key passphraseç•™ç©ºï¼Œå¦‚æžœç”Ÿæˆå¯†é’¥æ—¶ä½ è¾“å…¥äº†passphraseï¼Œå°±éœ€è¦åœ¨è¿™é‡Œè¾“å…¥ç›¸åŒçš„passphraseã€‚ Executed scriptä¸­è¾“å…¥uname -aã€‚ Type of informationä¸­é€‰æ‹©Textç±»åž‹ã€‚ å…¶ä»–å‚æ•°å¯ä»¥ä¿æŒä¸å˜ï¼Œç‚¹å‡»AddæŒ‰é’®ä¿å­˜ã€‚ å¦‚ä¸‹å›¾3â€”15æ‰€ç¤ºã€‚ å›¾ 3-15 3ã€ Monitoring â€“&gt; Latest dataé¡µé¢æŸ¥çœ‹ç›‘æŽ§é¡¹ã€‚ ä½¿ç”¨SSH agentç›‘æŽ§æ–¹å¼éœ€è¦æ³¨æ„çš„æ˜¯libssh2å¯èƒ½ä¼šæŠŠå¯æ‰§è¡Œè„šæœ¬çš„è¾“å‡ºæˆªæ–­åˆ°32KBï¼Œå¦å¤–åœ¨è„šæœ¬ä¸­æœ€å¥½ä½¿ç”¨å‘½ä»¤çš„å…¨è·¯å¾„ã€‚]]></content>
      <tags>
        <tag>zabbix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Typoraå°æ”¹é€ ]]></title>
    <url>%2F2018%2F04%2F11%2FTypora%E5%B0%8F%E6%94%B9%E9%80%A0%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨Typora é“¾æŽ¥WebSocketä¿®æ”¹æ–‡ä»¶windows.html (line 82) åœ¨åŽé¢æ·»åŠ æ”¶åˆ°çš„WebSocketä¿¡æ¯æŽ¥æ”¶elementå¦‚ä¸‹ï¼š 123456&lt;li&gt; &lt;span class="footer-word-count-info-line" style="font-weight: bold"&gt; &lt;span class="footer-word-count-no-selection" data-lg="Panel"&gt;SHELL&lt;/span&gt; &lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;p id="shell-output"&gt;&lt;/p&gt;&lt;/li&gt; éšåŽåŠ å…¥è¾“å…¥æ¡†å’ŒæŒ‰é’®1234&lt;div class="footer-item footer-item-left" id="terminal"&gt;&lt;label&gt;SHELL:&lt;/label&gt;&lt;input type="text" id='shell' name="shell" value="pwd" /&gt;&lt;button type="submit" onclick="execs()" class="footer-item-right footer-btn " id="toggle-exec-btn"&gt;Exec&lt;/button&gt;&lt;/div&gt; å¢žåŠ jsè„šæœ¬123456789101112131415161718192021222324252627282930var ws; function make_terminal(element, size, ws_url,paramter) &#123; ws = new WebSocket(ws_url); ws.onopen = function (event) &#123; ws.send(JSON.stringify(&#123;"parameter":paramter&#125;)); ws.onmessage = function (event) &#123; json_msg = JSON.parse(event.data); console.log(json_msg); switch (json_msg[0]) &#123; case "stdout": element.innerHTML="message:" + json_msg[1]; break; case "disconnect": element.innerHTML="[Finished...]"; break; &#125; &#125;; ws.close = function (argument) &#123;console.log(argument);&#125;; &#125;; &#125;; var ws_scheme = window.location.protocol == "https:" ? "wss" : "ws"; var ws_path = ws_scheme + '://127.0.0.1:8001/exec/';function execs() &#123; var message = &#123; common: $('#shell').val(), &#125; if(document.body.classList.contains("show-word-count"))&#123;console.log(1);&#125;else document.body.classList.add("show-word-count"); make_terminal(document.getElementById('shell-output'), &#123;rows: 1, cols: 90&#125;, ws_path, message); &#125;;]]></content>
      <tags>
        <tag>Typora</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[zabbizä½¿ç”¨ä¹‹æ·»åŠ NGINXç›‘æŽ§]]></title>
    <url>%2F2018%2F04%2F11%2Fzabbiz%E4%BD%BF%E7%94%A8%E4%B9%8B%E6%B7%BB%E5%8A%A0NGINX%E7%9B%91%E6%8E%A7%2F</url>
    <content type="text"><![CDATA[zabbixä½¿ç”¨ä¹‹æ·»åŠ NGINXç›‘æŽ§Agentç«¯é¦–å…ˆè¦æ£€æŸ¥Nginxæ˜¯å¦å®‰è£…äº† http_stub_status_module æ¨¡å—ï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯ä»¥çœ‹åˆ°ç¼–è¯‘å‚æ•°ã€‚ 1nginx -V å¦‚æžœæ²¡æœ‰è¿™ä¸ªæ¨¡å—ï¼Œè¿˜éœ€è¦é‡æ–°ç¼–è¯‘Nginx. é…ç½®NginxNginx 80ç«¯å£çš„serveré…ç½®å¢žåŠ å¦‚ä¸‹çš„ç‰‡æ®µ location /nginx_status { stub_status on; access_log off; allow 127.0.0.1; deny all; } æ£€æŸ¥ http://xx.x.x.x/nginx_status/ 12345&gt;&gt; curl http://127.0.0.1/nginx_statusActive connections: 4 server accepts handled requests 1162961 1162961 1210587 Reading: 0 Writing: 1 Waiting: 3 zabbix-agent é…ç½®æœ‰3ä¸ªæ­¥éª¤ï¼Œé¦–å…ˆæ˜¯ç¼–å†™èŽ·å–Nginxä¿¡æ¯è„šæœ¬ï¼ŒæŽ¥ç€é…ç½®ä¸­å¢žåŠ keyä¿¡æ¯ï¼Œç„¶åŽé‡å¯agent æœåŠ¡ã€‚ ç¼–å†™Nginxç›‘æŽ§è„šæœ¬ï¼Œè®°ä½è·¯å¾„ï¼ŒåŽé¢é…ç½®éœ€è¦ç”¨åˆ°ã€‚ ï¼ï¼æ³¨æ„è„šæœ¬æƒé™é—®é¢˜ï¼Œagentè¿è¡Œç”¨æˆ·è¦èƒ½æ‰§è¡Œã€‚ 1234&gt;&gt;# mkdir -p /etc/zabbix-agent/scripts&gt;&gt;# cd /etc/zabbix-agent/scripts&gt;&gt;# vim nginx-check.sh&gt;&gt;# cat nginx-check.sh 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#!/bin/bash################################### Zabbix monitoring script## nginx:# - anything available via nginx stub-status module#################################### Contact:# vincent.viallet@gmail.com# Zabbix requested parameterZBX_REQ_DATA="$1"ZBX_REQ_DATA_URL="$2"# Nginx defaultsNGINX_STATUS_DEFAULT_URL="http://127.0.0.1/nginx_status"WGET_BIN="/usr/bin/wget"## Error handling:# - need to be displayable in Zabbix (avoid NOT_SUPPORTED)# - items need to be of type "float" (allow negative + float)#ERROR_NO_ACCESS_FILE="-0.9900"ERROR_NO_ACCESS="-0.9901"ERROR_WRONG_PARAM="-0.9902"ERROR_DATA="-0.9903" # either can not connect / bad host / bad port# Handle host and port if non-defaultif [ ! -z "$ZBX_REQ_DATA_URL" ]; then URL="$ZBX_REQ_DATA_URL"else URL="$NGINX_STATUS_DEFAULT_URL"fi# save the nginx stats in a variable for future parsingNGINX_STATS=$($WGET_BIN -q $URL -O - 2&gt; /dev/null)# error during retrieveif [ $? -ne 0 -o -z "$NGINX_STATS" ]; then echo $ERROR_DATA exit 1fi## Extract data from nginx stats#case $ZBX_REQ_DATA in active_connections) echo "$NGINX_STATS" | head -1 | cut -f3 -d' ';; accepted_connections) echo "$NGINX_STATS" | grep -Ev '[a-zA-Z]' | cut -f2 -d' ';; handled_connections) echo "$NGINX_STATS" | grep -Ev '[a-zA-Z]' | cut -f3 -d' ';; handled_requests) echo "$NGINX_STATS" | grep -Ev '[a-zA-Z]' | cut -f4 -d' ';; reading) echo "$NGINX_STATS" | tail -1 | cut -f2 -d' ';; writing) echo "$NGINX_STATS" | tail -1 | cut -f4 -d' ';; waiting) echo "$NGINX_STATS" | tail -1 | cut -f6 -d' ';; *) echo $ERROR_WRONG_PARAM; exit 1;;esacexit 0 agentçš„é…ç½®æ–‡ä»¶ /etc/zabbix/zabbix_agentd.conf ä¸­å®šä¹‰äº†å…¶ä»–keyçš„åŒ…å«ç›®å½• Include=/etc/zabbix/zabbix_agentd.d/, å¦‚æžœæ²¡æœ‰è¿™ä¸ªé…ç½®è¯·è‡ªå·±æ·»åŠ ä¸‹ã€‚æŽ¥ç€åœ¨ /etc/zabbix/zabbix_agentd.d/ ç›®å½•æ–°å»ºä¸€ä¸ªæ–‡ä»¶ nginx-params.conf, å†…å®¹å¦‚ä¸‹ 1UserParameter=nginx[*],/usr/local/zabbix-agent/scripts/nginx-check.sh "$1" é‡å¯agent 1/etc/init.d/zabbix-agent restart Server çš„Webç«¯é¦–å…ˆå‘½ä»¤è¡Œæµ‹è¯•ä¸‹åˆšæ‰agentå¥½ä½¿ä¸ï¼Œç¡®è®¤å¥½ç”¨ä¹‹åŽåœ¨webç«¯å¯¼å…¥æ¨¡æ¿ï¼Œä¹‹åŽå°±å¯ä»¥ç»™å¯¹åº”ä¸»æœºæ·»åŠ ç›‘æŽ§å–½ã€‚ 123zabbix_get -s 127.0.0.1 -p 10050 -k "nginx[reading]"0123 ç™»å½•Zabbix3.0 çš„webç•Œé¢ï¼Œä¸€æ¬¡é€‰æ‹© Configuration &gt; Templates ï¼Œ åœ¨ä¸»ç•Œé¢çš„å³ä¸Šè§’æœ‰ä¸ª Import æŒ‰é’®ï¼Œç”¨æ¥å¯¼å…¥æ¨¡æ¿ã€‚ æ¨¡æ¿æ–‡ä»¶æ¯”è¾ƒé•¿ç•™ä¸€ä¸ªä¸‹è½½åœ°å€ å¯¼å…¥ä¹‹åŽå°±å¯ä»¥ç»™ä¸»æœºæ·»åŠ ç›‘æŽ§å•¦ã€‚]]></content>
      <tags>
        <tag>zabbix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[zabbizä½¿ç”¨ä¹‹æ·»åŠ Mysqlç›‘æŽ§]]></title>
    <url>%2F2018%2F04%2F11%2Fzabbiz%E4%BD%BF%E7%94%A8%E4%B9%8B%E6%B7%BB%E5%8A%A0Mysql%E7%9B%91%E6%8E%A7%2F</url>
    <content type="text"><![CDATA[æ·»åŠ  Mysql ç›‘æŽ§Agent ç«¯é…ç½®ï¼šåœ¨/etc/zabbix/zabbix_agentd.d/userparameter_mysql.conf æ–‡ä»¶ä¸­æŒ‡å®šäº† zabbix agentå¦‚ä½•èŽ·å– mysql æœåŠ¡çš„å„ç§ç™»å½•ä¿¡æ¯ï¼Œå¹¶åœ¨/var/lib/zabbix/ç›®å½•ä¸­æ–°å»ºâ€.my.cnfâ€æ–‡ä»¶ï¼Œç”¨ä»¥æŒ‡å®š zabbix agent å¦‚ä½•ç™»é™†æ•°æ®åº“ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ zabbix ç”¨æˆ·ï¼Œå¯ä»¥åœ¨ zabbix_confæ–‡ä»¶ä¸­æ‰¾åˆ°å¯†ç ã€‚ 12345678910111213141516#mkdir /var/lib/zabbix#vim /var/lib/zabbix/.my.cnf[mysql]host=localhostuser=zabbixpassword=zabbixsocket=/var/lib/mysql/mysql.sock[mysqladmin]host=localhostuser=zabbixpassword=zabbixsocket=/var/lib/mysql/mysql.sock#service zabbix-agent restart#åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒæŽˆæƒï¼šMysql&gt; GRANT USAGE ON *.* TO zabbix@localhost IDENTIFIED BY â€˜zabbixâ€™;Mysql&gt;FLUSH PRIVILEGES; åœ¨ zabbix_server ç«¯æµ‹è¯•æ˜¯å¦å¯ä»¥å¾—åˆ°æ£€æµ‹æ•°æ®ï¼šzabbix_get -s 10.10.1.13 -p 10050 -k mysql.ping1å¦‚æ˜¾ç¤º 1ï¼Œåˆ™ä»£è¡¨å¯ä»¥é€šè¿‡zabbix_agent èŽ·å–åˆ°æ•°æ®ã€‚Web ç«¯é…ç½®ï¼šä¾æ¬¡ç‚¹å‡» ç»„æ€â€“ä¸»æœºâ€“ï¼ˆè¦ç›‘æŽ§ mysql çš„ä¸»æœºï¼‰â€“æ¨¡æ¿â€“é€‰æ‹©â€“Template App Mysqlâ€“æ·»åŠ â€“æ›´æ–°ã€‚å®ŒæˆåŽï¼Œç‚¹å‡»ç›‘æµ‹ä¸­å›¾å½¢ï¼Œé€‰æ‹©ä¸»æœºå’Œ Mysql bandwidthï¼Œç­‰å¾…æ£€æµ‹ã€‚]]></content>
      <tags>
        <tag>zabbix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ORACLE11G é“¾æŽ¥ç¼“æ…¢é—®é¢˜æŽ’æŸ¥]]></title>
    <url>%2F2018%2F04%2F08%2FORACLE11G-%E9%93%BE%E6%8E%A5%E7%BC%93%E6%85%A2%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%2F</url>
    <content type="text"><![CDATA[é—®é¢˜æè¿°ï¼š æœåŠ¡å™¨centos7,å®¢æœç«¯ä»»æ„ æœ¬åœ°ä½¿ç”¨sqlplus / è¿žæŽ¥å¾ˆå¿«ï¼Œsqlplus xxx/xxx@127.0.0.1/sid å¾ˆæ…¢ windowså®¢æœç«¯åœ¨åˆ›å»ºé“¾æŽ¥åŽä¹Ÿå¾ˆæ…¢ é—®é¢˜æŽ’æŸ¥ tnsping æ²¡æœ‰å»¶è¿Ÿ 11Gç”¨æˆ·éªŒè¯é—®é¢˜ï¼ˆåªè¦æœ‰ç™»é™†é”™è¯¯ï¼Œå°±ä¼šæœ‰å»¶è¿Ÿç´¯è®¡ï¼‰ï¼ï¼ï¼ï¼ï¼ï¼ä¸æ˜¯ ç›‘å¬æ–‡ä»¶é…ç½®é—®é¢˜ ï¼ï¼ï¼ï¼ï¼ï¼ä¸æ˜¯ æ—¥å¿—æ–‡ä»¶è¿‡å¤§ ï¼ï¼ï¼ï¼ï¼ï¼ï¼ä¸æ˜¯ æœºå™¨ååœ¨ç›‘å¬æ–‡ä»¶å’Œç½‘ç»œä¸Šçš„åå­—ä¸ä¸€è‡´ï¼ï¼ï¼ï¼ï¼ï¼ï¼æ˜¯ /etc/hosts /etc/hostname $ORACLE_HOME/network/admin/tnsname.ora /etc/sysconf/network â€‹]]></content>
      <tags>
        <tag>linux,ORACLE</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gateone]]></title>
    <url>%2F2018%2F03%2F13%2Fgateone%2F</url>
    <content type="text"><![CDATA[1. Gate Oneç®€ä»‹GateOneæ˜¯ä¸€æ¬¾åŸºäºŽHTML5çš„å¼€æºç»ˆç«¯æ¨¡æ‹Ÿå™¨/SSHå®¢æˆ·ç«¯ã€‚å®ƒå¯ä»¥ç”¨äºŽè¿è¡Œä»»ä½•ç»ˆç«¯åº”ç”¨ã€‚ç”¨æˆ·å¯ä»¥å°†GateOneåµŒå…¥å…¶ä»–åº”ç”¨ç¨‹åºä»Žè€Œæä¾›å„ç±»ç»ˆç«¯è®¿é—®ç•Œé¢ï¼Œå®ƒä¹Ÿæ”¯æŒå„ç±»åŸºäºŽWebçš„ç®¡ç†ç•Œé¢ã€‚ Gate Oneåœ¨åŽå°è¿›ç¨‹æ˜¯ä½¿ç”¨Pythonå®žçŽ°çš„ï¼Œå…¶å‰ç«¯åˆ™æ˜¯JaveScript+WebSocketsã€‚å…³äºŽGate Oneçš„ä»‹ç»ã€æºç å’Œæ–‡æ¡£è¯·å‚è€ƒä¸‹é¢çš„é“¾æŽ¥ã€‚ Gate Oneä¸»é¡µï¼šhttp://liftoffsoftware.com/Products/GateOneGate Oneæºç ï¼šhttps://github.com/liftoff/GateOneGate Oneæ–‡æ¡£ï¼šhttp://liftoff.github.io/GateOne/ 2. Gate Oneå®‰è£…Gate Oneè¦æ±‚ç³»ç»Ÿå¿…é¡»æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªå‰ææ¡ä»¶ï¼Œ ï¼ˆ1ï¼‰python: 2.6+ or 3.2+ ï¼ˆ2ï¼‰Tornado Framework 2.2+ 2.1ç³»ç»ŸçŽ¯å¢ƒå‡†å¤‡åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤ $ python -VæŸ¥çœ‹ä½ æœ¬æœºæ˜¯å¦å®‰è£…äº†pythonï¼Œå¦‚æžœå…ˆå®‰è£…pythonï¼ˆæ³¨ï¼šæ ‘èŽ“æ´¾ä¸Šé¢è‡ªå·±å¸¦æœ‰python2å’Œpython3ï¼Œpython2å¯¹åº”pythonå‘½ä»¤ï¼Œpython3å¯¹åº”python3å‘½ä»¤ï¼‰ã€‚ ç„¶åŽå®‰è£…pipï¼Œ $ wget --no-check-certificate https://bootstrap.pypa.io/get-pip.py $ sudo python get-pip.py å®‰è£…tornadoï¼Œ $ sudo pip install tornado å®‰è£…å®Œæˆä¹‹åŽï¼Œæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹æˆ‘ä»¬çš„çŽ¯å¢ƒï¼Œ $ python -V $ python -c &quot;import tornado; print(tornado.version)&quot; 2.2 Gate OneèŽ·å–å’Œå®‰è£…å¦‚æžœæœ¬åœ°æ²¡æœ‰å®‰è£…gitï¼Œåˆ™å…ˆå®‰è£…gitï¼Œ $ sudo apt-get install git èŽ·å–Gate Oneæºç å¹¶è¿›è¡Œå®‰è£…ï¼Œï¼ˆæ³¨ï¼šè¿™ä¸ªåœ°æ–¹git cloneä¼šä¸‹è½½åˆ°å½“å‰ç›®å½•ä¸‹ï¼æ‰€ä»¥ä¸‹è½½å‰è®°å¾—cdåˆ°ä½ æƒ³ä¸‹è½½çš„ä½ç½®ç›®å½•åŽ»ï¼‰ $ git clone https://github.com/liftoff/GateOne.git $ cd GateOne $ sudo python ./setup.py install 3. Gate OneéªŒè¯Gate Oneçš„é…ç½®æ–‡ä»¶æ˜¯/etc/gateone/conf.d/10server.confï¼Œ sudo vi /etc/gateone/conf.d/10server.conf æˆ‘ä»¬ä¿®æ”¹é…ç½®æ–‡ä»¶å¦‚ä¸‹å›¾ï¼š è¿™é‡Œæˆ‘ä»¬ä¿®æ”¹äº†ï¼šâ€œaddressâ€ = â€œ192.168.1.2â€ è¿™ä¸ªæ˜¯æ ‘èŽ“æ´¾çš„ipåœ°å€â€œhttps_redirectâ€ = â€œtrueâ€â€œportâ€ = 8000 è¿™ä¸ªæ˜¯ç›‘å¬ç«¯å£ å…¶ä»–é»˜è®¤å°±å¯ä»¥äº†è¾“å…¥å‘½ä»¤ï¼š $ sudo gateone å¯åŠ¨åŽï¼Œé€šè¿‡æ‰“å°çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬çœ‹åˆ°Gate OneæœåŠ¡ç›‘å¬äº†8000ç«¯å£å·ï¼Œç„¶åŽåœ¨æµè§ˆå™¨ä¸­è¾“å…¥https://192.168.1.106:8000/å³å¯æ‰“å¼€gateoneçš„ç½‘é¡µç½‘ç»œä¼šè¿›è¡Œæ‹¦æˆªï¼Œç‚¹å‡» é«˜çº§ â€”â€”æ·»åŠ ä¾‹å¤–â€”â€”ç¡®è®¤å³å¯ç„¶åŽç‚¹å‡»ä¸­é—´çš„Terminalå›¾æ ‡ç™»é™†æŸå°æœºå™¨ï¼Œåˆ°æ­¤é“¾æŽ¥æˆåŠŸï¼Œå¯ä»¥webæµè§ˆå™¨è¿œç¨‹ç»ˆç«¯æ“ä½œæ ‘èŽ“æ´¾äº†ï¼ˆè¿™ä¸ªåœ°æ–¹æˆ‘ä¿®æ”¹äº†ç«¯å£å·ï¼š8008ï¼Œå› ä¸ºå‰é¢å¤šæ¬¡æ“ä½œï¼Œå‡ºçŽ°ä¸‹é¢é‡åˆ°çš„é—®é¢˜ï¼ï¼‰å¤šæ¬¡é“¾æŽ¥å¯èƒ½ä¼šå‡ºçŽ°è¿™ç§æƒ…å†µï¼šçº¢è‰²é”™è¯¯æ˜¾ç¤ºä¸èƒ½ç›‘å¬ï¼Œç«¯å£è¢«å ç”¨äº†ï¼Œå¯ä»¥ä¿®æ”¹ç­¾åé…ç½®æ–‡ä»¶ç«¯å£å·ã€‚é‡æ–°æµ‹è¯•ã€‚ 4. é…ç½®auth pamå®‰è£…libpam_pwdfileåŒ… sudo apt install libpam_pwdfile vi /etc/gateone/conf.d/20authentication.conf auth = &quot;pam&quot; pam_realm = &quot;AccessGateway1&quot; pam_service = &quot;gateone&quot; åœ¨Safariä¸‹æ— æ³•ä½¿ç”¨ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼šThe WebSocket connection was closed. Will attempt to reconnect every 5 secondsâ€¦NOTE: Some web proxies do not work properly with WebSockets. PCå’ŒAndroidä¸­çš„Chromeæ­£å¸¸ã€‚ vi /etc/pam.d/gateone #%PAM-1.0 # Login using a htpasswd file #@include common-sessionauth required pam_pwdfile.so pwdfile=/etc/gateone/passwd required pam_permit.so auth = &quot;pam&quot; pam_realm = &quot;AccessGateway1&quot; pam_service = &quot;gateone&quot; å¯†ç ç”Ÿæˆç”¨åœ¨çº¿å·¥å…·å°±è¡Œï¼Œè®°å¾—é€‰æ‹©Cryptæ–¹å¼ï¼šhttp://tool.oschina.net/htpasswdå°†ç”Ÿæˆçš„ä¿¡æ¯åŠ å…¥å¯†ç æ–‡ä»¶å°±è¡Œã€‚ sudo htpasswd -c -d /etc/gateone/users.passwd user1]]></content>
      <categories>
        <category>å ¡åž’æœº</category>
      </categories>
      <tags>
        <tag>ssh</tag>
        <tag>gateone</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[my git]]></title>
    <url>%2F2018%2F03%2F13%2Fmy-git%2F</url>
    <content type="text"><![CDATA[my git]]></content>
  </entry>
  <entry>
    <title><![CDATA[oracle 11g åœ¨centos7ä¸Šé™é»˜å®‰è£…ä¸Žå®‰è£…æ—¶çš„é”™è¯¯å¤„ç†]]></title>
    <url>%2F2017%2F10%2F07%2Farticle-title%2F</url>
    <content type="text"><![CDATA[åˆ†ç±»ï¼šoracleç‰ˆæƒå£°æ˜Žï¼šæœ¬æ–‡ä¸ºåšä¸»åŽŸåˆ›æ–‡ç« ï¼Œæœªç»åšä¸»å…è®¸ä¸å¾—è½¬è½½ã€‚æœ¬æ¬¡ï¼ˆ2017-03-11ï¼‰ä¿®æ”¹ï¼š1ï¼‰ä¿®æ”¹ç¨‹åºå®‰è£…ç›®å½•å /home â€”&gt; /data2ï¼‰åˆ å‡äº†ä¸€äº›ä¸å¿…è¦çš„åŒ…ï¼ˆkshï¼‰3ï¼‰å¢žåŠ äº†rlwrap ä¸€ä¸ªå¯ä»¥åœ¨sqlplusä¸­å¯ä»¥ä½¿ç”¨é”®ç›˜æ–¹å‘é”®æ¥å›žæ‰¾åŽ†å²å‘½ä»¤ã€‚4ï¼‰å¢žåŠ äº†ä¸€äº›å…³é”®çš„æˆªå›¾ï¼Œä¸ºå¸®åŠ©æœ‰éœ€è¦çš„æœ‹å‹ç†å¥½çŸ¥é“å®‰è£…è¿›åº¦5ï¼‰è“è‰²å­—ä½“ã€åŒ#å·æ˜¯æ–°å¢žè¯´æ˜Ž 1ã€å‡†å¤‡ç³»ç»Ÿã€è½¯ä»¶#oracle 11gï¼šlinux.x64_11gR2_database_2of2.ziplinux.x64_11gR2_database_1of2.zip #SYSTEMCentOS7 X86_64 2ã€å®‰è£…ä¾èµ–åº“#ä¸‹è½½å®‰è£…pdksh rpm -ivh pdksh-5.2.14-37.el5_8.1.x86_64.rpm ##ï¼š å®‰è£…è¿™ä¸ªpdksh rpmåŒ…æ—¶å¯èƒ½ä¼šå‡ºçŽ°ä¸Žkshå†²çªé—®é¢˜ï¼Œå¦‚æžœä¸ä½¿ç”¨kshå¯ä»¥æŠŠkshå¸è½½äº†ï¼Œæˆ‘å®‰è£…äº†éžå¸¸å¤šæ¬¡å‘çŽ°å¹¶ä¸å½±å“ä½¿ç”¨â€”-ï¼ˆ2017-03-11ï¼‰ #å®‰è£…å…¶å®ƒä¾èµ–yum -y install binutils compat-libcap1 compat-libstdc++ gcc gcc-c++ glibc glibc-devel libgcc libstdc++ libstdc++-devel libaio sysstat libaio-devel elfutils-libelf-devel unixODBC unixODBC-devel ##ï¼š åˆ é™¤äº†kshå®‰è£…åŒ… 3ã€ç”¨æˆ·ç›®å½•åˆ›å»ºgroupadd oinstallgroupadd dbauseradd -m -g oinstall -G dba oracleecho â€œoracle:passwordâ€ | chpasswdmkdir -p /home/oracle/ora11gchown -R oracle:oinstall /home/oracle/ora11gchmod -R 775 /home/oracle/ora11g 4ã€ç³»ç»Ÿé…ç½®#å†…æ ¸å‚æ•°è°ƒæ•´cat &gt;&gt; /etc/sysctl.conf &lt;&lt;EOFfs.aio-max-nr = 3145728fs.file-max = 6815744kernel.shmall = 1073741824kernel.shmmax = 4398046511104kernel.shmmni = 4096kernel.sem = 250 32000 100 142net.ipv4.ip_local_port_range = 9000 65500net.core.rmem_default = 262144net.core.rmem_max = 4194304net.core.wmem_default = 262144net.core.wmem_max = 1048576EOF #é…ç½®å…¨å±€å˜é‡cat &gt;&gt; /etc/profile &lt;&lt;EOFif [ $USER = â€œoracleâ€ ]; then if [ $SHELL = â€œ/bin/kshâ€ ];then ulimit -p 16384 ulimit -n 65536 else ulimit -u 16384 -n 65536 fifiEOF ##ï¼šè¿™ä¸ªçŽ¯å¢ƒå˜é‡å‘çŽ°å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼ˆé‡å¤é…ç½®ï¼‰ï¼Œå› ä¸ºåŽé¢é…ç½®æ–‡ä»¶å¥æŸ„æ•°æ—¶å·²ç»æ°¸ä¹…é…ç½®äº†å‚æ•°ã€‚ #é…ç½®oracleç”¨æˆ·å˜é‡cat &gt;&gt; /data/oracle/.bash_profile &lt;&lt;EOFexport TMP=/tmpexport TMPDIR=$TMPexport ORACLE_HOSTNAME=$(hostname)export ORACLE_BASE=/data/oracle/ora11gexport ORACLE_HOME=/data/oracle/ora11g/product/11.2.0/db_1export ORACLE_SID=orcl11gexport ORACLE_TERM=xtermexport PATH=$ORACLE_HOME/bin:$PATH #ä»¥ä¸‹é…ç½®åœ¨å‚è€ƒåˆ«äººå†™æ—¶æ˜¯è¦é…ç½®çš„ï¼Œä½†æ˜¯æˆ‘åŠ ä¸ŠåŽï¼Œç³»ç»Ÿå‘½ä»¤æ— æ³•æ‰§è¡Œï¼Œå°±ç›´æŽ¥æ³¨é‡Šäº† #export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib64:/usr/lib:/usr/lib64:/usr/local/lib64 #export CLASSPATH=$ORACLE_HOME/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib #export LD_ASSUME_KERNEL=2.6.18 ##ï¼šç›´æŽ¥åˆ é™¤äº†export NLS_LANG=â€american_america.UTF8â€export NLS_LANG=â€AMERICAN_AMERICA.US7ASCIIâ€EOF #ç»™oracleç”¨æˆ·é…ç½®å¥æŸ„æ•°å’Œæ–‡ä»¶æ‰“å¼€æ•°cat &gt;&gt; /etc/security/limits.conf &lt;&lt;EOForacle soft nproc 2048oracle hard nproc 16384oracle soft nofile 1024oracle hard nofile 65536EOF #é…ç½®oracleç”¨æˆ·å˜é‡cat &gt;&gt; /home/oracle/.bashrc &lt;&lt;EOFalias sysdba=â€™sqlplus â€œ/ nologâ€â€˜EOF #é…ç½®oracleç³»ç»Ÿé…ç½®æ–‡ä»¶cat &gt;&gt; /etc/oraInst.loc &lt;&lt;EOFinventory_loc=/data/oracle/ora11g/oraInventoryinst_group=oinstallEOF #æŽˆæƒchmod 664 /etc/oraInst.loc #åŠ è½½å†…æ ¸å‚æ•°sysctl -p #ç»™å®‰è£…æ–‡ä»¶æŽˆæƒï¼Œæˆ‘è¿™é‡Œæ”¾åœ¨oracle homeç›®å½•ä¸‹chown -R oracle:oinstall /home/oracle/database #æ·»åŠ swapæ–‡ä»¶ #è™šæ‹Ÿæœºæ²¡æœ‰æˆ–è€…ä¸å¤Ÿswapç©ºé—´dd if=/dev/zero of=/data/swap4g bs=1M count=4096mkswap /data/swap4gchmod 600 /data/swap4gswapon /data/swap4g ##ï¼šä¿®æ”¹äº†æ–‡ä»¶/home/swap â€” &gt; /data/swap4g 5ã€å®‰è£…ã€å®‰è£…æŽ’é”™#è§£åŽ‹å®‰è£…æ–‡ä»¶ #é…ç½®é™é»˜å®‰è£…åº”ç­”æ–‡ä»¶su oracle ; cd ~cp /home/oracle/database/response/* . #é…ç½®åˆå§‹åŒ–å®‰è£…æ–‡ä»¶sed -i â€˜s/oracle.install.option=./oracle.install.option=INSTALL_DB_SWONLY/gâ€™ db_install.rspsed -i â€œs/ORACLE_HOSTNAME=./ORACLE_HOSTNAME=$(hostname)/gâ€ db_install.rspsed -i â€˜s/UNIX_GROUP_NAME=./UNIX_GROUP_NAME=oinstall/gâ€™ db_install.rspsed -i â€˜s/INVENTORY_LOCATION=./INVENTORY_LOCATION=\/data\/oracle\/ora11g\/oraInventory/gâ€™ db_install.rspsed -i â€˜s/SELECTED_LANGUAGES=./SELECTED_LANGUAGES=en,zh_CN/gâ€™ db_install.rspsed -i â€˜s/ORACLE_HOME=./ORACLE_HOME=\/data\/oracle\/ora11g\/product\/11.2.0\/db_1/gâ€™ db_install.rspsed -i â€˜s/ORACLE_BASE=./ORACLE_BASE=\/data\/oracle\/ora11g/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.InstallEdition=./oracle.install.db.InstallEdition=EE/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.isCustomInstall=./oracle.install.db.isCustomInstall=true/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.DBA_GROUP=./oracle.install.db.DBA_GROUP=dba/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.OPER_GROUP=./oracle.install.db.OPER_GROUP=oinstall/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.type=./oracle.install.db.config.starterdb.type=GENERAL_PURPOSE/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.globalDBName=./oracle.install.db.config.starterdb.globalDBName=ora11g/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.SID=./oracle.install.db.config.starterdb.SID=orcl/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.characterSet=./oracle.install.db.config.starterdb.characterSet=AL32UTF8/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.memoryOption=./oracle.install.db.config.starterdb.memoryOption=true/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.password.ALL=./oracle.install.db.config.starterdb.password.ALL=oracle/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.control=./oracle.install.db.config.starterdb.control=DB_CONTROL/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.dbcontrol.enableEmailNotification=./oracle.install.db.config.starterdb.dbcontrol.enableEmailNotification=true/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.dbcontrol.emailAddress=./oracle.install.db.config.starterdb.dbcontrol.emailAddress=test@test.com/gâ€™ db_install.rspsed -i â€˜s/oracle.install.db.config.starterdb.dbcontrol.SMTPServer=./oracle.install.db.config.starterdb.dbcontrol.SMTPServer=smtp.test.com/gâ€™ db_install.rspsed -i â€˜s/DECLINE_SECURITY_UPDATES=./DECLINE_SECURITY_UPDATES=true/gâ€™ db_install.rspchmod 640 db_install.rsp ##ï¼šä¿®æ”¹ç›®å½•é…ç½®/home â€”&gt; /data ##ï¼šä¿®æ­£åœ¨sed å‚æ•° #é…ç½®ç›‘å¬åº”ç­”æ–‡ä»¶sed -i â€˜s/INSTALL_TYPE=.*/INSTALL_TYPE=â€â€customâ€â€/gâ€™ netca.rsp #é…ç½®æ•°æ®åº“åº”ç­”æ–‡ä»¶sed -i â€˜s#GDBNAME =.#GDBNAME = â€œorcl11gâ€#gâ€™ dbca.rspsed -i â€˜s#SID =.#SID = â€œorcl11gâ€#gâ€™ dbca.rspsed -i â€˜s/#SYSPASSWORD =./SYSPASSWORD = â€œoracleâ€/gâ€™ dbca.rspsed -i â€˜s/#SYSTEMPASSWORD =./SYSPASSWORD = â€œoracleâ€/gâ€™ dbca.rsp #å®‰è£…/home/oracle/database/runInstaller -silent -responseFile /home/oracle/db_install.rsp #å…ˆä½¿ç”¨ä¸Šé¢å‘½ä»¤æ£€æŸ¥ç³»ç»ŸçŽ¯å¢ƒåˆä¸åˆæ ¼ï¼Œå¦‚æžœå‡ºçŽ°ä¾èµ–åº“ç‰ˆæœ¬ä¸å¯¹ï¼ˆä¸€èˆ¬æ˜¯ç³»ç»Ÿçš„ç‰ˆæœ¬é«˜äº†ï¼Œoracleè¦æ±‚çš„ç‰ˆæœ¬ä½Žä¸€äº›ï¼‰å’Œä¸€äº›å†…æ ¸å‚æ•°æ£€æµ‹ä¸å‡ºæ¥ï¼ˆå¹¶ä¸æ˜¯æ²¡æœ‰é…ç½®ï¼‰ï¼Œè¿™äº›å¯ä»¥å¿½ç•¥ã€‚å¦‚æžœå…¶å®ƒçš„æŠ¥é”™æ ¹æ®æŠ¥é”™åŽ»ç»™ç³»ç»Ÿä½œç›¸åº”çš„è°ƒæ•´å§ã€‚ #æŽ’é”™åªèƒ½çœ‹æ—¥å¿—ï¼Œæ²¡æœ‰å…¶å®ƒæ›´å¥½çš„åŠžæ³•ã€‚ #æ¯”å¦‚ä»¥ä¸‹é”™è¯¯éƒ½å¯ä»¥å¿½ç•¥801:INFO: Error Message:PRVF-7543 : æ“ä½œç³»ç»Ÿå†…æ ¸å‚æ•° â€œsemmniâ€ åœ¨èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šæ²¡æœ‰é€‚å½“çš„å€¼ [åº”ä¸º = â€œ128â€; æ‰¾åˆ° = â€œ0â€]ã€‚930:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œlibaio-0.3.105 (i386)â€951:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œglibc-2.3.4-2.41 (i686)â€972:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œcompat-libstdc++-33-3.2.3 (i386)â€984:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œcompat-libstdc++-33-3.2.3 (x86_64)â€1050:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œlibaio-devel-0.3.105 (i386)â€1071:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œlibgcc-3.4.6 (i386)â€1092:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œlibstdc++-3.4.6 (i386)â€1131:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œunixODBC-2.2.11 (i386)â€1152:INFO: Error Message:PRVF-7532 : èŠ‚ç‚¹ â€œcentos7-6â€ ä¸Šç¼ºå°‘ç¨‹åºåŒ… â€œunixODBC-devel-2.2.11 (i386)â€ ##ï¼šæ–°å¢žé”™è¯¯ä¿¡æ¯ #ä»¥ä¸‹å‘½ä»¤æ˜¯å¿½ç•¥é‚£äº›å¯å¿½ç•¥å‚æ•°çš„å‘½ä»¤/home/oracle/database/runInstaller -silent -ignorePrereq -responseFile /home/oracle/db_install.rsp #æ£€æµ‹å®‰å®ŒæˆåŽï¼Œä¼šæç¤ºç”¨rootç”¨æˆ·æ‰§è¡Œä»¥ä¸‹é¢çš„å‘½ä»¤åŽ»å®Œæˆæœ€åŽçš„å®‰è£…sh /home/oracle/ora11g/product/11.2.0/db_1/root.sh ##ï¼šåˆ°ç›®å‰ä¸ºæ­¢ï¼Œoracleå·²ç»å…¨éƒ¨å®‰è£…å®Œæˆ 6ã€åˆ›å»ºå®žä¾‹ã€ç›‘å¬æ–‡ä»¶#åˆ›å»ºå®žä¾‹dbca -silent -responseFile /home/oracle/dbca.rsp #åˆ›å»ºç›‘å¬netca /silent /responseFile /home/oracle/netca.rsp #æŸ¥çœ‹oracleçš„çŠ¶æ€ 7ã€å®‰è£…rlwrapyum install readline* ncurses-develtar xf rlwrap-0.30.tar.gz.zipcd rlwrap-0.30./configuremakemake install #ç›´æŽ¥é…ç½®åœ¨.bash_profileé‡Œalias sqlplus=â€™rlwrap sqlplusâ€™alias rman=â€™rlwrap rmanâ€™ source .bash_profile #é‡Œè¾¹æ¶‰åŠçš„ä¸€äº›æ•æ„Ÿæ•°æ®å°±ä¸æ‰“ç äº†ï¼Œå› ä¸ºéƒ½åœ¨VMé‡Œè·‘çš„ã€‚ã€‚ã€‚ #ä¸»è¦å‚è€ƒæ–‡ç« å‡ºå¤„ï¼šhttp://blog.csdn.net/dc666/article/details/50014693ï¼Œéžå¸¸æ„Ÿè°¢ï¼]]></content>
  </entry>
</search>
